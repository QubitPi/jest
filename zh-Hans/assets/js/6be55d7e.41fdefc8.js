"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[7708],{35318:(e,t,a)=>{a.d(t,{Zo:()=>h,kt:()=>c});var n=a(27378);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},h=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,h=r(e,["components","mdxType","originalType","parentName"]),u=p(a),d=o,c=u["".concat(l,".").concat(d)]||u[d]||m[d]||i;return a?n.createElement(c,s(s({ref:t},h),{},{components:a})):n.createElement(c,s({ref:t},h))}));function c(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,s=new Array(i);s[0]=d;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[u]="string"==typeof e?e:o,s[1]=r;for(var p=2;p<i;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},92056:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>p});var n=a(25773),o=(a(27378),a(35318));const i={title:"Jest 16.0: Turbocharged CLI & Community Update",author:"Christoph Nakazawa",authorURL:"http://twitter.com/cpojer",authorFBID:0x5af311d9a1c8},s=void 0,r={permalink:"/jest/zh-Hans/blog/2016/10/03/jest-16",editUrl:"https://github.com/facebook/jest/tree/main/website/blog/2016-10-03-jest-16.md",source:"@site/blog/2016-10-03-jest-16.md",title:"Jest 16.0: Turbocharged CLI & Community Update",description:"It's been one month since the last major release and we've made significant improvements to Jest since. In this major release we are updating the snapshot format we are using which will likely require snapshots to be updated when upgrading Jest. We don't make these changes lightly and don't expect this to happen often but we think it is necessary to improve the format from time to time.",date:"2016-10-03T00:00:00.000Z",formattedDate:"2016\u5e7410\u67083\u65e5",tags:[],readingTime:5.84,hasTruncateMarker:!0,authors:[{name:"Christoph Nakazawa",url:"http://twitter.com/cpojer"}],frontMatter:{title:"Jest 16.0: Turbocharged CLI & Community Update",author:"Christoph Nakazawa",authorURL:"http://twitter.com/cpojer",authorFBID:0x5af311d9a1c8},prevItem:{title:"2016 in Jest",permalink:"/jest/zh-Hans/blog/2016/12/15/2016-in-jest"},nextItem:{title:"Jest 15.0: New Defaults for Jest",permalink:"/jest/zh-Hans/blog/2016/09/01/jest-15"}},l={authorsImageUrls:[void 0]},p=[{value:"Upgraded CLI",id:"upgraded-cli",level:2},{value:"Snapshot Updates",id:"snapshot-updates",level:2},{value:"Test Library Updates",id:"test-library-updates",level:2},{value:"Community Update",id:"community-update",level:2}],h={toc:p};function u(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,n.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"It's been one month since the last major release and we've made significant improvements to Jest since. In this major release we are updating the snapshot format we are using which will likely require snapshots to be updated when upgrading Jest. We don't make these changes lightly and don't expect this to happen often but we think it is necessary to improve the format from time to time."),(0,o.kt)("h2",{id:"upgraded-cli"},"Upgraded CLI"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"reporter",src:a(96034).Z,width:"858",height:"575"})),(0,o.kt)("p",null,"Jest 16 features a new reporter interface that shows running tests as well as a live summary and a progress bar based on the estimated test runtime from previous test runs. We also improved the CLI output to work better with different color schemes. If there were test failures in a previous run, Jest will now always run those tests first to give useful signal to users as quickly as possible."),(0,o.kt)("p",null,"We also added a lot of new features which you may find useful:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"New CLI flags were added: A ",(0,o.kt)("inlineCode",{parentName:"li"},"--testNamePattern=pattern")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"-t <pattern>")," option was added to filter tests from the command line much like ",(0,o.kt)("inlineCode",{parentName:"li"},"it.only")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"fit")," does in tests."),(0,o.kt)("li",{parentName:"ul"},"Previously failed tests now always run first."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"jest <pattern>")," is now case-insensitive to make it easier to filter test files."),(0,o.kt)("li",{parentName:"ul"},"A test run in watch mode can now be interrupted. During a test run, simply press any of the keys used for input during watch mode (",(0,o.kt)("inlineCode",{parentName:"li"},"a"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"o"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"p"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"q")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"enter"),") to abort a test run and start a new one."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"--bail")," flag now also works in watch mode. Together with running failed tests first, Jest's watch mode will now feel turbocharged!"),(0,o.kt)("li",{parentName:"ul"},"Jest now automatically considers files and tests with the ",(0,o.kt)("inlineCode",{parentName:"li"},"jsx")," extension."),(0,o.kt)("li",{parentName:"ul"},"Jest warns about duplicate manual mock files and we improved automatically created mocks for ES modules compiled with babel."),(0,o.kt)("li",{parentName:"ul"},"A ",(0,o.kt)("inlineCode",{parentName:"li"},"jest.clearAllMocks")," function was added to clear all mocks in between tests."),(0,o.kt)("li",{parentName:"ul"},"We improved module resolution when ",(0,o.kt)("inlineCode",{parentName:"li"},"moduleNameMapper")," is used."),(0,o.kt)("li",{parentName:"ul"},"Finally, a ",(0,o.kt)("inlineCode",{parentName:"li"},"--findRelatedTests <fileA> <fileB>")," cli option was added to run tests related to the specified files. This is especially helpful as a pre-commit hook if you'd like to run tests only on a specified set of files that have tests associated with them.")),(0,o.kt)("p",null,"This is what Jest looks like when a test run is interrupted in watch mode: ",(0,o.kt)("img",{alt:"watch",src:a(36494).Z,width:"858",height:"575"})),(0,o.kt)("h2",{id:"snapshot-updates"},"Snapshot Updates"),(0,o.kt)("p",null,"Jest's snapshot implementation was completely rewritten. The new version of the ",(0,o.kt)("inlineCode",{parentName:"p"},"jest-snapshot")," package is now structured in a way that allows for easier integration into other test runners and enables more cool integrations like with ",(0,o.kt)("a",{parentName:"p",href:"https://voice.kadira.io/snapshot-testing-in-react-storybook-43b3b71cec4f#.qh4lzcadb"},"React Storybook"),". Jest doesn't mark snapshots as obsolete in a file with skipped or failing tests. We also made a number of changes to the snapshot format:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Objects and Arrays are now printed with a trailing comma to minimize future changes to snapshots."),(0,o.kt)("li",{parentName:"ul"},"We removed function names from snapshots. They were causing issues with different versions of Node, with code coverage instrumentation and we generally felt like it wasn't useful signal to show to the user that the name of a function has changed."),(0,o.kt)("li",{parentName:"ul"},"Snapshots are now sorted using natural sort order within a file.")),(0,o.kt)("p",null,"When upgrading to Jest 16, the diff might look similar to this one: ",(0,o.kt)("img",{alt:"snapshots",src:a(36872).Z,width:"1924",height:"1360"})),(0,o.kt)("h2",{id:"test-library-updates"},"Test Library Updates"),(0,o.kt)("p",null,"We finished the migration of Jasmine assertions to the new Jest matchers. We added three new matchers: ",(0,o.kt)("inlineCode",{parentName:"p"},"toBeInstanceOf"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"toContainEqual")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"toThrowErrorMatchingSnapshot")," . We have more readable failure messages for the spy/mock matchers ",(0,o.kt)("inlineCode",{parentName:"p"},"toHaveBeenLastCalledWith"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"toHaveBeenCalledWith"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"lastCalledWith")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"toBeCalledWith"),". Now that we have rewritten all assertions and separated them into their own package, we'll be working on making them standalone so they can be integrated into any test framework if you'd like to use them outside of Jest."),(0,o.kt)("p",null,"We also added a bunch of aliases that were requested by the community. To make Jest focus on a single test you can now use either ",(0,o.kt)("inlineCode",{parentName:"p"},"it.only")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"test.only")," or keep using ",(0,o.kt)("inlineCode",{parentName:"p"},"fit"),"; For skipping a test, ",(0,o.kt)("inlineCode",{parentName:"p"},"it.skip")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"test.skip")," are now available alongside of ",(0,o.kt)("inlineCode",{parentName:"p"},"xit"),"; finally to define a test as concurrent you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"test.concurrent")," which is useful in case your test accesses network resources or databases."),(0,o.kt)("p",null,"Finally, if you'd like to overwrite the ",(0,o.kt)("inlineCode",{parentName:"p"},"expect")," global with a different assertion library like ",(0,o.kt)("a",{parentName:"p",href:"http://chaijs.com/"},"chai"),", this can now be done using the ",(0,o.kt)("inlineCode",{parentName:"p"},"setupTestFrameworkScriptFile")," configuration option."),(0,o.kt)("h2",{id:"community-update"},"Community Update"),(0,o.kt)("p",null,"Over the last month lots of articles were written about Jest's snapshot testing feature, how to migrate to Jest and how to get started writing tests. I also did a few live videos to explain how Jest and snapshot testing works:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.facebook.com/react/videos/1035427199869020/"},"FB Live Video about Snapshot Testing"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=i31VtyJSM-I&feature=youtu.be"},"JavaScript & React Testing with Kent C. Dodds"),".")),(0,o.kt)("p",null,"A number of people wrote articles about snapshot testing. The most opinionated article that resonated with the Jest team was \u201c",(0,o.kt)("a",{parentName:"p",href:"http://benmccormick.org/2016/09/19/testing-with-jest-snapshots-first-impressions/"},"Testing with Jest Snapshots: First Impressions"),"\u201d. Ben makes three great points in his blog post:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Snapshot tests are a complement for conventional tests not a replacement."),(0,o.kt)("li",{parentName:"ol"},"Snapshot tests are more useful with a healthy code review process."),(0,o.kt)("li",{parentName:"ol"},"Snapshot tests work well with auto-mocking.")),(0,o.kt)("p",null,"We highly recommend reading the entire blog post. Ben did a fantastic job explaining the reasons why we built snapshot testing. It's important to point out that we didn't introduce snapshot testing to replace all other forms of testing but rather as a way to enable engineers to write tests for code that they otherwise wouldn't write tests for. It works well for things like React components, CLI output, error messages and many others but it doesn't solve all problems. Jest's goal is to provide many different ways to write effective tests without sacrificing performance or the project's maintainability."),(0,o.kt)("p",null,"Other highlights about snapshot testing:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A React Native testing series: ",(0,o.kt)("a",{parentName:"li",href:"https://blog.callstack.io/unit-testing-react-native-with-the-new-jest-i-snapshots-come-into-play-68ba19b1b9fe"},"Part 1: Jest \u2013 Snapshot come into play")," and ",(0,o.kt)("a",{parentName:"li",href:"https://blog.callstack.io/unit-testing-react-native-with-the-new-jest-ii-redux-snapshots-for-your-actions-and-reducers-8559f6f8050b#.putt9eipm"},"Part 2: Jest \u2013 Redux Snapshots for your Actions and Reducers"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://blog.grommet.io/post/2016/09/01/how-we-landed-on-jest-snapshot-testing-for-javascript"},"How we landed on Jest snapshot testing for JavaScript"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://guigrpa.github.io/2016/09/27/picture-this-snapshot-testing/"},"Picture This: Snapshot Testing"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://voice.kadira.io/snapshot-testing-in-react-storybook-43b3b71cec4f"},"Snapshot testing with React Storybook"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://medium.com/@ryancollinsio/testing-react-redux-applications-fee79ac0087f#.lyjl7st1n"},"Testing React and Redux Applications"),"."),(0,o.kt)("li",{parentName:"ul"},"If you are using the popular ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/airbnb/enzyme"},"enzyme")," testing utility, there is now a project ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/trayio/enzyme-to-json"},"enzyme-to-json")," which makes it possible to use Jest's snapshot testing feature together with enzyme.")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/reactjs/redux/commit/7296d3cba1f5f899bdee5ef6695a8d21149f8d6c"},"Redux itself now uses Jest")," and Max Stoiber wrote a ",(0,o.kt)("a",{parentName:"p",href:"http://academy.plot.ly/react/6-testing/"},"tutorial on how to test code written with redux"),". There is also a great ",(0,o.kt)("a",{parentName:"p",href:"https://semaphoreci.com/community/tutorials/how-to-test-react-and-mobx-with-jest"},"guide on how to write tests for MobX"),". If you are using ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/facebookincubator/create-react-app"},"create-react-app"),", Jest is now included by default. Kent C. Dodds created a ton of ",(0,o.kt)("a",{parentName:"p",href:"https://egghead.io/lessons/javascript-use-jest-s-snapshot-testing-feature?pl=testing-javascript-with-jest-a36c4074"},"videos on egghead.io")," that will help you get started with Jest."),(0,o.kt)("p",null,"If you are using other test runners, Kenneth Skovhus built an awesome ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/skovhus/jest-codemods"},"jest-codemods")," library that will automate the conversion for you. Codemods are awesome: they'll allow you to quickly evaluate whether Jest will work for you. Give it a try!"),(0,o.kt)("p",null,"The full ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/facebook/jest/blob/main/CHANGELOG.md#jest-1600"},"changelog can be found on GitHub"),". Jest 16 was a true JavaScript community effort and the project now has more than 220 contributors. We thank each and every one of you for your help to make this project great."))}u.isMDXComponent=!0},96034:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/16-reporter-578f46980efc5766386bed963d75e333.gif"},36872:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/16-snapshots-3d7a3fd47cdb15728ac038948a21d2b7.png"},36494:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/16-watch-db5e0e957c19a9b2499e018c81762993.gif"}}]);