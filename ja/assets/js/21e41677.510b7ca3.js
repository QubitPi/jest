"use strict";(self.webpackChunkjest_website=self.webpackChunkjest_website||[]).push([[2318],{35318:(e,t,a)=>{a.d(t,{Zo:()=>h,kt:()=>d});var n=a(27378);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},h=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,h=i(e,["components","mdxType","originalType","parentName"]),c=p(a),u=r,d=c["".concat(l,".").concat(u)]||c[u]||m[u]||o;return a?n.createElement(d,s(s({ref:t},h),{},{components:a})):n.createElement(d,s({ref:t},h))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[c]="string"==typeof e?e:r,s[1]=i;for(var p=2;p<o;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},50471:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var n=a(25773),r=(a(27378),a(35318));const o={title:"Jest 23: \ud83d\udd25 Blazing Fast Delightful Testing",author:"Rick Hanlon II",authorURL:"https://twitter.com/rickhanlonii",authorFBID:160800566},s=void 0,i={permalink:"/jest/ja/blog/2018/05/29/jest-23-blazing-fast-delightful-testing",editUrl:"https://github.com/facebook/jest/tree/main/website/blog/2018-05-29-jest-23-blazing-fast-delightful-testing.md",source:"@site/blog/2018-05-29-jest-23-blazing-fast-delightful-testing.md",title:"Jest 23: \ud83d\udd25 Blazing Fast Delightful Testing",description:"Today we are excited to announce Jest 23, our largest major release to date! Together with over 100 contributors, we've shipped a ton of features and bug fixes. Thank you to everyone in the community for helping make JavaScript Testing Delightful.",date:"2018-05-29T00:00:00.000Z",formattedDate:"2018\u5e745\u670829\u65e5",tags:[],readingTime:6.17,hasTruncateMarker:!0,authors:[{name:"Rick Hanlon II",url:"https://twitter.com/rickhanlonii"}],frontMatter:{title:"Jest 23: \ud83d\udd25 Blazing Fast Delightful Testing",author:"Rick Hanlon II",authorURL:"https://twitter.com/rickhanlonii",authorFBID:160800566},prevItem:{title:"Supporting Jest Open Source",permalink:"/jest/ja/blog/2018/06/27/supporting-jest-open-source"},nextItem:{title:"Jest 22: Refinements & Custom Runners",permalink:"/jest/ja/blog/2017/12/18/jest-22"}},l={authorsImageUrls:[void 0]},p=[{value:"Interactive Snapshot Mode",id:"interactive-snapshot-mode",level:2},{value:"Snapshot Property Matchers",id:"snapshot-property-matchers",level:2},{value:"Custom Asynchronous matchers",id:"custom-asynchronous-matchers",level:2},{value:"Custom Asymmetric Matchers",id:"custom-asymmetric-matchers",level:2},{value:"Jest Each",id:"jest-each",level:2},{value:"New Matchers",id:"new-matchers",level:2},{value:"Debug Hanging Tests",id:"debug-hanging-tests",level:2},{value:"Watch Mode Plugins",id:"watch-mode-plugins",level:2},{value:"Breaking Changes",id:"breaking-changes",level:2},{value:"Other Improvements",id:"other-improvements",level:2},{value:"Jest Summit",id:"jest-summit",level:2}],h={toc:p};function c(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},h,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Today we are excited to announce Jest 23, our largest major release to date! Together with over 100 contributors, we've shipped a ton of features and bug fixes. Thank you to everyone in the community for helping make JavaScript Testing Delightful."),(0,r.kt)("p",null,"We would also like to welcome both ",(0,r.kt)("a",{parentName:"p",href:"https://babeljs.io/"},"Babel")," and ",(0,r.kt)("a",{parentName:"p",href:"https://webpack.js.org/"},"webpack")," to the Jest community! After converting from Mocha to Jest 23 Beta, webpack saw their total test suite time reduced 6x from over 13 minutes to 2 minutes 20 seconds. ",(0,r.kt)("a",{parentName:"p",href:"https://twitter.com/search?q=%23blazingmeansgood"},"#blazingmeansgood")),(0,r.kt)("p",null,"Here's are some of the Jest 23 highlights and breaking changes."),(0,r.kt)("p",null,"For a full list see the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/facebook/jest/blob/main/CHANGELOG.md"},"changelog"),"."),(0,r.kt)("h2",{id:"interactive-snapshot-mode"},"Interactive Snapshot Mode"),(0,r.kt)("p",null,"We've added a new default watch menu option we're calling Interactive Snapshot Mode. This new mode allows you to step through each failing snapshot in each failing suite to review your failed snapshots and choose to update or skip each individually."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Interactive snapshot mode in action",src:a(70890).Z,width:"1004",height:"732"})),(0,r.kt)("p",null,"See the Interactive Snapshot Mode docs ",(0,r.kt)("a",{parentName:"p",href:"/docs/snapshot-testing#interactive-snapshot-mode"},"here"),"."),(0,r.kt)("h2",{id:"snapshot-property-matchers"},"Snapshot Property Matchers"),(0,r.kt)("p",null,"Often, objects you're snapshotting contain generated values like Dates and IDs. Jest now allows you to pass properties to the snapshot matcher which specify the structure of the data instead of the specific values. These property matchers are then verified before serializing the matcher type (instead of the value), giving you consistent snapshot results across test runs."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Snapshot Property Matchers",src:a(90908).Z,width:"2236",height:"1177"})),(0,r.kt)("p",null,"See the updated ",(0,r.kt)("inlineCode",{parentName:"p"},"toMatchSnapshot")," ",(0,r.kt)("a",{parentName:"p",href:"/docs/expect#tomatchsnapshotpropertymatchers-snapshotname"},"docs")," or the Property Matcher ",(0,r.kt)("a",{parentName:"p",href:"/docs/snapshot-testing#property-matchers"},"guide")," for more information."),(0,r.kt)("h2",{id:"custom-asynchronous-matchers"},"Custom Asynchronous matchers"),(0,r.kt)("p",null,"We now support asynchronous matchers with ",(0,r.kt)("inlineCode",{parentName:"p"},"expect.extends"),"! Async matchers return a Promise so that you can ",(0,r.kt)("inlineCode",{parentName:"p"},"await")," for the matcher to resolve. As an example:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Custom asynchronous matchers in action",src:a(26168).Z,width:"2230",height:"876"})),(0,r.kt)("p",null,"Docs available ",(0,r.kt)("a",{parentName:"p",href:"/docs/expect#expectextendmatchers"},"here"),"."),(0,r.kt)("h2",{id:"custom-asymmetric-matchers"},"Custom Asymmetric Matchers"),(0,r.kt)("p",null,"Asymmetric matchers are a great tool to use when you only care about asymmetric equality. For example, when the left side is expected to be an object with some subset of properties on the right, instead of an exact match. Jest provides a number of asymmetric matchers out of the box, and in this release we're introducing Custom Asymmetric Matchers."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Custom asymmetric matchers in action",src:a(9970).Z,width:"2230",height:"1012"})),(0,r.kt)("h2",{id:"jest-each"},"Jest Each"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://twitter.com/mattphillipsio"},"@mattphillipsio")," has donated the ",(0,r.kt)("inlineCode",{parentName:"p"},"jest-each")," package to Jest Core (thanks Matt!). ",(0,r.kt)("inlineCode",{parentName:"p"},"jest-each")," is a library inspired by ",(0,r.kt)("a",{parentName:"p",href:"https://yarnpkg.com/en/package/mocha-each"},(0,r.kt)("inlineCode",{parentName:"a"},"mocha-each"))," and ",(0,r.kt)("a",{parentName:"p",href:"http://spockframework.org/spock/docs/1.1/data_driven_testing.html#data-tables"},"Spock Data Tables")," which allows you to define a table of test cases, and then run a test for each row with the specified column values. We support both array types and template literals for all flavors of ",(0,r.kt)("inlineCode",{parentName:"p"},"describe")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"test"),". Docs are available ",(0,r.kt)("a",{parentName:"p",href:"/docs/api#testeachtable-name-fn"},"here"),", and for those not on Jest 23 yet, we're still publishing ",(0,r.kt)("a",{parentName:"p",href:"https://yarnpkg.com/en/package/jest-each"},(0,r.kt)("inlineCode",{parentName:"a"},"jest-each"))," separately!"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"jest-each in action",src:a(21226).Z,width:"2230",height:"1304"})),(0,r.kt)("p",null,"Huge shout out to Prettier for ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/prettier/prettier/pull/4423"},"fixing")," the table formatting so quickly (",(0,r.kt)("a",{parentName:"p",href:"https://prettier.io/blog/2018/05/23/1.13.0.html#format-new-describeeach-table-in-jest-23-4423-by-ikatyang"},"see Prettier 1.13"),")!"),(0,r.kt)("h2",{id:"new-matchers"},"New Matchers"),(0,r.kt)("p",null,"We only add matchers to core if we believe they will be useful to a large amount of people in the Jest community, and leave the majority of matchers to the community (see ",(0,r.kt)("a",{parentName:"p",href:"https://yarnpkg.com/en/package/jest-extended"},"jest-extended"),"). Some matchers make the cut into core, and Jest 23 adds:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"nthCalledWith"),(0,r.kt)("li",{parentName:"ul"},"toReturn"),(0,r.kt)("li",{parentName:"ul"},"toReturnTimes"),(0,r.kt)("li",{parentName:"ul"},"toReturnWith"),(0,r.kt)("li",{parentName:"ul"},"lastReturnedWith"),(0,r.kt)("li",{parentName:"ul"},"nthReturnedWith"),(0,r.kt)("li",{parentName:"ul"},"toStrictEqual")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"New matchers in action",src:a(10556).Z,width:"2230",height:"1276"})),(0,r.kt)("p",null,"See the updated expect docs ",(0,r.kt)("a",{parentName:"p",href:"/docs/expect"},"here"),"."),(0,r.kt)("h2",{id:"debug-hanging-tests"},"Debug Hanging Tests"),(0,r.kt)("p",null,"A common issue we see on the issue tracker relates to \u201cJest\u201d hanging after a test run. This is usually due to app code leaving handles open, preventing Jest from exiting. In the past, users have resorted to ",(0,r.kt)("inlineCode",{parentName:"p"},"--forceExit")," to fix (not recommended)."),(0,r.kt)("p",null,"To help debug these issues, we're now detecting when Jest does not exit:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Detecting hanging tests",src:a(13106).Z,width:"2236",height:"780"})),(0,r.kt)("p",null,"And we offer a new flag ",(0,r.kt)("inlineCode",{parentName:"p"},"--detectOpenHandles")," to help find the open handles:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Running detectOpenHandles",src:a(79959).Z,width:"2236",height:"1106"})),(0,r.kt)("p",null,"See the updated CLI docs ",(0,r.kt)("a",{parentName:"p",href:"/docs/cli#detectopenhandles"},"here"),"."),(0,r.kt)("h2",{id:"watch-mode-plugins"},"Watch Mode Plugins"),(0,r.kt)("p",null,"We have completely rewritten the watch mode system to allow adding custom plugins to watch mode. Watch Mode Plugins now make it possible to hook into Jest events and provide custom menu options in the Watch Mode Menu. All of the default Watch Mode prompts are implemented as plugins in this system, and the docs to create your own are available ",(0,r.kt)("a",{parentName:"p",href:"/docs/watch-plugins"},"here"),"."),(0,r.kt)("p",null,"With this change, we're also now able to bring back typeahead support as a Watch Mode Plugin via ",(0,r.kt)("a",{parentName:"p",href:"https://yarnpkg.com/en/package/jest-watch-typeahead"},"jest-watch-typeahead"),"!"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Typeahead plugin in action",src:a(48469).Z,width:"1001",height:"731"})),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/jest-community/jest-watch-typeahead"},"jest-watch-typeahead")," for documentation and install instructions. Huge thank you to ",(0,r.kt)("a",{parentName:"p",href:"https://twitter.com/rogeliog"},"@rogeliog")," for the new watch mode plugin system and the jest-watch-typeahead plugin!"),(0,r.kt)("h2",{id:"breaking-changes"},"Breaking Changes"),(0,r.kt)("p",null,"As with every major release, we are making a few breaking changes to make larger changes in the future possible and to push the testing experience to a new level. Here's a list of the biggest changes you may see:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Require test descriptions and functions"),": We're now failing tests that do not include both a function and a description."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Remove undefined props from React snapshots"),": Smaller snapshots and proper React behavior."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Remove deprecations"),": We removed mapCoverage since it's no longer needed. Additionally, we removed ",(0,r.kt)("inlineCode",{parentName:"li"},"jest.genMockFunction")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"jest.genMockFn")," since these are the same as ",(0,r.kt)("inlineCode",{parentName:"li"},"jest.fn"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Add snapshot names to failures"),": We added the snapshot name (if provided) to the snapshot failure message so it's easier to find the snapshot that's failing."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Replace mock timestamps"),": We replaced mock timestamps with invocationCallOrder since two or mocks may often have the same timestamp, making it impossible to test the call order."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Add results to mock snapshots"),": We added mock function call results to snapshots so that both the calls and the results of the invocation are tracked.")),(0,r.kt)("h2",{id:"other-improvements"},"Other Improvements"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Watch mode coverage"),": Coverage is now limited to only the files tested in watch mode or when using ",(0,r.kt)("inlineCode",{parentName:"li"},"--onlyChanged")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"--findRelatedTests"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Version documentation"),": We added docs for each minor release back to Jest 22, and have removed all of the \u201cRequires Jest X.X+\u201d from the docs."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Better snapshot summaries"),": We overhauled the Snapshot Summary output to make obsolete snapshots more informative."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Better stack traces"),": We added stack traces to asynchronous errors, timeout errors, expect.assertions, and thrown non-errors. We're also indicating the column in the code frame!"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Better React 16 support"),": Adds snapshot support for ",(0,r.kt)("inlineCode",{parentName:"li"},"React.Fragment"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"React.forwardRef"),", and ",(0,r.kt)("inlineCode",{parentName:"li"},"React.createContext"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Track mock return and throw values"),": Adds ",(0,r.kt)("inlineCode",{parentName:"li"},"mock.results")," that contains the return value or thrown value for each mock call."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Blazing \ud83d\udd25"),": We've added a blazing badge to the README to indicate that Jest is blazing good.")),(0,r.kt)("h2",{id:"jest-summit"},"Jest Summit"),(0,r.kt)("p",null,"Last week, the Jest Core Team met for the Jest Summit at Facebook London where worked on and released Jest 23, announced the Jest Open Collective, and gave a number of talks:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Christoph Nakazawa")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=cAKYQpTC7MA"},"Intro")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Aaron Abramov")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/cAKYQpTC7MA?t=440"},"Writing Meaningful Tests")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Rick Hanlon II")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/cAKYQpTC7MA?t=1881"},"Blazing Fast Snapshot Testing in Jest 23")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Simen Bekkhus")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/cAKYQpTC7MA?t=2990"},"Jest's Delightful Error Messages")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Matt Phillips")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/cAKYQpTC7MA?t=3852"},"Level up your Jest experience with community packages")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Michele Bertoli")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/cAKYQpTC7MA?t=4582"},"Snapshot all the things")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Jordan Eldredge")," \u2013 ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/cAKYQpTC7MA?t=5185"},"Webamp: Learn by imitating"))),(0,r.kt)("p",null,"Full talk is available ",(0,r.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=cAKYQpTC7MA"},"here"),"."),(0,r.kt)("p",null,"The turnout was amazing, and we were able to meet a lot of the London-based community in person. Thank you to everyone who joined us and for your continued support! Stay tuned for our next post which will outline the Jest Open Collective and the plans we have for the future."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"As always, this release couldn't have been possible without you, the JavaScript community. We are incredibly grateful that we get the opportunity to work on improving JavaScript testing together. If you'd like to contribute to Jest, please don't hesitate to reach out to us on")," ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"https://github.com/facebook/jest"},"GitHub")," or on")," ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"https://discord.gg/j6FKKQQrW9"},"Discord"),".")))}c.isMDXComponent=!0},9970:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-asymmetric-matchers-12a593708f9e4cec91225d63c49e959e.png"},26168:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-async-matchers-91183e14fbce836540d2079f145dbe97.png"},79959:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-hanging-after-4f446e62ff117f6ae7f669d56057d206.png"},13106:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-hanging-before-867f8f3cfd6d67bb5ce37bf11f053749.png"},70890:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-interactive-3b2c2f9ec0fecc4effbc03fbc3ad1963.gif"},21226:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-jest-each-3d938745102750ad491139ea700842ab.png"},10556:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-new-matchers-8aaaad14f7dc524a46b99503b6ede43b.png"},90908:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-snapshot-matchers-aa63fd590f453650a67eaa0d99f678e3.png"},48469:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/23-typeahead-b16e5a1f51f3b3852df9fcc508c920d1.gif"}}]);