<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://QubitPi.github.io/jest/ja/blog</id>
    <title>Jest Blog</title>
    <updated>2022-08-25T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://QubitPi.github.io/jest/ja/blog"/>
    <subtitle>Jest Blog</subtitle>
    <icon>https://QubitPi.github.io/jest/ja/img/favicon/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Jest 29: Snapshot format changes]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2022/08/25/jest-29</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2022/08/25/jest-29"/>
        <updated>2022-08-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Jest 29 is here, just a few short months after Jest 28. As mentioned in the Jest 28 blog post, this version contains just a couple of breaking changes, in order to make the upgrade as smooth as possible.]]></summary>
        <content type="html"><![CDATA[<p>Jest 29 is here, just a few short months after Jest 28. As mentioned in the <a href="/jest/ja/blog/2022/04/25/jest-28#future">Jest 28 blog post</a>, this version contains just a couple of breaking changes, in order to make the upgrade as smooth as possible.</p><p>The only breaking changes that should be noticeable are:</p><ul><li><p>Node versions 12 and 17 are dropped, both of which are EOL</p></li><li><p>The <code>snapshotFormat</code> property is changed to:</p><div class="language-diff codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-diff codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted prefix inserted" style="color:#397300;background:#baeeba">+</span><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba"> snapshotFormat: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba"></span><span class="token inserted-sign inserted prefix inserted" style="color:#397300;background:#baeeba">+</span><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba">   escapeString: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba"></span><span class="token inserted-sign inserted prefix inserted" style="color:#397300;background:#baeeba">+</span><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba">   printBasicPrototype: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba"></span><span class="token inserted-sign inserted prefix inserted" style="color:#397300;background:#baeeba">+</span><span class="token inserted-sign inserted line" style="color:#397300;background:#baeeba"> }</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><code>jest-environment-jsdom</code> has upgraded <code>jsdom</code> from v19 to v20</p></li></ul><p>There are certain changes to the types exposed by Jest, but probably (hopefully!) nothing that should impede the upgrade. Please see the <a href="/jest/ja/docs/upgrading-to-jest29">upgrade guide</a> for more details.</p><p>That's it for breaking changes! Hopefully this means the upgrade path from Jest 28 is smooth. Please see the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md#2900" target="_blank" rel="noopener noreferrer">changelog</a> for other changes.</p><p>Thanks for reading, and happy Jesting! üÉè</p>]]></content>
        <author>
            <name>Simen Bekkhus</name>
            <uri>https://github.com/SimenB</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest joins OpenJS Foundation]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2022/05/11/jest-joins-openjs</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2022/05/11/jest-joins-openjs"/>
        <updated>2022-05-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Banner image for Meta Open Source and OpenJS Foundation]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" alt="Banner image for Meta Open Source and OpenJS Foundation" src="/jest/ja/assets/images/openjs-ba98de96267fe09d68d434f11271825b.png" width="8002" height="1278" class="img_SS3x"></p><p>Today we're excited to announce that Jest is joining the OpenJS Foundation!</p><p>This change transfers ownership of the project from Meta to the Jest Core team via the OpenJS Foundation as an Impact Project. We‚Äôre grateful to Meta for creating Jest and all of their support over the years, and we look forward to the future of Jest as a project owned by the Jest community!</p><p>Check out the <a href="https://developers.facebook.com/blog/post/2022/05/11/meta-open-source-transfers-jest-to-openjs-foundation/" target="_blank" rel="noopener noreferrer">Meta Engineering blog</a> and <a href="https://openjsf.org/blog/2022/05/11/openjs-foundation-welcomes-jest/" target="_blank" rel="noopener noreferrer">OpenJS Foundation blog</a> announcements for more info.</p>]]></content>
        <author>
            <name>Ricky Hanlon</name>
            <uri>https://github.com/rickhanlonii</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 28: Shedding weight and improving compatibility ü´∂]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2022/04/25/jest-28</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2022/04/25/jest-28"/>
        <updated>2022-04-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Jest 28 is finally here, and it comes with some long requested features such as support for sharding a test run across multiple machines, package exports and the ability to customize the behavior of fake timers. These are just some personal highlights, and we'll be highlighting more in this blog post.]]></summary>
        <content type="html"><![CDATA[<p>Jest 28 is finally here, and it comes with some long requested features such as support for <a href="/jest/ja/docs/cli#--shard">sharding</a> a test run across multiple machines, <a href="https://nodejs.org/api/packages.html#exports" target="_blank" rel="noopener noreferrer">package <code>exports</code></a> and the ability to customize the behavior of <a href="/jest/ja/docs/jest-object#fake-timers">fake timers</a>. These are just some personal highlights, and we'll be highlighting more in this blog post.</p><p>Additionally, as announced in the <a href="/jest/ja/blog/2021/05/25/jest-27">Jest 27 blog post</a> last year, we have removed some packages that no longer are used by default from the default installation. As a result the installation size has dropped by about 1/3.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="breaking-changes">Breaking changes<a href="#breaking-changes" class="hash-link" aria-label="Breaking changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Breaking changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The list of breaking changes is long (and can be seen fully in the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md#2800" target="_blank" rel="noopener noreferrer">changelog</a>), but for migration purposes, we've also written <a href="/jest/ja/docs/28.x/upgrading-to-jest28">a guide</a> you can follow. Hopefully this makes the upgrade experience as frictionless as possible!</p><p>Main breaking changes likely to impact your migration are dropped support for Node 10 and 15 (but <em>not</em> Node 12, which will be EOL in a few days) and some renamed configuration options.</p><p>Please note that both of the removed modules (<code>jest-environment-jsdom</code> and <code>jest-jasmine2</code>) are still actively maintained and tested in the same way, so the only breaking change here is that you'll need to explicitly install them.</p><p>The guide should hopefully make migration trivial, but note that if you use any of the packages Jest consists of directly (such as <code>jest-worker</code> or <code>pretty-format</code>), instead of just running <code>jest</code>, then you need to go through the changelog to view any breaking changes.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="features">Features<a href="#features" class="hash-link" aria-label="Features „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Features „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Now let's talk about the new features in Jest 28, which is way more exciting! And there's quite a few of them, so buckle up.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="sharding-of-test-run">Sharding of test run<a href="#sharding-of-test-run" class="hash-link" aria-label="Sharding of test run „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Sharding of test run „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>Jest now includes a new <a href="/jest/ja/docs/cli#--shard"><code>--shard</code></a> CLI option, contributed by <a href="https://github.com/marionebl" target="_blank" rel="noopener noreferrer">Mario Nebl</a>. It allows you to run parts of your test across different machine, and has been one of Jest's oldest feature requests.</p><p>Jest's own test suite on CI went from about 10 minutes to 3 on Ubuntu, and on Windows from 20 minutes to 7.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="packagejson-exports"><code>package.json</code> <code>exports</code><a href="#packagejson-exports" class="hash-link" aria-label="packagejson-exports „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="packagejson-exports „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>Jest shipped minimal support of <a href="https://nodejs.org/api/packages.html#exports" target="_blank" rel="noopener noreferrer"><code>exports</code></a> in 27.3. However, it only supported the "main" entry point (<code>.</code>), and only if no <code>main</code> field was present in <code>package.json</code>. With Jest 28 we're excited to finally be shipping full support!</p><p>Related, in Jest 27, we provided either <code>require</code> or <code>import</code> condition. In Jest 28, <code>jest-environment-node</code> will now automatically provide <code>node</code> and <code>node-addons</code> conditions, while <code>jest-environment-jsdom</code> will provide the <code>browser</code> condition.</p><p>This has been one of the biggest compatibility issues of Jest, and hopefully this is now resolved once and for all.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="fake-timers">Fake timers<a href="#fake-timers" class="hash-link" aria-label="Fake timers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Fake timers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>Jest 26 introduced the concept of "modern" fake timers, which uses <a href="https://www.npmjs.com/package/@sinonjs/fake-timers" target="_blank" rel="noopener noreferrer"><code>@sinonjs/fake-timers</code></a> under the hood, and Jest 27 made it the default. In Jest 28, we are now exposing more of the underlying implementation through both configuration and runtime APIs. Huge thanks to <a href="https://github.com/mrazauskas" target="_blank" rel="noopener noreferrer">Tom Mrazauskas</a> who contributed this feature!</p><p>This allows you to not mock out <code>process.nextTick</code> which improves compatibility with fake <code>Promise</code>s, or to enable <code>advanceTimers</code> which automatically advance timers.</p><p>Please see <a href="/jest/ja/docs/configuration#faketimers-object">the <code>fakeTimers</code> configuration</a> for details.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="github-actions-reporter">GitHub Actions Reporter<a href="#github-actions-reporter" class="hash-link" aria-label="GitHub Actions Reporter „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="GitHub Actions Reporter „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>Jest now ships with a reporter to be used on GitHub Actions, which will use annotations to print test errors inline.</p><p><img loading="lazy" alt="GitHub Actions test error screenshot" src="/jest/ja/assets/images/28-gh-actions-reporter-1ee03f15b770cc9e04bb15ad1a532e1d.png" width="2286" height="554" class="img_SS3x"></p><p>You can activate this reporter by passing <code>github-actions</code> in the <a href="/jest/ja/docs/configuration#reporters-arraymodulename--modulename-options"><code>reporters</code> configuration option</a>.</p><p>Huge thanks to <a href="https://github.com/ockham" target="_blank" rel="noopener noreferrer">Bernie Reiter</a> and other contributors for sticking by us and finally landing this feature.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="inline-testenvironmentoptions">Inline <code>testEnvironmentOptions</code><a href="#inline-testenvironmentoptions" class="hash-link" aria-label="inline-testenvironmentoptions „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="inline-testenvironmentoptions „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>You can now pass <a href="/jest/ja/docs/configuration#testenvironmentoptions-object"><code>testEnvironmentOptions</code></a> inline in a file, similar to how you can set test environment. This is useful if you want to e.g. change the URL in a single file.</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @jest-environment jsdom</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @jest-environment-options {"url": "https://jestjs.io/"}</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'use jsdom and set the URL in this test file'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#1373c2">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">location</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">href</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'https://jestjs.io/'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_JmGV" id="all-nodejs-globals">All Node.js globals<a href="#all-nodejs-globals" class="hash-link" aria-label="All Node.js globals „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="All Node.js globals „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>If you are using the new <a href="https://nodejs.org/en/blog/announcements/v18-release-announce/#fetch-experimental" target="_blank" rel="noopener noreferrer"><code>fetch</code></a> implementation in Node v18, you might have noticed that this function is not available in Jest. It has been a long-standing issue that we have to manually copy over any globals into the test globals. With Jest 28, this is no longer an issue as we now inspect the global environment Jest itself is running in, and copy over any globals that are missing in the test environment.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="ecmascript-modules">ECMAScript Modules<a href="#ecmascript-modules" class="hash-link" aria-label="ECMAScript Modules „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="ECMAScript Modules „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>Not much has changed in Jest's support for native ESM since Jest 27 came out. We continue to be blocked by <a href="https://github.com/nodejs/node/issues/37648" target="_blank" rel="noopener noreferrer">stabilization in Node</a>, and are hopeful this situation will improve sooner rather than later!</p><p>However, we have been able to add a couple of new features in Jest 28.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="data-urls"><code>data:</code> URLs<a href="#data-urls" class="hash-link" aria-label="data-urls „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="data-urls „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p><a href="https://github.com/tbossi" target="_blank" rel="noopener noreferrer">Tommaso Bossi</a> has contributed support for <a href="https://nodejs.org/api/esm.html#data-imports" target="_blank" rel="noopener noreferrer"><code>data</code> URLs</a>, meaning you can now inline define some JavaScript to run without using <code>eval</code>.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="importmetajest"><code>import.meta.jest</code><a href="#importmetajest" class="hash-link" aria-label="importmetajest „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="importmetajest „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>While you have been able to access <code>jest</code> via <code>import {jest} from '@jest/globals'</code> in Jest, we've received feedback that this is less ergonomical than the (seemingly, but not really) global <code>jest</code> variable available in CJS. So Jest 28 ships with <code>import.meta.jest</code> to allow easier access.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="miscellaneous">Miscellaneous<a href="#miscellaneous" class="hash-link" aria-label="Miscellaneous „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Miscellaneous „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>That's quite a lot of features, and are my personal highlights. However, we still have many more which I'll quickly go through:</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="asynchronous-resolvers">Asynchronous resolvers<a href="#asynchronous-resolvers" class="hash-link" aria-label="Asynchronous resolvers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Asynchronous resolvers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p><a href="https://github.com/IanVS" target="_blank" rel="noopener noreferrer">Ian VanSchooten</a> has contributed support for <a href="/jest/ja/docs/configuration#resolver-string">asynchronous resolvers</a>, which enables tools like <a href="https://vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a> to have better integrations with Jest.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="asynchronous-setup-files">Asynchronous setup files<a href="#asynchronous-setup-files" class="hash-link" aria-label="Asynchronous setup files „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Asynchronous setup files „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>If you have some async work you want to do when using <code>setupFiles</code>, you can now export an <code>async function</code>, which Jest will call and await before loading any tests.</p><p>Note that this feature is only available for CJS. For ESM, we recommend using top-level <code>await</code> instead.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="using-globalthis">Using <code>globalThis</code><a href="#using-globalthis" class="hash-link" aria-label="using-globalthis „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="using-globalthis „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>Internally, Jest has been using <code>global</code> to refer to the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Global_object" target="_blank" rel="noopener noreferrer">global environment</a>. However, since this only exists in Node, and not browsers (<code>window</code>), this led to incompatibility when attempting to use Jest's modules in another environment.</p><p>Jest 28 uses <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/globalThis" target="_blank" rel="noopener noreferrer"><code>globalThis</code></a> instead, which works in all environments.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="jsdom-19">JSDOM 19<a href="#jsdom-19" class="hash-link" aria-label="JSDOM 19 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="JSDOM 19 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>While, as mentioned, Jest no longer ships <code>jest-environment-jsdom</code> in the default installation, it is still actively maintained. As part of that, Jest 28 has upgraded from <code>jsdom@16</code> to <code>jsdom@19</code>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="typescript">TypeScript<a href="#typescript" class="hash-link" aria-label="TypeScript „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="TypeScript „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>If you use Jest with TypeScript, either in your tests or when writing plugins such as custom runners, Jest 28 comes with extensive improvements to our types. Here's a non-exhaustive list of the changes in Jest 28.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="expect"><code>expect</code><a href="#expect" class="hash-link" aria-label="expect „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="expect „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>When using <code>expect</code>'s own types (either directly, or via <code>import {expect} from '@jest/globals'</code>), it's now finally possible to add custom matchers. See our <a href="https://github.com/facebook/jest/tree/main/examples/expect-extend" target="_blank" rel="noopener noreferrer">example</a> for how to do this.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="custom-plugins">Custom plugins<a href="#custom-plugins" class="hash-link" aria-label="Custom plugins „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Custom plugins „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>If you write a custom runner, test reporter, resolver or something else, we now export more types that should help you type these more correctly. This is a moving target, so if you are the author of something pluggable in Jest and the types aren't as useful as they could be, please file an issue!</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="jest-runner-tsd"><code>jest-runner-tsd</code><a href="#jest-runner-tsd" class="hash-link" aria-label="jest-runner-tsd „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="jest-runner-tsd „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p><a href="https://github.com/jest-community/jest-runner-tsd" target="_blank" rel="noopener noreferrer"><code>jest-runner-tsd</code></a> is a custom runner for running type tests. This is what Jest uses itself to test our types, and we hope it can also be used by others! As its name implies, it is based on <a href="https://npmjs.com/package/tsd" target="_blank" rel="noopener noreferrer"><code>tsd</code></a>, although it under the hood uses the fork <a href="https://npmjs.com/package/tsd-lite" target="_blank" rel="noopener noreferrer"><code>tsd-lite</code></a>.</p><hr><p>All of these improvements and fixes has been contributed by <a href="https://github.com/mrazauskas" target="_blank" rel="noopener noreferrer">Tom Mrazauskas</a>. Thank you so much, Tom! üëè</p><p>Lastly, the minimum support version of TypeScript is now 4.3.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="jest-light-runner"><code>jest-light-runner</code><a href="#jest-light-runner" class="hash-link" aria-label="jest-light-runner „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="jest-light-runner „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The last thing we want to highlight in this blog post, is a very cool new Jest runner, created by <a href="https://github.com/nicolo-ribaudo" target="_blank" rel="noopener noreferrer">Nicol√≤ Ribaudo</a>, called <a href="https://www.npmjs.com/package/jest-light-runner" target="_blank" rel="noopener noreferrer"><code>jest-light-runner</code></a>. This takes almost all of the DX Jest is known for, and speeds it way up by being a smaller abstraction on top of Node. Babel's tests became almost twice as fast after migrating. While there are caveats, the existence of this runner should make it even easier for people who have smaller Node modules to test to choose Jest. Thanks, Nicol√≤!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="future">Future<a href="#future" class="hash-link" aria-label="Future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>While Jest 28 came almost a year after Jest 27, Jest 29 will be coming sooner, probably in just a few months. The current plan then is to just have one breaking change (except dropping Node versions), and that is to default <a href="/jest/ja/docs/configuration#snapshotformat-object"><code>snapshotFormat</code></a> to <code>{escapeString: false, printBasicPrototype: false}</code>. This makes snapshots both more readable and more copy-pasteable.</p><p>This will of course be possible to override if you don't want to change, but you can also use those options today if you don't want to wait!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="acknowledgements">Acknowledgements<a href="#acknowledgements" class="hash-link" aria-label="Acknowledgements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Acknowledgements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest 28 contains contributions from more than 60 people, of which more than two thirds are first time contributors. Thank you so much to all contributors, old and new. Without you the project wouldn't be nearly as good as it is! I'd particularly like to thank <a href="https://github.com/mrazauskas" target="_blank" rel="noopener noreferrer">Tom Mrazauskas</a> and <a href="https://github.com/F3n67u" target="_blank" rel="noopener noreferrer">Feng Yu</a> for all their contributions, from code, to issue triaging to debugging, that made Jest 28 what it is. Thank you! üôè</p><p>Thanks for reading, and happy Jesting! üÉè</p>]]></content>
        <author>
            <name>Simen Bekkhus</name>
            <uri>https://github.com/SimenB</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 27: New Defaults for Jest, 2021 edition ‚è©]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2021/05/25/jest-27</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2021/05/25/jest-27"/>
        <updated>2021-05-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In the Jest 26 blog post about a year ago, we announced that after two major releases with few breaking changes, Jest 27 will flip some switches to set better defaults for projects that are new or can migrate smoothly. This gives us the opportunity to remove some packages from the default distribution of Jest 28 and publish them as separately installable and pluggable modules instead. Everyone on the new defaults can benefit from a smaller install size, while people needing these packages can still install them separately.]]></summary>
        <content type="html"><![CDATA[<p>In the <a href="/jest/ja/blog/2020/05/05/jest-26">Jest 26 blog post</a> about a year ago, we announced that after two major releases with few breaking changes, Jest 27 will flip some switches to set better defaults for projects that are new or can migrate smoothly. This gives us the opportunity to remove some packages from the default distribution of Jest 28 and publish them as separately installable and pluggable modules instead. Everyone on the new defaults can benefit from a smaller install size, while people needing these packages can still install them separately.</p><p>With the first major change of defaults since the <a href="/jest/ja/blog/2016/09/01/jest-15">New Defaults for Jest</a> that came with the seminal version 15, Jest 27 is now here, to keep Jest fast, lean, and relevant in the future. We will explain those changes of defaults and other notable breaking changes in this post, but first, let's get into some exciting new features!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="feature-updates">Feature updates<a href="#feature-updates" class="hash-link" aria-label="Feature updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Feature updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Firstly, the interactive mode you may know from reviewing and updating failed snapshots can now also be used to <strong>step through failed tests</strong> one at a time. Credit goes to first-time contributor <a href="https://github.com/NullDivision" target="_blank" rel="noopener noreferrer">@NullDivision</a> for <a href="https://github.com/facebook/jest/pull/10858" target="_blank" rel="noopener noreferrer">implementing</a> this feature!</p><p><img loading="lazy" alt="Interactive failed test run" src="/jest/ja/assets/images/27-interactive-failures-e22e3b31b285188ed65f6432cb21df30.png" width="2416" height="1289" class="img_SS3x"></p><p>Speaking of snapshots, one of the more exciting features we've shipped in recent years are Inline Snapshots, which <a href="https://github.com/facebook/jest/pull/6380" target="_blank" rel="noopener noreferrer">landed</a> in a minor release of Jest 23 almost three years ago. However, they came with the restriction that projects wanting to utilize them must be using <a href="https://prettier.io/" target="_blank" rel="noopener noreferrer">Prettier</a> to format their code, because that's what Jest would use to make sure the file it writes the snapshots into remains properly formatted.<br>
<!-- -->And so for most of these years, we've had a <a href="https://github.com/facebook/jest/pull/7792" target="_blank" rel="noopener noreferrer">pull request</a> in the pipeline to eliminate this restriction and allow using <strong>Inline Snapshots without Prettier</strong>. It has amassed well above a hundred comments, not even taking into account PRs split out from it and landed first, and even changed owner once after the initial submission by another first-time contributor, <a href="https://github.com/mmkal" target="_blank" rel="noopener noreferrer">@mmkal</a> under the hilarious working title 'Uglier Inline Snapshots'. With the stellar rise of Prettier in recent times, this improvement is now maybe less needed than back in 2018, but still, we know that feeling of getting into a project that does not use Prettier, and suddenly not being able to use inline snapshots anymore. Nevermore!</p><p>The main reason why it took us so long to land this was, somewhat surprisingly, an out of memory error on our build pipeline. It turns out that the dependencies we load for each test file to perform the parsing, snapshot insertion, and printing do incur a significant time and memory overhead.<br>
<!-- -->So with some <a href="https://github.com/facebook/jest/issues/9898" target="_blank" rel="noopener noreferrer">tricks</a>, we've <strong>speed up the initialization per test file</strong> by roughly 70% compared to Jest 26. Note that you will almost certainly not see this big of a performance improvement on your project‚Äîyou would need a lot of test files that each run very quickly to best notice this, and the overhead when using a <a href="/jest/ja/docs/configuration#testenvironment-string">JSDOM environment</a> dwarfs any such improvement.</p><p>In other news, the <a href="https://github.com/facebook/jest/issues/9430" target="_blank" rel="noopener noreferrer">native ESM support</a> is progressing, but some major complexities, for instance around mocking, are still ahead of us, and we continue to observe the migration to ESM as a huge ecosystem effort, where Node and a lot of crucial tools and packages all have to rely on each other to deliver an overall compelling experience.<br>
<!-- -->ESM support <a href="https://github.com/facebook/jest/issues/11167" target="_blank" rel="noopener noreferrer">for plugging modules into Jest</a> is more advanced‚Äîcustom runners, reporters, watch plugins, and many other modules can already be loaded as ES modules.</p><p>We've also merged <a href="https://github.com/facebook/jest/pull/9351" target="_blank" rel="noopener noreferrer">a PR</a> to be able to deal with test files symlinked into the test directory, a feature much wanted by users of <a href="https://bazel.build/" target="_blank" rel="noopener noreferrer">Bazel</a>.</p><p><a href="https://github.com/facebook/jest/issues/9504" target="_blank" rel="noopener noreferrer">Another PR</a> enabled <a href="/jest/ja/docs/configuration#transform-objectstring-pathtotransformer--pathtotransformer-object"><code>transform</code>s</a> to be asynchronous, a requirement to support transpilation through tools such as <a href="https://esbuild.github.io/" target="_blank" rel="noopener noreferrer">esbuild</a>, <a href="https://www.snowpack.dev/" target="_blank" rel="noopener noreferrer">Snowpack</a>, and <a href="https://vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite</a> effectively.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="flipping-defaults">Flipping defaults<a href="#flipping-defaults" class="hash-link" aria-label="Flipping defaults „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Flipping defaults „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Up until now, if you were using Jest in its default configuration, you were‚Äîperhaps unknowingly‚Äîrunning some code forked many years ago from the test runner <a href="https://jasmine.github.io/2.0/introduction" target="_blank" rel="noopener noreferrer">Jasmine 2.0</a> that provides test framework functions such as <code>describe</code>, <code>it</code>, and <code>beforeEach</code>. In 2017, <a href="https://github.com/aaronabramov" target="_blank" rel="noopener noreferrer">Aaron Abramov</a> <a href="https://github.com/facebook/jest/pull/3668" target="_blank" rel="noopener noreferrer">initially wrote</a> a <strong>replacement for the Jasmine code</strong> called <code>jest-circus</code>, meant to improve error messages, maintainability, and extensibility.<br>
<!-- -->After years of large-scale use at Facebook and of course in Jest itself, as well as recent adoption in <code>create-react-app</code>, we are now confident that <code>jest-circus</code> is highly compatible with <code>jest-jasmine2</code> and should work in most environments with little to no migration work. There may be minor differences in execution order and strictness, but we expect no major upgrade difficulties other than for code relying on Jasmine-specific APIs such as <code>jasmine.getEnv()</code>. If you rely extensively on such APIs, you can opt back in to the Jasmine-based test runner by <a href="/jest/ja/docs/configuration#testrunner-string">configuring</a> <code>"testRunner": "jest-jasmine2"</code>.</p><p>Running tests in a <a href="/jest/ja/docs/configuration#testenvironment-string">JSDOM environment</a> incurs a significant performance overhead. Because this was the default behavior of Jest unless otherwise configured up until now, users who are writing Node apps, for example, may not even know they are given an expensive DOM environment that they do not even need.<br>
<!-- -->For this reason, we are <strong>changing the default test environment</strong> from <code>"jsdom"</code> to <code>"node"</code>. If you are affected by this change because you use DOM APIs and do not have the test environment explicitly configured, you should be receiving an error when e.g. <code>document</code> is accessed, and you can configure <code>"testEnvironment": "jsdom"</code> or use <a href="/jest/ja/docs/configuration#testenvironment-string">per-file environment configuration</a> to resolve this.<br>
<!-- -->For mixed projects where some tests require a DOM environment but others don't, we recommend using the fast <code>"node"</code> environment by default and declaring exactly those tests that need the DOM using <a href="/jest/ja/docs/configuration#testenvironment-string">docblocks</a>.<br>
<!-- -->In the next major, we plan to also eliminate <code>jest-jasmine2</code> and <code>jest-environment-jsdom</code> from the Jest dependency tree and require them to be installed explicitly, so that many users can profit from a smaller install size with less clutter that they don't need.</p><p>Another default that we are changing affects Fake Timers aka <a href="/jest/ja/docs/timer-mocks">Timer Mocks</a>. We introduced an opt-in "modern" implementation of Fake Timers in Jest 26 accessed transparently through the same API, but with much more comprehensive mocking, such as for <code>Date</code> and <code>queueMicrotask</code>.<br>
<!-- -->This <strong>modern fake timers implementation will now be the default</strong>. If you are among the unlucky few who are affected by the subtle implementation differences too heavily to migrate, you can get back the old implementation using <code>jest.useFakeTimers("legacy")</code> or, if you are enabling fake timers globally via <a href="/jest/ja/docs/configuration#timers-string">configuration</a>, <code>"timers": "legacy"</code>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="features-coming-with-breaking-changes">Features coming with breaking changes<a href="#features-coming-with-breaking-changes" class="hash-link" aria-label="Features coming with breaking changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Features coming with breaking changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We introduced a few more small breaking changes to help you avoid mistakes by disallowing some things that can easily happen unintentionally:</p><ul><li>The same <code>done</code> test callback may not be called more than once,</li><li>calling <code>done</code> and returning a Promise may not be combined,</li><li>a <code>describe</code> block must not return anything,</li></ul><p>and we <a href="https://github.com/facebook/jest/pull/10512" target="_blank" rel="noopener noreferrer">made some TypeScript types stricter</a>.</p><p>Modules used in the following configuration options are now transformed like the rest of your code, which may be breaking if you relied on them being loaded as-is:</p><ul><li><code>testEnvironment</code></li><li><code>runner</code></li><li><code>testRunner</code></li><li><code>snapshotResolver</code></li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="miscellaneous-breaking-changes">Miscellaneous breaking changes<a href="#miscellaneous-breaking-changes" class="hash-link" aria-label="Miscellaneous breaking changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Miscellaneous breaking changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We removed some long-deprecated functions:</p><ul><li><code>jest.addMatchers</code> (use <code>expect.extend</code> instead)</li><li><code>jest.resetModuleRegistry</code> (use <code>jest.resetModules</code> instead)</li><li><code>jest.runTimersToTime</code> (use <code>jest.advanceTimersByTime</code> instead)</li></ul><p>A lot of Jest's packages have been migrated to use ESM-style exports (although they are still shipped as CommonJS), so if you consume e.g. <code>pretty-format</code> directly, you may need to adjust your import to a <code>default</code> import.</p><p>We dropped support for Node 13‚Äîbut Jest always supports the <em>Current</em> and all <em>LTS</em> <a href="https://nodejs.org/en/about/releases/" target="_blank" rel="noopener noreferrer">Node versions</a>, and Jest 27 continues to support Node 10, which only recently became unmaintained.</p><p>As always, the full changelog and list of breaking changes can be <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md#2700" target="_blank" rel="noopener noreferrer">viewed here</a>.</p><p>Finally, we'd like to thank the community for once again awarding Jest a sky-high satisfaction rating of 96% in the <a href="https://2020.stateofjs.com/en-US/technologies/testing/" target="_blank" rel="noopener noreferrer">State of JS 2020</a> survey! Stay safe everyone, and we hope you continue to enjoy using Jest in the years and versions to come! üÉè</p>]]></content>
        <author>
            <name>Tim Seckinger</name>
            <uri>https://github.com/jeysal</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest Website Upgrade]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2021/03/09/jest-website-upgrade</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2021/03/09/jest-website-upgrade"/>
        <updated>2021-03-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We are excited to present the new Jest website!]]></summary>
        <content type="html"><![CDATA[<p>We are excited to present the <strong>new Jest website</strong>!</p><p>The Jest site was upgraded from <strong><a href="https://v1.docusaurus.io/" target="_blank" rel="noopener noreferrer">Docusaurus 1</a></strong> to <strong><a href="https://v2.docusaurus.io/" target="_blank" rel="noopener noreferrer">Docusaurus 2</a></strong>, and is an early adopter of the <a href="https://v2.docusaurus.io/blog/2021/03/09/releasing-docusaurus-i18n" target="_blank" rel="noopener noreferrer">newly released Docusaurus 2 i18n support</a>.</p><p>So, what's new exactly?</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-new">What's new?<a href="#whats-new" class="hash-link" aria-label="What's new? „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="What's new? „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Here's a good overview of the most visible improvements:</p><ul><li><p><strong>Dark Mode</strong>: change the color scheme through the navbar switch.</p></li><li><p><strong>Modern navigation</strong>: we improved the navigation experience with <strong>client-side routing</strong> and <strong>prefetching</strong>.</p></li><li><p><strong>Versions dropdown</strong>: it is now simpler to switch from one Jest version to another.</p></li><li><p><strong>Progressive-Web-App</strong>: you can install the Jest website and browse it offline.</p></li><li><p><strong>Search</strong>: try the new Algolia <strong>DocSearch v3</strong> user-experience. It is now possible to <strong>search in blog posts</strong>.</p></li><li><p><strong>I18n</strong>: Jest is the first website using the <strong><a href="https://v2.docusaurus.io/docs/i18n/introduction" target="_blank" rel="noopener noreferrer">new i18n feature of Docusaurus 2</a></strong>. It is now possible to <strong>translate blog posts</strong>.</p></li><li><p><strong>MDX</strong>: embedding React components in Markdown will allow maintainers to make the <strong>documentation more interactive</strong>.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="for-site-translators">For site translators<a href="#for-site-translators" class="hash-link" aria-label="For site translators „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="For site translators „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>If you want to help to translate the new Jest website, please use the new Crowdin project <a href="https://crowdin.com/project/jest-v2" target="_blank" rel="noopener noreferrer">jest-v2</a> instead of the previous one.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_uH4V"><div class="admonitionHeading_P5_N"><span class="admonitionIcon_MF44"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Ê≥®Ë®ò</div><div class="admonitionContent_yySL"><p>In localized pages, the edit button now links directly to Crowdin.</p></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="thanks">Thanks<a href="#thanks" class="hash-link" aria-label="Thanks „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Thanks „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Thanks to all the contributors that supported or reviewed this migration: <a href="https://github.com/SimenB" target="_blank" rel="noopener noreferrer">Simen</a>, <a href="https://github.com/orta" target="_blank" rel="noopener noreferrer">Orta</a>, <a href="https://github.com/JoelMarcey" target="_blank" rel="noopener noreferrer">Joel</a>, <a href="https://github.com/merceyz" target="_blank" rel="noopener noreferrer">Kristoffer</a>...</p><p>Please report any problem on the <a href="https://github.com/facebook/jest/pull/11021" target="_blank" rel="noopener noreferrer">migration issue</a>.</p>]]></content>
        <author>
            <name>S√©bastien Lorber</name>
            <uri>https://sebastienlorber.com</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 26: Tick Tock]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2020/05/05/jest-26</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2020/05/05/jest-26"/>
        <updated>2020-05-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[When we started rebuilding Jest five years ago our goal was to provide a batteries-included zero-configuration test runner that is approachable for beginners, extensible for almost all testing use cases and scalable to large projects. One of the instrumental releases was Jest 15 which tied everything together and provided good defaults that allowed people to run Jest often without any setup. However, this approach has a big downside as Jest installs a lot of dependencies into your projects that you may not need.]]></summary>
        <content type="html"><![CDATA[<p>When we started rebuilding Jest five years ago our goal was to provide a batteries-included zero-configuration test runner that is approachable for beginners, extensible for almost all testing use cases and scalable to large projects. One of the instrumental releases was <a href="/jest/ja/blog/2016/09/01/jest-15">Jest 15</a> which tied everything together and provided good defaults that allowed people to run Jest often without any setup. However, this approach has a big downside as Jest installs a lot of dependencies into your projects that you may not need.</p><p>We are now beginning to address this shortcoming and are working on reducing Jest‚Äôs install size while keeping it approachable and extensible. We have made the following <strong>breaking changes</strong> in Jest 26:</p><ul><li><p><code>[expect, jest-mock, pretty-format]</code> Remove <code>ES5</code> build files with a new minimum of support of ES2015 (Node 8) which were only used for browser builds (<a href="https://github.com/facebook/jest/pull/9945" target="_blank" rel="noopener noreferrer">#9945</a>)</p><blockquote><p><strong>Migration</strong>: With this change, we are pushing the responsibility to bundle the affected packages to the users, rather than Jest providing them out of the box, since they know their target environments best. If you want it back, we're open to shipping these as separate packages. PRs welcome!</p></blockquote></li><li><p><code>[jest-config, jest-resolve]</code> Remove support for <code>browser</code> field (<a href="https://github.com/facebook/jest/pull/9943" target="_blank" rel="noopener noreferrer">#9943</a>)</p><blockquote><p><strong>Migration</strong>: Install <code>browser-resolve</code> module and use the following configuration:</p></blockquote><div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#82772c">"jest"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#82772c">"resolver"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token string" style="color:#c21325">"&lt;rootDir&gt;/resolver.js"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// resolver.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> browserResolve </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'browser-resolve'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> browserResolve</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sync</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>TypeScript definitions requires a minimum of TypeScript v3.8 (<a href="https://github.com/facebook/jest/pull/9823" target="_blank" rel="noopener noreferrer">#9823</a>)</p></li></ul><p>With the above changes Jest 26 is now 4 MiB smaller than Jest 25.5.4 (53 ‚Üí 49 MiB). Please keep in mind that many dependencies like Babel are likely already part of your project. Jest's own size was reduced by 1.2 MiB (4.3 -&gt; 3.1 MiB).</p><p>While this is a good start, it isn‚Äôt enough to make Jest meaningfully leaner. We are planning on gradually reducing Jest's and its dependency tree size by up to 70%. Most of the changes to reduce Jest‚Äôs default setup will be small breaking changes and we want to bring the community with us as much as possible. Therefore we will make the following changes in Jest 27 and Jest 28 using a <a href="https://en.wikipedia.org/wiki/Tick%E2%80%93tock_model" target="_blank" rel="noopener noreferrer">‚ÄúTick-Tock" release process</a>:</p><ul><li>Jest 27 will ship with a new test runner "<code>jest-circus</code>" and the Node.js environment by default. <code>jest-jasmine2</code> and <code>jest-environment-jsdom</code> will still be bundled so users can keep using them by changing one-line each in the configuration.</li><li>Jest 28 will remove <code>jest-jasmine2</code> and <code>jest-environment-jsdom</code> from the default distribution of Jest. The packages will still be actively maintained as part of the Jest project and be published separately. Users will need to install these packages to use them.</li></ul><p>Upon upgrading to these major releases, Jest will guide you through the necessary changes. If you‚Äôd like to get ahead and migrate to the new defaults now, and your project does not require a DOM environment, you can upgrade to Jest 26 and add the following configuration options:</p><div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#82772c">"jest"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#82772c">"testEnvironment"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token string" style="color:#c21325">"node"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#82772c">"testRunner"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token string" style="color:#c21325">"jest-circus/runner"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Jest will continue to ship with <code>babel-jest</code> enabled by default. It currently powers a few Jest features beyond compiling modern JavaScript syntax to something understood by current versions of Node.js and browsers: It also powers Jest's code coverage and mocking of ES modules. Jest currently ships with experimental support for <a href="/jest/ja/blog/2020/01/21/jest-25#v8-code-coverage">V8 coverage</a> and native support for ES Modules (more on that below!). It is not possible to mock static ES Modules per the specification without transforming the code first, so we will be encouraging patterns that work without the transformation we use Babel for today. Once V8 coverage and native ESM support stabilizes in Jest, we will also be able remove <code>babel-jest</code> as a default but we will keep maintaining it.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-fake-timers">New fake timers<a href="#new-fake-timers" class="hash-link" aria-label="New fake timers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New fake timers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>With Jest 26 we are shipping a new implementation of fake timers based on <code>@sinonjs/fake-timers</code>. We've wanted to do this for years and are happy this has finally progressed far enough to support all of Jest's existing fake timer use cases.</p><p>The new implementation comes with extra features such as mocking <code>Date</code>, <code>queueMicrotask</code> and more, see <a href="https://github.com/sinonjs/fake-timers/blob/master/README.md" target="_blank" rel="noopener noreferrer">this README</a>. It works transparently using the existing timer APIs like <code>jest.runAllTimers()</code> ‚Äì check out the documentation <a href="/jest/ja/docs/timer-mocks">on our website</a>.</p><p>We are confident this implementation is ready for prime time, however we don't want to force people to rewrite their tests if they depend on subtle differences between the old and new implementation. In Jest 26, this new implementation will remain <em>opt-in</em> and can be activated by calling <code>jest.useFakeTimers('modern')</code> or by passing <code>modern</code> to the <code>timers</code> option in your config if you opted all tests into fake timers previously.</p><p>In Jest 27 we will swap the default to the new "modern" implementation but we will keep supporting and maintaining the legacy implementation which can be used by calling <code>jest.useFakeTimers('legacy')</code>. If you are unsure whether you'll be able to upgrade all your tests by the time Jest 27 rolls out, you can add this to your tests now to keep the old behavior.</p><p>We'd like to thank <a href="https://github.com/fatso83" target="_blank" rel="noopener noreferrer">Carl-Erik Kopseng</a>, <a href="https://github.com/benjamingr" target="_blank" rel="noopener noreferrer">Benjamin Gruenbaum</a> and other maintainers of <code>@sinonjs/fake-timers</code> for their help and patience when working with us to make this happen! <em>Exciting</em>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="a-new-way-to-consume-jest---jestglobals">A new way to consume Jest - <code>@jest/globals</code><a href="#a-new-way-to-consume-jest---jestglobals" class="hash-link" aria-label="a-new-way-to-consume-jest---jestglobals „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="a-new-way-to-consume-jest---jestglobals „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest has relied on globals popularized by the Jasmine testing framework and others such as <code>describe</code>, <code>it</code>, <code>test</code> and <code>expect</code>. While this is a widely used pattern, many people have expressed their preference for importing testing related functions instead. To support this use case, we added a new package <code>@jest/globals</code> that can be used to import testing functions: <code>import {expect, jest, test} from '@jest/globals';</code>.</p><p>Caveats:</p><ul><li>Currently the globals still exist in the environment but we will introduce a mode to disable globals in the future. Similarly, you cannot use <code>const jest = require('@jest/globals')</code> as you'll get declaration errors because the <code>jest</code> variable is still a global for now.</li><li>There is currently no way to add custom matchers to the TypeScript definitions when using globals like this.</li><li>While this allows running tests without globals, it does not allow running tests without Jest's test runner at this time.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="native-esm-support">Native ESM support<a href="#native-esm-support" class="hash-link" aria-label="Native ESM support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Native ESM support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As mentioned in the <a href="/jest/ja/blog/2020/01/21/jest-25#ecmascript-modules-support">Jest 25 blog post</a> we have been working on native support for ECMAScript Modules. It is not stable yet but it is ready to be tested. We'd love to hear your feedback and bug reports! For an overview of the current state you can check out <a href="https://github.com/facebook/jest/issues/9430" target="_blank" rel="noopener noreferrer">this issue</a>, or browse all issues with that label <a href="https://github.com/facebook/jest/labels/ES%20Modules" target="_blank" rel="noopener noreferrer">ES Modules</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-breaking-changes-in-jest-26">Other Breaking Changes in Jest 26<a href="#other-breaking-changes-in-jest-26" class="hash-link" aria-label="Other Breaking Changes in Jest 26 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other Breaking Changes in Jest 26 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li>Dropped support for Node 8 (<a href="https://github.com/facebook/jest/pull/9423" target="_blank" rel="noopener noreferrer">#9423</a>)</li><li><code>[jest-environment-jsdom]</code> Upgrade <code>jsdom</code> to v16 (<a href="https://github.com/facebook/jest/pull/9606" target="_blank" rel="noopener noreferrer">#9606</a>)</li><li><code>[jest-runtime]</code> Remove long-deprecated <code>require.requireActual</code> and <code>require.requireMock</code> methods (<a href="https://github.com/facebook/jest/pull/9854" target="_blank" rel="noopener noreferrer">#9854</a>)</li><li><code>[jest-haste-map]</code> Removed <code>providesModuleNodeModules</code> (<a href="https://github.com/facebook/jest/pull/8535" target="_blank" rel="noopener noreferrer">#8535</a>)</li><li><code>[jest-circus]</code> Fail tests if a test takes a done callback and have return values (<a href="https://github.com/facebook/jest/pull/9129" target="_blank" rel="noopener noreferrer">#9129</a>)</li><li><code>[jest-circus]</code> Throw a proper error if a test / hooks is defined asynchronously (<a href="https://github.com/facebook/jest/pull/8096" target="_blank" rel="noopener noreferrer">#8096</a>)</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="stay-safe">Stay Safe<a href="#stay-safe" class="hash-link" aria-label="Stay Safe „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Stay Safe „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We are all currently experiencing an unprecedented time of uncertainty. If you are struggling financially, we would like to use <a href="https://opencollective.com/jest" target="_blank" rel="noopener noreferrer">Jest‚Äôs Open Collective fund</a> to help new and existing contributors. We place <a href="https://github.com/facebook/jest/issues?q=is%3Aissue+is%3Aopen+bounty+label%3A%22Has+Bounty%22" target="_blank" rel="noopener noreferrer">bounties on some issues</a> and are open to offering a bounty on any of our current open issues - you can mention that an issue should have a bounty in the issue or contact <a href="https://twitter.com/cpojer" target="_blank" rel="noopener noreferrer">@cpojer via private message on Twitter</a>.</p><p>Please stay safe.</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 25: üöÄ Laying foundations for the future]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2020/01/21/jest-25</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2020/01/21/jest-25"/>
        <updated>2020-01-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Jest 25 is laying the groundwork for many major changes in the future. As such, we kept breaking changes to a minimum, but internal architecture changes may require attention during the upgrade. The main changes are an upgrade of JSDOM from v11 to v15, 10-15% faster test runs, a new diff view for outdated snapshots and dropped Node 6 support.]]></summary>
        <content type="html"><![CDATA[<p>Jest 25 is laying the groundwork for many major changes in the future. As such, we kept breaking changes to a minimum, but internal architecture changes may require attention during the upgrade. The main changes are an upgrade of JSDOM from v11 to v15, 10-15% faster test runs, a new diff view for outdated snapshots and dropped Node 6 support.</p><p>There has been more than 200 commits since Jest 24.9 by more than 80 different contributors, so as always, take a look at the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">changelog</a> for a full list of changes.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="bye-node-6">Bye Node 6<a href="#bye-node-6" class="hash-link" aria-label="Bye Node 6 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Bye Node 6 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Node 6 has been EOL since April 30th 2019, and Jest 25 leaves it behind. Dropping Node 6 means we can upgrade our dependencies, the main one being JSDOM, which has been upgraded to version 15. Upgrading also means we no longer have to transpile <code>async-await</code> syntax, which results in both faster code execution and less memory consumption. As a bonus, Jest‚Äôs transpiled code should be easier to debug if anyone finds themselves tumbling down that particular rabbit hole.</p><p>Even though Node 8 has also entered EOL, Jest 25 will keep support for it to make the upgrade as easy as possible for those of us who still support Node 8. It does come with some tradeoffs though, such as JSDOM v16 having been released without Node 8 support, so you'll need to use <a href="https://www.npmjs.com/package/jest-environment-jsdom-sixteen" target="_blank" rel="noopener noreferrer"><code>jest-environment-jsdom-sixteen</code></a> if you want to use the latest version.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="performance-improvements">Performance improvements<a href="#performance-improvements" class="hash-link" aria-label="Performance improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Performance improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We‚Äôve gotten reports that Jest has slowed down over the last couple of releases. Jest 25 includes upgraded Micromatch, which brings huge gains in startup time, and some bug fixes and performance tweaks which brings Jest back to the speed it was at for Jest 23. For Jest itself, like mentioned at the beginning of this post, that means a 10-15% reduction of test runtime. We're always looking to improve here of course, so please check how it stacks up against earlier versions and create issues if we should be better!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="v8-code-coverage">V8 Code Coverage<a href="#v8-code-coverage" class="hash-link" aria-label="V8 Code Coverage „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="V8 Code Coverage „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest‚Äôs current code coverage instrumentation is powered by <code>babel-plugin-istanbul</code> inserting code coverage collection code before creating reports. However, this is quite slow and memory-intensive, especially for large files and code bases. Luckily, V8 has built-in code coverage, which is becoming more and more usable in Node thanks to the hard work of <a href="https://github.com/bcoe" target="_blank" rel="noopener noreferrer">Benjamin Coe</a> and others on the V8 and Node.js teams. Jest 25 comes with experimental support for this via a new <code>--coverage-provider</code> flag. Please see its <a href="/jest/ja/docs/configuration#coverageprovider-string">documentation</a> for caveats and how to use it.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="thinking-fast-and-slow-when-tests-fail">Thinking fast and slow when tests fail<a href="#thinking-fast-and-slow-when-tests-fail" class="hash-link" aria-label="Thinking fast and slow when tests fail „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Thinking fast and slow when tests fail „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Unnecessary effort to interpret the reports when tests fail hinders:</p><ul><li>‚Äúthinking fast‚Äù to recognize patterns from your past experience</li><li>‚Äúthinking slow‚Äù to analyze changes and decide whether they are expected progress or unexpected regressions</li></ul><p>Jest 25 completes the second half of an effort begun in Jest 24 to improve all matchers:</p><ul><li>correct description line, including <code>.rejects</code>, <code>.resolves</code>, and <code>.not</code> modifiers</li><li>concise labels and consistent alignment for expected and received values</li><li>inverse highlight of substring differences when expected and received are strings</li><li>counts of change lines in differences to know if they are only delete or insert</li></ul><p>Special thanks to Jest maintainer <a href="https://github.com/pedrottimark" target="_blank" rel="noopener noreferrer">Mark Pedrotti</a> for driving this effort and his continued work towards making expectation errors as good as they can be.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="colors-of-differences-when-snapshot-tests-fail">Colors of differences when snapshot tests fail<a href="#colors-of-differences-when-snapshot-tests-fail" class="hash-link" aria-label="Colors of differences when snapshot tests fail „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Colors of differences when snapshot tests fail „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The most obvious change to replace confusion with confidence is the colors of change lines in differences when snapshot tests fail:</p><ul><li><code>- Snapshot</code> changes from green to <strong>magenta</strong></li><li><code>+ Received</code> changes from red to <strong>teal</strong> foreground on cyan/aqua background</li></ul><p>Examples of snapshot test reports (before at left and after at right)</p><ol><li>Counts of changed lines confirm your first impression which way did the snapshot change (that is, deleted or inserted lines)</li></ol><p><img loading="lazy" alt="snapshot-insert-lines" src="/jest/ja/assets/images/25-snapshot-insert-lines-8168b88f07172d72e4d2cd0e05d200f1.png" width="1800" height="532" class="img_SS3x"></p><ol start="2"><li>Background colors attract your eyes to compare adjacent changed lines</li></ol><p><img loading="lazy" alt="snapshot-change-lines" src="/jest/ja/assets/images/25-snapshot-change-lines-d42906add66e08bb7c0ffffbca9a44bc.png" width="1800" height="504" class="img_SS3x"></p><ol start="3"><li>Background colors also help you see which <code>toThrow</code> tests require a decision whether or not to update the snapshot</li></ol><p><img loading="lazy" alt="snapshot-change-substrings" src="/jest/ja/assets/images/25-snapshot-change-substrings-0798d37f2f603ec43b57145cddc1247b.png" width="1800" height="168" class="img_SS3x"></p><p>Here are some reasons why we chose unique colors:</p><ul><li>The 95% of people who have full color vision can quickly recognize which reports are from snapshot tests versus all other matchers.</li><li>It solves the direct conflict between meaning of green/red in Jest tests versus red/green in code review.</li><li>Unlike a reversal to red/green which suggests that update is the default decision, it suggests that differences require more careful review for possible regression in local snapshot test failures than in code review (when problems have already been fixed).</li></ul><p>The difference in hue from magenta at 300¬∞ to teal/cyan/aqua at 180¬∞ gives better color vision accessibility and the light background tint for changed lines gives consistent contrast on light and dark themes.</p><p>If you maintain a command line tool, you might find inspiration to improve its accessibility in <a href="https://github.com/facebook/jest/pull/9132" target="_blank" rel="noopener noreferrer">#9132</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="ecmascript-modules-support">ECMAScript Modules support<a href="#ecmascript-modules-support" class="hash-link" aria-label="ECMAScript Modules support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="ECMAScript Modules support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Node 13 has unflagged ESM support, and we have started a tiny bit working towards native support in Jest. Jest 25 includes support for <code>jest.config.cjs</code> and <code>jest.config.mjs</code> configuration files, but tests themselves cannot yet be written using ESM without something like Babel or TypeScript transforming it into CJS.</p><p>The APIs Jest will use are still flagged and experimental, so don't expect support right away. These APIs are something the <a href="https://github.com/nodejs/modules" target="_blank" rel="noopener noreferrer">Node.js Modules team</a> is actively working on, and we'll be keeping an eye on it moving forward and experiment with them so we can provide feedback. You can subscribe to <a href="https://github.com/facebook/jest/issues/9430" target="_blank" rel="noopener noreferrer">this issue</a> to get any updates about the implementation status in Jest.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-improvements-and-updates">Other improvements and updates<a href="#other-improvements-and-updates" class="hash-link" aria-label="Other improvements and updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other improvements and updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li>Jest has passed <a href="https://github.com/facebook/jest/graphs/contributors" target="_blank" rel="noopener noreferrer">1000 unique contributors</a>. This is an incredible milestone! Thank you to everybody who helps us make testing as delightful as possible.</li><li>Thanks to community member <a href="https://github.com/JoshRosenstein" target="_blank" rel="noopener noreferrer">Josh Rosenstein</a>, Jest now comes with support for <code>BigInt</code> in most matchers, such as <code>toBeGreaterThan</code>. Jest will also understand bigint literals out of the box.</li><li>Jest‚Äôs feature <code>--detect-leaks</code> has been broken for Node 12 and newer - this has been fixed in Jest 25.</li><li>As announced in the blog post for Jest 24, Jest‚Äôs code base has been rewritten in TypeScript - this work was completed in Jest 24.3. So if you use any of Jest‚Äôs individual parts, you should get great IDE integration. Looking forward, we really want to make Jest mocks play nicer with type systems, and we‚Äôd love the community‚Äôs help with this. Please chime in <a href="https://github.com/facebook/jest/issues/7832" target="_blank" rel="noopener noreferrer">here</a> with ideas and send PRs! We‚Äôll also be investigating moving the typings for using Jest as a test runner from DefinitelyTyped into Jest itself.</li><li>The <code>jest-diff</code> package now exports functions like <code>diffLinesUnified</code> and <code>diffStringsUnified</code> which have configuration options, so other applications can format differences in a custom way. For more information and code examples, see its new <code>README.md</code> file in the Jest repository or on package repositories.</li><li>Thanks to community member <a href="https://github.com/WeiAnAn" target="_blank" rel="noopener noreferrer">Wei An Yen</a>, Jest will no longer highlight passing asymmetric matchers in expectation errors. This has been a long-standing pain point with asymmetric matchers and we're very happy it's finally solved.</li><li>For the second year running, Jest won the Highest Satisfaction award from <a href="https://2019.stateofjs.com/awards/" target="_blank" rel="noopener noreferrer">State of JS</a>. We are incredibly grateful for the support from the community, and hope we can build on this momentum to make 2020 even better!</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="plans-for-the-future">Plans for the future<a href="#plans-for-the-future" class="hash-link" aria-label="Plans for the future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Plans for the future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li>Jest‚Äôs configuration is vast and somewhat clunky - there is often <em>at least</em> two ways of doing the same thing, oftentimes even more. For Jest 26 we hope to condense the config down, and make it more predictable. See this <a href="https://github.com/facebook/jest/issues/7185" target="_blank" rel="noopener noreferrer">issue</a> for details.</li><li>We also hope to be able to provide a proper programmatic API for running Jest, to make integration into IDEs and other tooling easier. Please see <a href="https://github.com/facebook/jest/issues/5048" target="_blank" rel="noopener noreferrer">this</a> tracking issue.</li><li>There‚Äôs been an open PR for adding Lolex as an implementation of Jest‚Äôs fake timers since December 2017. While we‚Äôre not adding it to any public APIs in Jest 25, support for it is technically included and you we're looking into how to expose this so people can test and experiment with it. Using it means you can mock out <code>Date</code> and other timer function Jest currently doesn‚Äôt touch. Note that this should be considered experimental, and a proper API support will come in a later release. Follow <a href="https://github.com/facebook/jest/pull/7776" target="_blank" rel="noopener noreferrer">this PR</a> for the latest updates on the status.</li></ul><p>Happy Jesting! üÉè</p>]]></content>
        <author>
            <name>Simen Bekkhus</name>
            <uri>https://github.com/SimenB</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 24: üíÖ Refreshing, Polished, TypeScript-friendly]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2019/01/25/jest-24-refreshing-polished-typescript-friendly</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2019/01/25/jest-24-refreshing-polished-typescript-friendly"/>
        <updated>2019-01-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we are happy to announce the next major release of Jest - version 24! It's been 4 months since the last minor release, and 8 months since Jest 23, so this upgrade is a big one, with something for everyone! Highlights include built-in support for TypeScript by upgrading the Jest internals to Babel 7, fixing some long-standing issues with missing console output and performance issues when computing large diffs, and a brand new sparkling website. ‚ú®]]></summary>
        <content type="html"><![CDATA[<p>Today we are happy to announce the next major release of Jest - version 24! It's been 4 months since the last minor release, and 8 months since Jest 23, so this upgrade is a big one, with something for everyone! Highlights include built-in support for TypeScript by upgrading the Jest internals to Babel 7, fixing some long-standing issues with missing console output and performance issues when computing large diffs, and a brand new sparkling website. ‚ú®</p><p>For a full list of all changes see the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">changelog</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-website">New Website<a href="#new-website" class="hash-link" aria-label="New Website „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New Website „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p><a href="https://twitter.com/orta" target="_blank" rel="noopener noreferrer">@orta</a> has provided a beautiful redesign of Jest's website, which has been implemented by community members <a href="https://twitter.com/montogeek" target="_blank" rel="noopener noreferrer">@montogeek</a> and <a href="https://github.com/brainkim" target="_blank" rel="noopener noreferrer">@brainkim</a>.</p><p>The aim of the redesign was to highlight more of what makes Jest awesome, and to decouple the idea that Jest is primarily a tool for testing React apps - you can use Jest with all sorts of projects and we want to make that obvious. You can read more about the ideas behind the redesign in <a href="https://github.com/facebook/jest/issues/7265" target="_blank" rel="noopener noreferrer">this issue</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="typescript-support">TypeScript support<a href="#typescript-support" class="hash-link" aria-label="TypeScript support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="TypeScript support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We've upgraded to Babel 7 internally for Jest 24, which comes with support for TypeScript projects. That means Jest can support transpiling TypeScript out of the box, as long as you configure Babel to use it with <code>@babel/preset-typescript</code>. One caveat to the default TypeScript support, similar to Flow, is that Babel will only strip out the type annotations to make your code valid JavaScript. It will <em>not</em> typecheck your code.</p><p>While Jest has supported Babel 7 since version 22 released in December 2017, it required usage of a bridge module in order to fit in with Jest's support of Babel 6. In Jest 24 we have migrated entirely over to Babel 7, with great help from community member <a href="https://github.com/milesj" target="_blank" rel="noopener noreferrer">@milesj</a>. This means that setup is now easier and we can take advantage of other Babel 7 features, such as config loading and automatic <code>modules</code> transpilation. Make sure to remove the <code>babel-core@^7.0.0-bridge.0</code> as it's not needed now.</p><p>If you want to run typechecks while you test, you should use <a href="https://github.com/kulshekhar/ts-jest" target="_blank" rel="noopener noreferrer"><code>ts-jest</code></a>. You will need to configure the transformer, as Jest by default applies Babel to <code>.ts</code> (and <code>.tsx</code>) files. Alternatively, you can run <code>tsc</code> or even use a Jest runner to simultaneously transpile your TypeScript whilst running your tests! See <a href="https://github.com/azz/jest-runner-tsc" target="_blank" rel="noopener noreferrer"><code>jest-runner-tsc</code></a> for more information.</p><p>See <a href="/jest/ja/docs/getting-started#using-typescript">the docs</a> for more details.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_uH4V"><div class="admonitionHeading_P5_N"><span class="admonitionIcon_MF44"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>„Éí„É≥„Éà</div><div class="admonitionContent_yySL"><p>If you for whatever reason cannot upgrade to Babel 7, you can still use Jest 24 with <code>babel@6</code> as long as you keep <code>babel-jest</code> at version 23.</p></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="testtodo"><code>test.todo</code><a href="#testtodo" class="hash-link" aria-label="testtodo „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="testtodo „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest 23 had a change that made tests missing an implementation throw instead of being skipped. This change was made due to feedback that accidentally skipped tests were hard to discover and hard to track down. However, this change broke the workflow for quite a few developers who used the feature to sketch out which tests to write.</p><p>In Jest 24, we are addressing this issue by adding an explicit <code>test.todo</code> (inspired by the excellent AVA), which will be printed separately in the test summary. It allows you to quickly sketch out which tests you want to write and in the future, an <a href="https://eslint.org/" target="_blank" rel="noopener noreferrer">ESLint</a> rule might even be able to warn you that you have forgotten to write out some tests.</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">todo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'invalid input should throw'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">todo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'missing options should be normalized'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="test.todo" src="/jest/ja/assets/images/24-todo-c06adf4108c116aa230143cb8a147ae3.png" width="2324" height="1422" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-assertion-messages">Improved Assertion Messages<a href="#improved-assertion-messages" class="hash-link" aria-label="Improved Assertion Messages „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Improved Assertion Messages „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>When tests fail, you need to make confident and correct decisions which changes are expected progress and which changes are unexpected regressions. It is especially important not to miss a few regressions hidden among much progress. Jest 24 makes reports when assertions fail more clear and concise for several matchers. Because the effort will continue in Jest 25, you might notice some temporary inconsistencies. If your tests never fail, then you won't get to see them - for the rest of us, it'll be easier to debug why something isn't working as expected. Thanks for the hard work by <a href="https://twitter.com/ittordepam" target="_blank" rel="noopener noreferrer">@ittordepam</a> and other contributors from the community.</p><p>You can see these changes across all these PRs: <a href="https://github.com/facebook/jest/pull/7621" target="_blank" rel="noopener noreferrer">7621</a>, <a href="https://github.com/facebook/jest/pull/7557" target="_blank" rel="noopener noreferrer">7557</a>, <a href="https://github.com/facebook/jest/pull/7448" target="_blank" rel="noopener noreferrer">7448</a>, <a href="https://github.com/facebook/jest/pull/7325" target="_blank" rel="noopener noreferrer">7325</a>, <a href="https://github.com/facebook/jest/pull/7241" target="_blank" rel="noopener noreferrer">7241</a>, <a href="https://github.com/facebook/jest/pull/7152" target="_blank" rel="noopener noreferrer">7152</a>, <a href="https://github.com/facebook/jest/pull/7125" target="_blank" rel="noopener noreferrer">7125</a>, <a href="https://github.com/facebook/jest/pull/7107" target="_blank" rel="noopener noreferrer">7107</a>, <a href="https://github.com/facebook/jest/pull/6961" target="_blank" rel="noopener noreferrer">6961</a>.</p><p>Examples:</p><p>Failing assertion</p><p><img loading="lazy" alt="failing assertion" src="/jest/ja/assets/images/24-assertion-error-424a6b04bd7012af7d80419981d553d4.png" width="1844" height="1246" class="img_SS3x"></p><p>Type mismatch</p><p><img loading="lazy" alt="different types" src="/jest/ja/assets/images/24-different-types-6cdc48fef8c458eeb7b804ba60f4661e.png" width="1844" height="1246" class="img_SS3x"></p><p>Mock function not called</p><p><img loading="lazy" alt="mock functions" src="/jest/ja/assets/images/24-mock-function-c93fb0afe32cea366976c870d89d9309.png" width="1844" height="1246" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="fixing-old-pain">Fixing old pain<a href="#fixing-old-pain" class="hash-link" aria-label="Fixing old pain „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Fixing old pain „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We've fixed a couple of really old issues in this release.</p><p>The first one we'd like to highlight is <code>console.log</code> statements going missing. Jest intercepts and collects all logs in order to give you a stack trace to them, as well as provide them to reporters so you can handle them however you want. However, this has led to an issue where they have simply been missing in certain edge cases. Luckily for Jest 24, <a href="https://twitter.com/spion" target="_blank" rel="noopener noreferrer">@spion</a> has <a href="https://github.com/facebook/jest/pull/6871" target="_blank" rel="noopener noreferrer">stepped up</a> and fixed this issue. Thank you very much!</p><p>The second one is an issue where Jest runs out of memory if the difference in serialization of expected and received value has a huge number of insertion changes (either unexpected because of mistake in test or defect in serializer or expected because of temporary failures during test-driven development). <a href="https://twitter.com/ittordepam" target="_blank" rel="noopener noreferrer">@ittordepam</a> has <a href="https://github.com/facebook/jest/pull/6961" target="_blank" rel="noopener noreferrer">replaced</a> the previous diffing algorithm with <code>diff-sequences</code> package, which should fix this issue because it uses the theoretical minimum amount of memory. It opens up possibility for word-diffs in the future, similar to what <a href="https://git-scm.com/docs/git-diff#git-diff---word-diffltmodegt" target="_blank" rel="noopener noreferrer">git provides</a>. Please see <a href="https://github.com/facebook/jest/pull/4619" target="_blank" rel="noopener noreferrer">this PR</a> and don't hesitate to reach out if you want to help make that happen!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-highlights">Other highlights<a href="#other-highlights" class="hash-link" aria-label="Other highlights „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other highlights „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li>We have some improvements for <code>globalSetup</code> and <code>globalTeardown</code> as well - code transformation will be applied to them similar to <code>setupFiles</code> and they are now supported as part of <code>projects</code>.</li><li>You can <a href="https://github.com/facebook/jest/pull/6143" target="_blank" rel="noopener noreferrer">configure</a> Jest's snapshot location, this is mainly useful if you are building tools which use Jest in a larger build process.</li><li>A quirk of Jest's CLI has been that while some flags and options have been camel cased (such as <code>runInBand</code>), others have not been (such as <code>no-cache</code>). In Jest 24, both are recognized, meaning you can write your CLI arguments however you want.</li><li>We've renamed <code>setupTestFrameworkScriptFile</code> to <code>setupFilesAfterEnv</code>, and made it into an array. We hope this will make it more obvious what the options is for. We have plans to further overhaul the configuration in the next major, see the paragraph in the section below.</li><li>To reduce the amount of magic Jest performs to ‚Äújust work‚Ñ¢‚Äù, in this release we decided to drop automatic injection of <code>regenerator-runtime</code>, which is sometimes used in compiled async code. Including <code>regenerator-runtime</code> is not always necessary and we believe it's the user's responsibility to include it if it's needed. If you use <code>@babel/preset-env</code> with <code>targets</code> set to a modern Node version (e.g. Node 6+) you will not need to include it. Please see our <a href="/jest/ja/docs/getting-started#using-babel">Using Babel docs</a> for more information.</li><li>Node.js 10 came with an experimental module <a href="https://nodejs.org/api/worker_threads.html" target="_blank" rel="noopener noreferrer">called <code>worker_threads</code></a>, which is similar to Worker threads in the browser. <code>jest-worker</code>, part of the <a href="/jest/ja/docs/jest-platform">Jest platform</a>, will be able to use <code>worker_threads</code> if available instead of <code>child_process</code>, which makes it even faster! <a href="https://github.com/facebook/jest/pull/6676" target="_blank" rel="noopener noreferrer">Benchmarks</a> show a 50% improvement. Due to its experimental nature, it's not enabled when using Jest as a test runner, but you can use it in your own projects today! We plan to enable it by default when it's promoted from experimental status in Node.js.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="breaking-changes">Breaking Changes<a href="#breaking-changes" class="hash-link" aria-label="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>While all breaking changes are listed in the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">changelog</a>, there's a few of them that are worth highlighting:</p><ul><li>We've upgraded to Micromatch 3. While this might not affect every user, it is stricter in its parsing of globs than version 2, which is used in Jest 23. Please read through <a href="https://github.com/micromatch/micromatch/issues/133#issuecomment-404211484" target="_blank" rel="noopener noreferrer">this</a> and linked issues for examples of invalid globs in case you have problems.</li><li>We've removed code remnants that was needed for Node 4. It was previously technically possible to run Jest 23 on Node 4 - that is no longer possible without polyfilling and transpiling.</li><li>Some changes to serialization of mock functions in snapshots - make sure to double check your updated snapshots after upgrading. Related <a href="https://github.com/facebook/jest/pull/6381" target="_blank" rel="noopener noreferrer">PR</a>.</li><li>Jest no longer automatically injects <code>regenerator-runtime</code> - if you get errors concerning it, make sure to configure Babel to properly transpile <code>async</code> functions, using e.g. <code>@babel/preset-env</code>. Related <a href="https://github.com/facebook/jest/pull/7595" target="_blank" rel="noopener noreferrer">PR</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="the-future">The future<a href="#the-future" class="hash-link" aria-label="The future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="The future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We are incredibly humbled by the results in <a href="https://2018.stateofjs.com/awards/" target="_blank" rel="noopener noreferrer">State Of JS 2018</a>, where Jest won the ‚ÄúHighest Satisfaction‚Äù award. Another huge thing to happen in 2018 was in October, when Jest passed 2 million weekly downloads for the first time. Thank you.</p><p>We are very thankful for the trust in us shown by the community, and hope to build on it in the future. We will ensure Jest 24 and future releases will continue to build upon this incredible foundation, and continue to be an integral part of JavaScript developers' toolkits.</p><p>This has been the first release where we have explored the idea of using our Open Collective funding to create bug bounties. This worked well in getting non-core developers involved in the implementation of the new landing page, and we're optimistic for a long running bug where Jest globals <a href="https://github.com/facebook/jest/issues/2549" target="_blank" rel="noopener noreferrer">are mismatched</a> from Node globals. We'd like to do more, if you have a pet bug that's a good candidate for our bounty program, please let us know. In the meantime, you can find all the tickets with a bounty via <a href="https://github.com/facebook/jest/labels/Has%20Bounty" target="_blank" rel="noopener noreferrer">the issue label</a>.</p><p>We have already started to make plans for the next release of Jest 25, with the biggest planned feature being an overhaul of our configuration, which is pretty hard to grok, mainly because of overlapping option and mixing globs and regular expressions. Feedback on how you want Jest's configuration to look is very much welcome, and can be submitted in <a href="https://github.com/facebook/jest/issues/7185" target="_blank" rel="noopener noreferrer">this issue</a>.</p><p>You might also have heard that we are planning to migrate the code base from Flow to TypeScript. We are hopeful that this migration will enable even more contributors to jump in and help make 2019 even better for JavaScript testing. üöÄ The plan is to land this in a minor release in the not too distant future. Feedback on this choice can be added to <a href="https://github.com/facebook/jest/pull/7554" target="_blank" rel="noopener noreferrer">the RFC</a>.</p><p>Lastly, if you've ever wondered about how Jest is built, <a href="https://twitter.com/cpojer" target="_blank" rel="noopener noreferrer">@cpojer</a> has recorded a video with an architectural overview of how Jest is put together under the hood. Feel free to reach out if you have any further questions about it. The video is available on our <a href="/jest/ja/docs/architecture">website</a>.</p><p>Happy Jesting! üÉè</p>]]></content>
        <author>
            <name>Simen Bekkhus</name>
            <uri>https://github.com/SimenB</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Supporting Jest Open Source]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2018/06/27/supporting-jest-open-source</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2018/06/27/supporting-jest-open-source"/>
        <updated>2018-06-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Jest is maintained by a community of open source contributors and Facebook employees.]]></summary>
        <content type="html"><![CDATA[<p>Jest is maintained by a community of open source contributors and Facebook employees.</p><p>Our open source contributors work on behalf of the community to create new features, fix bugs, and maintain the issue backlog. Facebook employees do the same, focused on the problems specific to Facebook's scale, and run all proposed releases on Facebook's enormous test suite before publishing.</p><p>All of us do our part to make testing delightful.</p><p>At the Jest Summit we announced the Jest Open Collective. This is our way to help support the efforts of the open source Jest community. <strong>To be absolutely clear: Facebook employees cannot benefit from the Jest Open Collective.</strong> The collective's sole purpose is to support the open source side of the Jest community.</p><p>In this post we'll outline what the Jest Open Collective is, the structure, and the goals we have.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="the-jest-open-collective">The Jest Open Collective<a href="#the-jest-open-collective" class="hash-link" aria-label="The Jest Open Collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="The Jest Open Collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p><img loading="lazy" alt="Banner image for Jest Open Collective" src="/jest/ja/assets/images/collective-fcec198ec20af7c295dbdab660e972b5.png" width="1869" height="800" class="img_SS3x"></p><p>Open Collective is a platform to manage groups of people transparently. Jest joins projects like <a href="https://opencollective.com/webpack" target="_blank" rel="noopener noreferrer">webpack</a>, <a href="https://opencollective.com/babel" target="_blank" rel="noopener noreferrer">Babel</a>, <a href="https://opencollective.com/mochajs" target="_blank" rel="noopener noreferrer">Mocha</a>, <a href="https://opencollective.com/preact" target="_blank" rel="noopener noreferrer">Preact</a>, <a href="https://opencollective.com/vuejs" target="_blank" rel="noopener noreferrer">Vue</a>, and many more in supporting the open source community through the Open Collective platform.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="what-is-the-jest-open-collective">What is the Jest Open Collective<a href="#what-is-the-jest-open-collective" class="hash-link" aria-label="What is the Jest Open Collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="What is the Jest Open Collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>The Jest Open Collective is a group of open source contributors who operate in full transparency to:</p><ul><li>Receive funds from backers and sponsors</li><li>Approve expenses submitted by the community</li><li>Give everyone visibility on the budget</li></ul><h3 class="anchor anchorWithStickyNavbar_JmGV" id="what-is-the-structure-of-the-collective">What is the structure of the collective<a href="#what-is-the-structure-of-the-collective" class="hash-link" aria-label="What is the structure of the collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="What is the structure of the collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>The Jest Open Collective is currently managed by three non-Facebook core contributors from the open source community:</p><ul><li><a href="https://twitter.com/thymikee" target="_blank" rel="noopener noreferrer">Michal Pierzchala</a></li><li><a href="https://github.com/simenb" target="_blank" rel="noopener noreferrer">Simen Bekkhus</a></li><li><a href="https://twitter.com/rickhanlonii" target="_blank" rel="noopener noreferrer">Rick Hanlon</a></li></ul><p>Michal has been an active Jest contributor since September 2016, Simen joined the core team in June 2017, and Rick joined in January. They're responsible for setting the budget, approving expenses, and managing admins of the collective. We have elected to keep <a href="https://twitter.com/cpojer" target="_blank" rel="noopener noreferrer">Christoph Nakazawa</a> as an adviser.</p><p>There are two levels of support for the collective: Backer and Sponsor.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="backers">Backers<a href="#backers" class="hash-link" aria-label="Backers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Backers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>Backers of the collective are individuals contributing at least \$2/month. We'll include a list of backers on the Jest homepage, README on github/yarn/npm, and Contributors page.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="sponsors">Sponsors<a href="#sponsors" class="hash-link" aria-label="Sponsors „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Sponsors „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>Sponsors of the collective are individuals and organizations contributing at least $100/month. We'll place sponsor logos with a link to their site on the Jest homepage, README on github/yarn/npm, and Contributors page.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="what-is-the-goal-of-the-collective">What is the goal of the collective<a href="#what-is-the-goal-of-the-collective" class="hash-link" aria-label="What is the goal of the collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="What is the goal of the collective „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>The goal of the collective is to support the work of open source contributors to Jest in order to make testing delightful.</p><p>To achieve that goal, we will use the funds to:</p><ul><li>Cover speaker travel expenses</li><li>Host events and meetups</li><li>Print and distribute swag</li><li>Develop and fund a bug bounty program (TBD)</li></ul><p>This is just the beginning and we're committed to getting this right. If you have ideas on how else we can support the community, or feedback on the structure of the collective, please reach out to us on <a href="https://twitter.com/fbjest" target="_blank" rel="noopener noreferrer">twitter</a>!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="thank-you">Thank You<a href="#thank-you" class="hash-link" aria-label="Thank You „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Thank You „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Finally, thank you to everyone who contributes to the Jest community and open source in general. We are incredibly grateful that we get the opportunity to work on improving JavaScript testing together.</p><p>The Jest core team would also like to make a special thank you to Facebook Open Source for driving the creation of this collective.</p>]]></content>
        <author>
            <name>Rick Hanlon II</name>
            <uri>https://twitter.com/rickhanlonii</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 23: üî• Blazing Fast Delightful Testing]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2018/05/29/jest-23-blazing-fast-delightful-testing</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2018/05/29/jest-23-blazing-fast-delightful-testing"/>
        <updated>2018-05-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we are excited to announce Jest 23, our largest major release to date! Together with over 100 contributors, we've shipped a ton of features and bug fixes. Thank you to everyone in the community for helping make JavaScript Testing Delightful.]]></summary>
        <content type="html"><![CDATA[<p>Today we are excited to announce Jest 23, our largest major release to date! Together with over 100 contributors, we've shipped a ton of features and bug fixes. Thank you to everyone in the community for helping make JavaScript Testing Delightful.</p><p>We would also like to welcome both <a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer">Babel</a> and <a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">webpack</a> to the Jest community! After converting from Mocha to Jest 23 Beta, webpack saw their total test suite time reduced 6x from over 13 minutes to 2 minutes 20 seconds. <a href="https://twitter.com/search?q=%23blazingmeansgood" target="_blank" rel="noopener noreferrer">#blazingmeansgood</a></p><p>Here's are some of the Jest 23 highlights and breaking changes.</p><p>For a full list see the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">changelog</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="interactive-snapshot-mode">Interactive Snapshot Mode<a href="#interactive-snapshot-mode" class="hash-link" aria-label="Interactive Snapshot Mode „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Interactive Snapshot Mode „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We've added a new default watch menu option we're calling Interactive Snapshot Mode. This new mode allows you to step through each failing snapshot in each failing suite to review your failed snapshots and choose to update or skip each individually.</p><p><img loading="lazy" alt="Interactive snapshot mode in action" src="/jest/ja/assets/images/23-interactive-3b2c2f9ec0fecc4effbc03fbc3ad1963.gif" width="1004" height="732" class="img_SS3x"></p><p>See the Interactive Snapshot Mode docs <a href="/jest/ja/docs/snapshot-testing#interactive-snapshot-mode">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="snapshot-property-matchers">Snapshot Property Matchers<a href="#snapshot-property-matchers" class="hash-link" aria-label="Snapshot Property Matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Snapshot Property Matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Often, objects you're snapshotting contain generated values like Dates and IDs. Jest now allows you to pass properties to the snapshot matcher which specify the structure of the data instead of the specific values. These property matchers are then verified before serializing the matcher type (instead of the value), giving you consistent snapshot results across test runs.</p><p><img loading="lazy" alt="Snapshot Property Matchers" src="/jest/ja/assets/images/23-snapshot-matchers-aa63fd590f453650a67eaa0d99f678e3.png" width="2236" height="1177" class="img_SS3x"></p><p>See the updated <code>toMatchSnapshot</code> <a href="/jest/ja/docs/expect#tomatchsnapshotpropertymatchers-snapshotname">docs</a> or the Property Matcher <a href="/jest/ja/docs/snapshot-testing#property-matchers">guide</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="custom-asynchronous-matchers">Custom Asynchronous matchers<a href="#custom-asynchronous-matchers" class="hash-link" aria-label="Custom Asynchronous matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Custom Asynchronous matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We now support asynchronous matchers with <code>expect.extends</code>! Async matchers return a Promise so that you can <code>await</code> for the matcher to resolve. As an example:</p><p><img loading="lazy" alt="Custom asynchronous matchers in action" src="/jest/ja/assets/images/23-async-matchers-91183e14fbce836540d2079f145dbe97.png" width="2230" height="876" class="img_SS3x"></p><p>Docs available <a href="/jest/ja/docs/expect#expectextendmatchers">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="custom-asymmetric-matchers">Custom Asymmetric Matchers<a href="#custom-asymmetric-matchers" class="hash-link" aria-label="Custom Asymmetric Matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Custom Asymmetric Matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Asymmetric matchers are a great tool to use when you only care about asymmetric equality. For example, when the left side is expected to be an object with some subset of properties on the right, instead of an exact match. Jest provides a number of asymmetric matchers out of the box, and in this release we're introducing Custom Asymmetric Matchers.</p><p><img loading="lazy" alt="Custom asymmetric matchers in action" src="/jest/ja/assets/images/23-asymmetric-matchers-12a593708f9e4cec91225d63c49e959e.png" width="2230" height="1012" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="jest-each">Jest Each<a href="#jest-each" class="hash-link" aria-label="Jest Each „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Jest Each „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p><a href="https://twitter.com/mattphillipsio" target="_blank" rel="noopener noreferrer">@mattphillipsio</a> has donated the <code>jest-each</code> package to Jest Core (thanks Matt!). <code>jest-each</code> is a library inspired by <a href="https://yarnpkg.com/en/package/mocha-each" target="_blank" rel="noopener noreferrer"><code>mocha-each</code></a> and <a href="http://spockframework.org/spock/docs/1.1/data_driven_testing.html#data-tables" target="_blank" rel="noopener noreferrer">Spock Data Tables</a> which allows you to define a table of test cases, and then run a test for each row with the specified column values. We support both array types and template literals for all flavors of <code>describe</code> and <code>test</code>. Docs are available <a href="/jest/ja/docs/api#testeachtable-name-fn">here</a>, and for those not on Jest 23 yet, we're still publishing <a href="https://yarnpkg.com/en/package/jest-each" target="_blank" rel="noopener noreferrer"><code>jest-each</code></a> separately!</p><p><img loading="lazy" alt="jest-each in action" src="/jest/ja/assets/images/23-jest-each-3d938745102750ad491139ea700842ab.png" width="2230" height="1304" class="img_SS3x"></p><p>Huge shout out to Prettier for <a href="https://github.com/prettier/prettier/pull/4423" target="_blank" rel="noopener noreferrer">fixing</a> the table formatting so quickly (<a href="https://prettier.io/blog/2018/05/23/1.13.0.html#format-new-describeeach-table-in-jest-23-4423-by-ikatyang" target="_blank" rel="noopener noreferrer">see Prettier 1.13</a>)!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-matchers">New Matchers<a href="#new-matchers" class="hash-link" aria-label="New Matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New Matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We only add matchers to core if we believe they will be useful to a large amount of people in the Jest community, and leave the majority of matchers to the community (see <a href="https://yarnpkg.com/en/package/jest-extended" target="_blank" rel="noopener noreferrer">jest-extended</a>). Some matchers make the cut into core, and Jest 23 adds:</p><ul><li>nthCalledWith</li><li>toReturn</li><li>toReturnTimes</li><li>toReturnWith</li><li>lastReturnedWith</li><li>nthReturnedWith</li><li>toStrictEqual</li></ul><p><img loading="lazy" alt="New matchers in action" src="/jest/ja/assets/images/23-new-matchers-8aaaad14f7dc524a46b99503b6ede43b.png" width="2230" height="1276" class="img_SS3x"></p><p>See the updated expect docs <a href="/jest/ja/docs/expect">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="debug-hanging-tests">Debug Hanging Tests<a href="#debug-hanging-tests" class="hash-link" aria-label="Debug Hanging Tests „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Debug Hanging Tests „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>A common issue we see on the issue tracker relates to ‚ÄúJest‚Äù hanging after a test run. This is usually due to app code leaving handles open, preventing Jest from exiting. In the past, users have resorted to <code>--forceExit</code> to fix (not recommended).</p><p>To help debug these issues, we're now detecting when Jest does not exit:</p><p><img loading="lazy" alt="Detecting hanging tests" src="/jest/ja/assets/images/23-hanging-before-867f8f3cfd6d67bb5ce37bf11f053749.png" width="2236" height="780" class="img_SS3x"></p><p>And we offer a new flag <code>--detectOpenHandles</code> to help find the open handles:</p><p><img loading="lazy" alt="Running detectOpenHandles" src="/jest/ja/assets/images/23-hanging-after-4f446e62ff117f6ae7f669d56057d206.png" width="2236" height="1106" class="img_SS3x"></p><p>See the updated CLI docs <a href="/jest/ja/docs/cli#detectopenhandles">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="watch-mode-plugins">Watch Mode Plugins<a href="#watch-mode-plugins" class="hash-link" aria-label="Watch Mode Plugins „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Watch Mode Plugins „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We have completely rewritten the watch mode system to allow adding custom plugins to watch mode. Watch Mode Plugins now make it possible to hook into Jest events and provide custom menu options in the Watch Mode Menu. All of the default Watch Mode prompts are implemented as plugins in this system, and the docs to create your own are available <a href="/jest/ja/docs/watch-plugins">here</a>.</p><p>With this change, we're also now able to bring back typeahead support as a Watch Mode Plugin via <a href="https://yarnpkg.com/en/package/jest-watch-typeahead" target="_blank" rel="noopener noreferrer">jest-watch-typeahead</a>!</p><p><img loading="lazy" alt="Typeahead plugin in action" src="/jest/ja/assets/images/23-typeahead-b16e5a1f51f3b3852df9fcc508c920d1.gif" width="1001" height="731" class="img_SS3x"></p><p>See <a href="https://github.com/jest-community/jest-watch-typeahead" target="_blank" rel="noopener noreferrer">jest-watch-typeahead</a> for documentation and install instructions. Huge thank you to <a href="https://twitter.com/rogeliog" target="_blank" rel="noopener noreferrer">@rogeliog</a> for the new watch mode plugin system and the jest-watch-typeahead plugin!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="breaking-changes">Breaking Changes<a href="#breaking-changes" class="hash-link" aria-label="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As with every major release, we are making a few breaking changes to make larger changes in the future possible and to push the testing experience to a new level. Here's a list of the biggest changes you may see:</p><ul><li><strong>Require test descriptions and functions</strong>: We're now failing tests that do not include both a function and a description.</li><li><strong>Remove undefined props from React snapshots</strong>: Smaller snapshots and proper React behavior.</li><li><strong>Remove deprecations</strong>: We removed mapCoverage since it's no longer needed. Additionally, we removed <code>jest.genMockFunction</code> and <code>jest.genMockFn</code> since these are the same as <code>jest.fn</code>.</li><li><strong>Add snapshot names to failures</strong>: We added the snapshot name (if provided) to the snapshot failure message so it's easier to find the snapshot that's failing.</li><li><strong>Replace mock timestamps</strong>: We replaced mock timestamps with invocationCallOrder since two or mocks may often have the same timestamp, making it impossible to test the call order.</li><li><strong>Add results to mock snapshots</strong>: We added mock function call results to snapshots so that both the calls and the results of the invocation are tracked.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-improvements">Other Improvements<a href="#other-improvements" class="hash-link" aria-label="Other Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li><strong>Watch mode coverage</strong>: Coverage is now limited to only the files tested in watch mode or when using <code>--onlyChanged</code> and <code>--findRelatedTests</code>.</li><li><strong>Version documentation</strong>: We added docs for each minor release back to Jest 22, and have removed all of the ‚ÄúRequires Jest X.X+‚Äù from the docs.</li><li><strong>Better snapshot summaries</strong>: We overhauled the Snapshot Summary output to make obsolete snapshots more informative.</li><li><strong>Better stack traces</strong>: We added stack traces to asynchronous errors, timeout errors, expect.assertions, and thrown non-errors. We're also indicating the column in the code frame!</li><li><strong>Better React 16 support</strong>: Adds snapshot support for <code>React.Fragment</code>, <code>React.forwardRef</code>, and <code>React.createContext</code>.</li><li><strong>Track mock return and throw values</strong>: Adds <code>mock.results</code> that contains the return value or thrown value for each mock call.</li><li><strong>Blazing üî•</strong>: We've added a blazing badge to the README to indicate that Jest is blazing good.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="jest-summit">Jest Summit<a href="#jest-summit" class="hash-link" aria-label="Jest Summit „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Jest Summit „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Last week, the Jest Core Team met for the Jest Summit at Facebook London where worked on and released Jest 23, announced the Jest Open Collective, and gave a number of talks:</p><ul><li><strong>Christoph Nakazawa</strong> ‚Äì <a href="https://www.youtube.com/watch?v=cAKYQpTC7MA" target="_blank" rel="noopener noreferrer">Intro</a></li><li><strong>Aaron Abramov</strong> ‚Äì <a href="https://youtu.be/cAKYQpTC7MA?t=440" target="_blank" rel="noopener noreferrer">Writing Meaningful Tests</a></li><li><strong>Rick Hanlon II</strong> ‚Äì <a href="https://youtu.be/cAKYQpTC7MA?t=1881" target="_blank" rel="noopener noreferrer">Blazing Fast Snapshot Testing in Jest 23</a></li><li><strong>Simen Bekkhus</strong> ‚Äì <a href="https://youtu.be/cAKYQpTC7MA?t=2990" target="_blank" rel="noopener noreferrer">Jest's Delightful Error Messages</a></li><li><strong>Matt Phillips</strong> ‚Äì <a href="https://youtu.be/cAKYQpTC7MA?t=3852" target="_blank" rel="noopener noreferrer">Level up your Jest experience with community packages</a></li><li><strong>Michele Bertoli</strong> ‚Äì <a href="https://youtu.be/cAKYQpTC7MA?t=4582" target="_blank" rel="noopener noreferrer">Snapshot all the things</a></li><li><strong>Jordan Eldredge</strong> ‚Äì <a href="https://youtu.be/cAKYQpTC7MA?t=5185" target="_blank" rel="noopener noreferrer">Webamp: Learn by imitating</a></li></ul><p>Full talk is available <a href="https://www.youtube.com/watch?v=cAKYQpTC7MA" target="_blank" rel="noopener noreferrer">here</a>.</p><p>The turnout was amazing, and we were able to meet a lot of the London-based community in person. Thank you to everyone who joined us and for your continued support! Stay tuned for our next post which will outline the Jest Open Collective and the plans we have for the future.</p><p><em>As always, this release couldn't have been possible without you, the JavaScript community. We are incredibly grateful that we get the opportunity to work on improving JavaScript testing together. If you'd like to contribute to Jest, please don't hesitate to reach out to us on</em> <em><a href="https://github.com/facebook/jest" target="_blank" rel="noopener noreferrer">GitHub</a> or on</em> <em><a href="https://discord.gg/j6FKKQQrW9" target="_blank" rel="noopener noreferrer">Discord</a>.</em></p>]]></content>
        <author>
            <name>Rick Hanlon II</name>
            <uri>https://twitter.com/rickhanlonii</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 22: Refinements & Custom Runners]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2017/12/18/jest-22</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2017/12/18/jest-22"/>
        <updated>2017-12-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we are announcing a new major version of Jest which refines almost all parts of Jest to provide a more solid testing foundation. Together with the Jest community we made a number of changes across the board that will help you get more out of Jest. We are also graduating the custom runners feature out of the experimental stage and added a new package, jest-worker, for parallelizing work across multiple processes. We have compiled a list of highlights below but make sure to check out the (as always) massive changelog.]]></summary>
        <content type="html"><![CDATA[<p>Today we are announcing a new major version of Jest which refines almost all parts of Jest to provide a more solid testing foundation. Together with the Jest community we made a number of changes across the board that will help you get more out of Jest. We are also graduating the custom runners feature out of the experimental stage and added a new package, <code>jest-worker</code>, for parallelizing work across multiple processes. We have compiled a list of highlights below but make sure to check out the (as always) <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">massive changelog</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="good-bye-node-4--welcome-jsdom-11">Good bye Node 4 &amp; welcome JSDOM 11<a href="#good-bye-node-4--welcome-jsdom-11" class="hash-link" aria-label="Good bye Node 4 &amp; welcome JSDOM 11 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Good bye Node 4 &amp; welcome JSDOM 11 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>With this release we are dropping support for Node 4, mainly because one of our main dependencies, JSDOM, ended their support. Jest now comes out of the box with JSDOM 11 which features better support for SVGs, <code>requestAnimationFrame</code>, <code>URL</code> and <code>URLSearchParams</code> built in, and <a href="https://github.com/jsdom/jsdom/blob/master/Changelog.md" target="_blank" rel="noopener noreferrer">much more</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="custom-runners--easy-parallelization-with-jest-worker">Custom Runners + Easy parallelization with <code>jest-worker</code><a href="#custom-runners--easy-parallelization-with-jest-worker" class="hash-link" aria-label="custom-runners--easy-parallelization-with-jest-worker „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="custom-runners--easy-parallelization-with-jest-worker „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>In Jest 21 we introduced the concept of custom Jest runners. Since then, Rogelio, one of Jest's core contributors, built a number of useful runners: If you have many existing tests written using another framework but you'd like to immediately benefit from Jest's features, check out <a href="https://yarnpkg.com/en/package/jest-runner-mocha" target="_blank" rel="noopener noreferrer">jest-runner-mocha</a>. If you have a large codebase that needs linting, <a href="https://twitter.com/lencioni/status/907398856756695040" target="_blank" rel="noopener noreferrer">you may get a significant speedup</a> if you run eslint within Jest using <a href="https://yarnpkg.com/en/package/jest-runner-eslint" target="_blank" rel="noopener noreferrer">jest-runner-eslint</a>.</p><p>To gain more of fine-grained control over heavy tasks parallelization (e.g. transforming files or crawling the file system), we designed a new library perfectly suited for the job. We developed a modern, Promise-based module with an approachable API, called <code>jest-worker</code>, that allows you to delegate to child processes those intensive functions. As <code>jest-worker</code>, like any other Jest package, is a part of the Jest platform, you can use it however you like even without ever using Jest itself. You'll find more in the documentation <a href="https://yarnpkg.com/en/package/jest-worker" target="_blank" rel="noopener noreferrer">here</a>.</p><p>To get a better understanding of custom runners and Jest as a platform, make sure to check out Rogelio's talk from Reactive Conf 2017: <a href="https://www.youtube.com/watch?v=NtjyeojAOBs" target="_blank" rel="noopener noreferrer">Jest as a Platform</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="codeframe-in-test-failures">Codeframe in test failures<a href="#codeframe-in-test-failures" class="hash-link" aria-label="Codeframe in test failures „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Codeframe in test failures „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>In order to more easily identify which assertion is failing your test, we've added a code frame showing the context where the assertion is in order to focus on your own code. See the following example test:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#6b2e85">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'some test'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#297a29">function</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">someFunctionWhichShouldThrow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#297a29">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#297a29">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#297a29">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#297a29">return</span><span class="token plain"> </span><span class="token string" style="color:#c21325">'success!'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">someFunctionWhichShouldThrow</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toThrow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In Jest 21, we would display the following error:</p><p><img loading="lazy" alt="failure in Jest 21" src="/jest/ja/assets/images/22-failure-21-a7eb296a994d13405234955abd946adc.png" width="972" height="650" class="img_SS3x"></p><p>In Jest 22, we have added a codeframe, giving more context to the failing assertions. We have also cleaned up the stack trace to remove more clutter than ever.</p><p><img loading="lazy" alt="failure in Jest 22" src="/jest/ja/assets/images/22-failure-22-2dfad8dd25ea9b4b87a9359658f5eab4.png" width="938" height="744" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="easier-testing-of-errors-thrown-in-async-code">Easier testing of errors thrown in async code<a href="#easier-testing-of-errors-thrown-in-async-code" class="hash-link" aria-label="Easier testing of errors thrown in async code „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Easier testing of errors thrown in async code „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>You can now use <code>toThrow</code> and <code>toThrowErrorMatchingSnapshot</code> on promise rejections in the same way you can on synchronous errors.</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#297a29">async</span><span class="token plain"> </span><span class="token keyword" style="color:#297a29">function</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">throwingFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#297a29">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#297a29">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'This failed'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'asynchronous rejection'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#297a29">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#297a29">await</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#6b2e85">throwingFunction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rejects</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toThrowErrorMatchingSnapshot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="asynchronous-test-environments">Asynchronous test environments<a href="#asynchronous-test-environments" class="hash-link" aria-label="Asynchronous test environments „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Asynchronous test environments „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>When <a href="https://github.com/GoogleChrome/puppeteer/" target="_blank" rel="noopener noreferrer">Puppeteer</a>, a way of programmatically interacting with a real Chromium Browser, was announced by the Google Chrome team in August, many wanted to be able to use Jest to write their tests running them in Chrome. The community have helped us out making this possible by allowing asynchronous test environments. We are still working on making this experience as good as possible, but please see <a href="/jest/ja/docs/puppeteer">this guide</a> for how to use Puppeteer with Jest, starting today.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-leak-detection">Experimental Leak Detection<a href="#experimental-leak-detection" class="hash-link" aria-label="Experimental Leak Detection „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Experimental Leak Detection „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We added an experimental <code>--detectLeaks</code> setting to Jest that will let you know if your internal environment instance is leaked after a test execution. It will also warn you when your test suite tries to require a file after the test has finished, meaning you forgot to wait for all async operations or left something not properly cleaned. This will however not discover leaks in user land code, only in test land code; although the technology used behind it can help you (see <code>jest-leak-detector</code>). If you are reporting a bug about Jest's memory usage, please provide a repro where <code>--detectLeaks</code> will make the test suite fail. We <a href="https://github.com/facebook/jest/pull/4970" target="_blank" rel="noopener noreferrer">started building a better sandboxing mechanism</a> for Jest but it's not ready yet to be enabled by default. If you'd like to help, please reach out to us on discord!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="watch-mode-refinements">Watch Mode Refinements<a href="#watch-mode-refinements" class="hash-link" aria-label="Watch Mode Refinements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Watch Mode Refinements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>When using watch mode, there is now a way to <a href="https://github.com/facebook/jest/pull/4886" target="_blank" rel="noopener noreferrer">focus only on tests that previously failed</a>. In this mode, Jest will not re-run previously passing tests which should help you iron out all test failures. Additionally, <a href="https://github.com/facebook/jest/pull/4841" target="_blank" rel="noopener noreferrer">we added a plugin system to watch mode</a>. By adding modules to <code>watchPlugins</code> in your configuration you can extend the features of the watch mode.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="babel-7-support">Babel 7 support<a href="#babel-7-support" class="hash-link" aria-label="Babel 7 support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Babel 7 support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest uses Babel under the hood to power code coverage and advanced mocking features. With Jest 22, it also supports the upcoming Babel 7. You'll find more in the documentation <a href="/jest/ja/docs/getting-started#using-babel">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="mock-function-improvements">Mock function improvements<a href="#mock-function-improvements" class="hash-link" aria-label="Mock function improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Mock function improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>There has been a couple of changes to mock functions in Jest 22, making them even easier to use. Firstly, we added a <a href="/jest/ja/docs/mock-function-api#mockfnmocknamevalue"><code>mockName</code></a> property allowing you to name your mocks, which is useful in assertion failures. We have also made the Jest mock function serializable in <code>pretty-format</code>, meaning that you can snapshot test mocks. In Jest 21, <code>expect(jest.fn()).toMatchSnapshot()</code> would serialize to <code>[Function]</code>, in Jest 22, you might get something like this:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#6b2e85">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'my mocking test'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> mock </span><span class="token operator" style="color:#888">=</span><span class="token plain"> jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">fn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">mockName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'myMock'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">mock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'hello'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#82772c">foo</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token string" style="color:#c21325">'bar'</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toMatchSnapshot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Serializes to:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">[</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325">my mocking test 1</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325"></span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">[MockFunction myMock] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  "calls": Array [</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">    Array [</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">      "hello",</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">      Object {</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">        "foo": "bar",</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">    ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325"></span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="highlights-from-jest-21">Highlights from Jest 21<a href="#highlights-from-jest-21" class="hash-link" aria-label="Highlights from Jest 21 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Highlights from Jest 21 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest 21 was released back in September, and we unfortunately never got around to write a blog post. So here is a quick summary of the main changes in version 21:</p><ol><li><strong>Use expect and jest-mock in the browser:</strong> <a href="https://github.com/mjackson" target="_blank" rel="noopener noreferrer">Michael Jackson</a> donated his excellent <a href="https://github.com/mjackson/expect" target="_blank" rel="noopener noreferrer"><code>expect</code></a> package to the Jest project. As part of that transition, the Jest core team, with much help from <a href="https://github.com/skovhus/" target="_blank" rel="noopener noreferrer">Kenneth Skovhus</a>, made both <code>jest-matchers</code> (renamed to <code>expect</code>) and <code>jest-mock</code> work in browsers. This means that while you cannot use Jest itself in browsers (<a href="https://github.com/facebook/jest/issues/848" target="_blank" rel="noopener noreferrer">yet</a>), you can use its awesome assertions and mocks for instance as replacements for Chai and Sinon running in Mocha tests. If you are migrating from earlier <code>expect</code> to the new Jest-powered <code>expect</code>, you can use <a href="https://github.com/skovhus/jest-codemods/" target="_blank" rel="noopener noreferrer"><code>jest-codemods</code></a> to automate the migration.</li><li><strong>MIT License:</strong> We changed Jest's license to MIT. <em>Yay!</em></li><li><strong>Fail test suites on async errors:</strong> Jest used to have a bug that made it crash when errors were thrown in certain parts of async code. This was fixed by community contributors.</li><li><strong>Faster startup:</strong> With Jest 21 we fine tuned Jest's startup to be more than 50% faster. The large overhead of Jest when running it on a small and fast test was always an issue for us and now this shouldn't be a reason to hold you back from using Jest any longer.</li></ol><h2 class="anchor anchorWithStickyNavbar_JmGV" id="jest-community">Jest Community<a href="#jest-community" class="hash-link" aria-label="Jest Community „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Jest Community „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The community around Jest is working hard to make the testing experience even greater. These are separate projects from the main Jest project, but we want to highlight some of our personal favorites here.</p><ul><li><a href="https://github.com/americanexpress/jest-image-snapshot" target="_blank" rel="noopener noreferrer">jest-image-snapshot</a> ‚Äì custom matcher to compare images with snapshots by American Express developers</li><li><a href="https://github.com/kulshekhar/ts-jest" target="_blank" rel="noopener noreferrer">ts-jest</a> ‚Äì all you need to successfully run Jest within TypeScript project by <a href="https://github.com/kulshekhar/ts-jest" target="_blank" rel="noopener noreferrer">@kulshekhar</a></li><li><a href="https://github.com/skovhus/jest-codemods/" target="_blank" rel="noopener noreferrer">jest-codemods</a> ‚Äì migrate your tests from other frameworks to Jest with ease</li><li><a href="https://github.com/negativetwelve/jest-plugins" target="_blank" rel="noopener noreferrer">jest-plugins</a> ‚Äì a new community project oriented around simplifying setting up test environment for specific tools, like React, or providing some handy utilities</li></ul><p>We'd also like to announce that recently we launched a new place for high quality Jest additions ‚Äì <a href="https://github.com/jest-community" target="_blank" rel="noopener noreferrer">jest-community</a>. It's a new GitHub organization already featuring our favorite projects, like <a href="https://github.com/jest-community/vscode-jest" target="_blank" rel="noopener noreferrer">vscode-jest</a>, <a href="https://github.com/jest-community/jest-extended" target="_blank" rel="noopener noreferrer">jest-extended</a>, to name a few, curated by Jest maintainers and collaborators. We've even migrated our <a href="https://github.com/jest-community/eslint-plugin-jest" target="_blank" rel="noopener noreferrer">eslint-plugin-jest</a> there, and already see some great contributions, which are published independently at a faster pace.</p><p><img loading="lazy" alt="Jest Community" src="/jest/ja/assets/images/22-community-2b148613668cb789c0215015bfbc10c7.png" width="2004" height="1090" class="img_SS3x"></p><p>Community projects under one organisation are also a great way for us to experiment on things like automated releases, which we'd like to explore for Jest as well. They also enable us to share some common things between them, like the shape of the README for example (thanks to the webpack Community for the idea), making it easier to learn and use for all of us.</p><p>If you have something awesome to share, feel free to reach out to us! We'd love to share your project here.</p>]]></content>
        <author>
            <name>Simen Bekkhus</name>
            <uri>https://github.com/SimenB</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 20: üíñ Delightful Testing & üèÉüèΩ Multi-Project-Runner]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2017/05/06/jest-20-delightful-testing-multi-project-runner</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2017/05/06/jest-20-delightful-testing-multi-project-runner"/>
        <updated>2017-05-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[A few months ago we announced Jest 19 which came with major new features and was the biggest Jest release until today. Jest 20 has twice the amount of changes compared to the previous version, features a complete rewrite of the test runner, adds new testing APIs. The new release enables a new level of customization and configuration for projects all while making it effortless to upgrade. Beyond Painless JavaScript Testing, we believe Jest is now delivering a Delightful JavaScript Testing experience. Let's take a look at the best new features and changes in depth:]]></summary>
        <content type="html"><![CDATA[<p>A few months ago we announced <a href="/jest/ja/blog/2017/02/21/jest-19-immersive-watch-mode-test-platform-improvements">Jest 19</a> which came with major new features and was the biggest Jest release until today. Jest 20 has twice the amount of changes compared to the previous version, features a complete rewrite of the test runner, adds new testing APIs. The new release enables a new level of customization and configuration for projects all while making it effortless to upgrade. Beyond Painless JavaScript Testing, we believe Jest is now delivering a <strong>Delightful JavaScript Testing experience</strong>. Let's take a look at the best new features and changes in depth:</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="multi-project-runner--configuration-overhaul">Multi-Project-Runner &amp; Configuration Overhaul<a href="#multi-project-runner--configuration-overhaul" class="hash-link" aria-label="Multi-Project-Runner &amp; Configuration Overhaul „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Multi-Project-Runner &amp; Configuration Overhaul „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Until now, Jest could only operate in one project at a time. This is often cumbersome if you are working on many smaller projects that each have their own setup and configuration. With Jest 20, we rewrote the test runner completely to run many projects at the same time within a single instance of Jest, for example if you are working on a React frontend and a node.js backend. Here is a video of Jest running tests for <a href="https://github.com/facebook/react" target="_blank" rel="noopener noreferrer">React</a>, <a href="https://github.com/facebook/relay" target="_blank" rel="noopener noreferrer">Relay</a>, <a href="https://github.com/yarnpkg/yarn" target="_blank" rel="noopener noreferrer">Yarn</a> and Jest all at the same time:</p><p><img loading="lazy" alt="multi-runner" src="/jest/ja/assets/images/20-multi-runner-bca686433b2cb63c147951eedce67538.gif" width="839" height="520" class="img_SS3x"></p><p>Jest is now collapsing the usage guide after the first test run to save vertical space in the terminal.</p><p>Further, we completely overhauled how the configuration system works inside of Jest. You can now pass any configuration option through the CLI to overwrite the ones specified in your configuration file. Along with that, we changed Jest to look for a <code>jest.config.js</code> file by default which means you are now able to define a Jest configuration using JavaScript as well as being able to configure it through <code>package.json</code> like before. Through the addition of all these new features, you are now able to combine Jest in more powerful ways than ever before. For example, if you would like to find out which tests Jest would run given a set of changed files from a commit across multiple projects in a monorepo, you can combine cli arguments like this now:</p><div class="language-bash codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-bash codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">$ jest --projects projectA projectB --listTests --findRelatedTests projectA/banana.js projectB/kiwi.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#c21325">"projectA/banana.test.js"</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#c21325">"projectB/kiwi.test.js"</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#c21325">"projectB/pineapple.test.js"</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is especially useful for continuous integration (CI) systems where you may want to only run a subset of tests for Pull Requests to prevent Jest from running thousands of test files on every small change.</p><p>Finally, we are now properly mapping code coverage when using TypeScript and we are running code coverage for untested files in worker processes which yields significant speed ups for this feature.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new--improved-testing-apis">New &amp; Improved Testing APIs<a href="#new--improved-testing-apis" class="hash-link" aria-label="New &amp; Improved Testing APIs „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New &amp; Improved Testing APIs „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We made a number of additions and improvements to the testing APIs which will help write more effective tests. We'd like to point out that all of these improvements were made entirely by community members!</p><ul><li><strong>Better async testing:</strong> Added new async/Promise support through resolves/rejects modifiers on expect: <code>expect(Promise(‚Ä¶)).resolves.toEqual(‚Ä¶)</code>. <a href="/jest/ja/docs/expect#resolves">See documentation</a>.</li><li><strong>Expect <code>n</code> assertions:</strong> Along with the existing <code>expect.assertions(n)</code>, the new <code>expect.hasAssertions()</code> can be used to ensure a test has at least one assertion.</li><li><strong>Lint Plugin:</strong> A <code>valid-expect</code> rule was added to <code>eslint-plugin-jest</code> to ensure that an assertion is called after invoking <code>expect</code>. This will prevent mistakes like a stray <code>expect(banana);</code> with a missing assertion call.</li><li><strong>Pretty-Format Plugins:</strong> A number of new pretty-format plugins were added to Jest. We now pretty-print <a href="https://github.com/facebook/immutable-js/" target="_blank" rel="noopener noreferrer">Immutable.js</a> data structures and HtmlElements in assertion failures and snapshots.</li><li><strong>Custom Environment:</strong> It is now possible to add a <code>@jest-environment node|jsdom</code> annotation to the doc-block comment of a test file to use a test environment different from the default for individual tests.</li></ul><p>Here is an example of all how all the new APIs together will make testing more delightful:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @jest-environment node</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'compares apples and bananas'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#297a29">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">hasAssertions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Ensure this test has at least one assertion.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#297a29">await</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Immutable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token known-class-name class-name">Map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#82772c">apples</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#82772c">bananas</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">resolves</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toEqual</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Immutable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token known-class-name class-name">Map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#82772c">apples</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#82772c">bananas</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">3</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'banana'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// valid-expect in eslint-plugin-jest will show an error.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example will print a test failure similar to this:</p><p><img loading="lazy" alt="testing-apis" src="/jest/ja/assets/images/20-testing-apis-d1ff5d93e72e0aedc768bd40bd179e96.png" width="2164" height="1638" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="breaking-changes">Breaking Changes<a href="#breaking-changes" class="hash-link" aria-label="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As with every major release, we are making a number of breaking changes to make larger changes in the future possible and to push the testing experience to a new level. This time, we tried our best to only break APIs that we don't expect to affect the majority of Jest's users:</p><ul><li><strong>Fork of Jasmine 2.5:</strong> We finally decided to fork Jasmine itself and take ownership over Jest's own test runner. This will allow us to improve all aspects of the unit testing experience in the future but for now we are focused on incremental rewrites and reducing the API surface. If you see a test breaking as a result of a Jasmine API that is now missing, there should be an equivalent feature on the <code>jest</code> or <code>expect</code> objects. As such, we have removed many Jasmine features that aren't generally used in most codebases.</li><li><strong>New Snapshots on CI:</strong> Snapshots must always be committed along with the test and the modules they are testing. We changed Jest to not save new snapshots automatically in Continuous Integration (CI) environments or when the <code>--ci</code> flag is specified. To overwrite this behavior, which is generally not recommended, the <code>--updateSnapshot</code> flag can be used.</li><li><strong>Babel-Polyfill:</strong> Jest used to load <code>babel-polyfill</code> automatically when using babel-jest which resulted in memory leaks inside of Jest. In most versions of node, it is not necessary to load <code>babel-polyfill</code> so we removed this auto-inclusion and instead changed Jest to only include <code>regenerator-runtime</code> by default, which is commonly used to support async/await in older versions of Node.js. If you need <code>babel-polyfill</code>, you can manually require it in your setup files.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-improvements">Other Improvements<a href="#other-improvements" class="hash-link" aria-label="Other Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li><strong>Documentation:</strong> Documentation is critical to share best practices and teach everyone how to write effective tests which will lead to better software. Over the last few weeks we have also expanded Jest's documentation to include a Snapshot Testing FAQ, a guide with information about how to use Jest with common JavaScript libraries as well as we documented the new features mentioned above.</li><li><strong>Translations:</strong> We are now asking for your help to <a href="https://crowdin.com/project/jest-v2" target="_blank" rel="noopener noreferrer">translate the Jest documentation</a> to make it easier for people to learn how to use Jest.</li><li><strong>Custom Reporters:</strong> Jest now supports custom test reporters through the <code>reporters</code> configuration option. You can finally customize the output of Jest as well as integrate it with other tools by generating reports in formats such as XML. <a href="/jest/ja/docs/configuration#reporters-array-modulename-modulename-options">See documentation</a>.</li><li><strong>Codebase Health:</strong> It was only possible iterate so quickly in Jest because we spent a significant amount of time on the health of the codebase. We were one of the early adopters of <a href="https://github.com/prettier/prettier" target="_blank" rel="noopener noreferrer">prettier</a>, we notably increased flow coverage, forked Jasmine to improve our test runner library and we rewrote and refactored significant portions of Jest itself to set up Jest for success in the future.</li><li><strong>Bugfixes:</strong> As always, we made plenty of bugfixes in Jest. The full changelog can be found in the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md#jest-2000" target="_blank" rel="noopener noreferrer">Jest repository</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="talks-about-jest">Talks about Jest<a href="#talks-about-jest" class="hash-link" aria-label="Talks about Jest „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Talks about Jest „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Recently the Jest core team and other contributors started to talk more about Jest and the experience of working on Jest at conferences:</p><ul><li>Rogelio Guzman did a talk about <a href="https://www.youtube.com/watch?time_continue=416&amp;v=HAuXJVI_bUs" target="_blank" rel="noopener noreferrer">Jest Snapshots and Beyond</a> at React Conf.</li><li>I spoke about <a href="https://developers.facebook.com/videos/f8-2017/building-high-quality-javascript-tools/" target="_blank" rel="noopener noreferrer">Building High-Quality JavaScript Tools</a> at Facebook's F8 conference.</li></ul><p><em>As always, this release couldn't have been possible without you, the JavaScript community. We are incredibly grateful that we get the opportunity to work on improving JavaScript testing together. If you'd like to contribute to Jest, please don't hesitate to reach out to us on <a href="https://github.com/facebook/jest" target="_blank" rel="noopener noreferrer">GitHub</a> or on <a href="https://discord.gg/j6FKKQQrW9" target="_blank" rel="noopener noreferrer">Discord</a>.</em></p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[üÉè Jest 19: Immersive Watch Mode & Test Platform Improvements]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2017/02/21/jest-19-immersive-watch-mode-test-platform-improvements</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2017/02/21/jest-19-immersive-watch-mode-test-platform-improvements"/>
        <updated>2017-02-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we are pleased to ship version 19 of the Jest testing platform. It's the biggest Jest release we have shipped so far and we are quite excited to show you what we've built over the last two months:]]></summary>
        <content type="html"><![CDATA[<p>Today we are pleased to ship version 19 of the Jest testing platform. It's the biggest Jest release we have shipped so far and we are quite excited to show you what we've built over the last two months:</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="immersive-watch-mode">Immersive Watch Mode<a href="#immersive-watch-mode" class="hash-link" aria-label="Immersive Watch Mode „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Immersive Watch Mode „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We <a href="https://github.com/facebook/jest/pull/2362" target="_blank" rel="noopener noreferrer">completely rewrote the watch mode</a> to make it instant and more extensible. As a result, the experience of using it really is immersive: tests re-run instantly after a file change and we made it easy to select the right tests.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="snapshot-updates">Snapshot Updates<a href="#snapshot-updates" class="hash-link" aria-label="Snapshot Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Snapshot Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We made a couple of changes to the snapshot format. We don't make changes like this often and only consider them if they actually improve how snapshots work. As well as introducing a snapshot version number we accumulated a number of changes we wanted to make to the format for a while:</p><ul><li>We dropped the ‚Äútest‚Äù prefix in snapshot names from top level <code>test</code> or <code>it</code> calls.</li><li>We improved the printing of React elements to cause less changes when the last prop in an element changes.</li><li>We improved the character escaping mechanism to be more bulletproof.</li></ul><p>Before:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">[</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325">test snap 1</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325"></span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">&lt;header&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  &lt;h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">    Jest \"19\"</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  &lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  &lt;Subtitle</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">    name="Painless JavaScript Testing" /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">&lt;/header&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325"></span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After (no ‚Äútest‚Äù prefix, better JSX rendering, version header):</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Jest Snapshot v1, https://goo.gl/fbAQLP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">[</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325">snap 1</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325"></span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">&lt;header&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  &lt;h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">    Jest "19"</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  &lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  &lt;Subtitle</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">    name="Painless JavaScript Testing"</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">&lt;/header&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325"></span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We decided it's a good time to introduce versioned snapshots to ensure all developers are using a compatible version of Jest. Here's how we warn you about the need to update your snapshot:</p><p><img loading="lazy" alt="snapshot-version" src="/jest/ja/assets/images/19-snapshot-version-457ba31d60bb428bee970eb1ed529408.png" width="1396" height="311" class="img_SS3x"></p><p>Please make sure you revert any local changes before updating to make the transition smooth and to ensure you aren't including any unwanted changes from failing tests in your new snapshots.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-printing-of-skipped-tests">Improved printing of skipped tests<a href="#improved-printing-of-skipped-tests" class="hash-link" aria-label="Improved printing of skipped tests „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Improved printing of skipped tests „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Skipped tests are now printed as a single line instead of showing every individual one when testing in verbose mode or a single suite. Hopefully it will let you focus on currently important tests. It also occupies far less space!</p><p><img loading="lazy" alt="skipped-tests" src="/jest/ja/assets/images/19-skipped-tests-a51df1988c39d164bc52200a71459ec6.png" width="616" height="341" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-cli-arguments">New CLI arguments<a href="#new-cli-arguments" class="hash-link" aria-label="New CLI arguments „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New CLI arguments „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest 19 ships with two new coverage-related arguments which you can run from CLI:</p><ul><li><code>--collectCoverageFrom</code></li><li><code>--coverageDirectory</code></li></ul><p>We now also error on invalid CLI arguments instead of ignoring them. But we've got your back with helpful error message like the one below, e.g. when you try running <code>jest --watc</code>:</p><p><img loading="lazy" alt="cli-error" src="/jest/ja/assets/images/19-cli-error-0a7455fcb6a1a01013633cc34575a1b8.png" width="738" height="214" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="expect-improvements"><code>expect</code> Improvements<a href="#expect-improvements" class="hash-link" aria-label="expect-improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="expect-improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li><a href="/jest/ja/docs/expect#expectaddsnapshotserializerserializer"><code>expect.addSnapshotSerializer</code></a></li><li><a href="/jest/ja/docs/expect#expectstringcontainingstring"><code>expect.stringContaining</code></a></li><li><a href="/jest/ja/docs/jest-object#jestspyonobject-methodname"><code>jest.spyOn</code></a></li></ul><p>We're close to almost full feature parity with the <code>expect</code> npm package. <a href="https://twitter.com/mjackson" target="_blank" rel="noopener noreferrer">Michael Jackson</a>, the author of the package, agreed to <a href="https://github.com/facebook/jest/issues/1679" target="_blank" rel="noopener noreferrer">donate</a> it to the Jest project, which means that <code>jest-matchers</code> will be renamed to <code>expect</code>. Since our version of <code>expect</code> is not intended to be fully compatible, <a href="https://twitter.com/Vjeux" target="_blank" rel="noopener noreferrer">Christopher Chedeau</a> is working on a codemod to make the transition painless. Christopher also worked on a number of improvements to <code>jest-matchers</code> which enables it to be used outside of Jest and even <a href="https://github.com/facebook/jest/pull/2795" target="_blank" rel="noopener noreferrer">works inside browsers</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="eslint-plugin-jest--our-very-own-eslint-plugin"><a href="https://github.com/facebook/jest/tree/main/packages/eslint-plugin-jest" target="_blank" rel="noopener noreferrer">eslint-plugin-jest</a> ‚Äì our very own ESLint plugin<a href="#eslint-plugin-jest--our-very-own-eslint-plugin" class="hash-link" aria-label="eslint-plugin-jest--our-very-own-eslint-plugin „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="eslint-plugin-jest--our-very-own-eslint-plugin „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Thanks to <a href="https://twitter.com/jonnykim" target="_blank" rel="noopener noreferrer">Jonathan Kim</a> Jest finally has its own official ESLint plugin. It exposes three rules:</p><ul><li><a href="https://github.com/facebook/jest/blob/main/packages/eslint-plugin-jest/docs/rules/no-disabled-tests.md" target="_blank" rel="noopener noreferrer">no-disabled-tests</a> - this rule prevents you from accidentally committing disabled tests.</li><li><a href="https://github.com/facebook/jest/blob/main/packages/eslint-plugin-jest/docs/rules/no-focused-tests.md" target="_blank" rel="noopener noreferrer">no-focused-tests</a> - this rule prevents you from committing focused tests which would disable all other tests in the same suite.</li><li><a href="https://github.com/facebook/jest/blob/main/packages/eslint-plugin-jest/docs/rules/no-identical-title.md" target="_blank" rel="noopener noreferrer">no-identical-title</a> - disallows identical titles in test names.</li></ul><p>You can install it using <code>npm install --save-dev eslint-plugin-jest</code> or <code>yarn add --dev eslint eslint-plugin-jest</code> and it can be enabled by adding <code>{"plugins": ["jest"]}</code> to your eslint configuration.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-public-package-jest-validate">New public package: <a href="https://github.com/facebook/jest/tree/main/packages/jest-validate" target="_blank" rel="noopener noreferrer">jest-validate</a><a href="#new-public-package-jest-validate" class="hash-link" aria-label="new-public-package-jest-validate „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="new-public-package-jest-validate „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>While we refactored the validation and normalization code for Jest's configuration, we were so happy with the new error messaging that we extracted it to its own module to share it with everyone. With Jest 19 we welcome <code>jest-validate</code> to our self-sustained packages family.</p><p><code>jest-validate</code> is a generic configuration validation tool that helps you with warnings, errors and deprecation messages in your JavaScript tool. It's also capable of showing users friendly examples of correct configuration and it comes with a simple but powerful API. We hope it'll make a good addition to your projects!</p><p><img loading="lazy" alt="validate" src="/jest/ja/assets/images/19-validate-68120eda9a55dbbb0325ea6deea0e973.png" width="1200" height="729" class="img_SS3x"></p><p>We're happy to announce that <code>jest-validate</code> is validating config options of <a href="https://github.com/jlongster/prettier" target="_blank" rel="noopener noreferrer">prettier</a> since <a href="https://github.com/jlongster/prettier/blob/main/CHANGELOG.md#0120" target="_blank" rel="noopener noreferrer">v0.12</a>. Feel free to add it to your project, try it, send us feedback and improve it by making pull requests on GitHub.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-asymmetric-matchers">Improved asymmetric matchers<a href="#improved-asymmetric-matchers" class="hash-link" aria-label="Improved asymmetric matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Improved asymmetric matchers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We moved the asymmetric matchers implementation from Jasmine into Jest, which enabled us to further improve the user experience around them. As a result, asymmetric matchers are now pretty-printed nicely, we added the new <a href="/jest/ja/docs/expect#expectstringcontainingstring"><code>expect.stringContaining()</code></a> matcher and we also paired them with <a href="/jest/ja/docs/expect#tomatchobjectobject"><code>expect.toMatchObject()</code></a> so you can use the best of both:</p><p><img loading="lazy" alt="asymmetric-matchers" src="/jest/ja/assets/images/19-asymmetric-matchers-a96ddf170a7a1cdf31a7ffe36374d172.png" width="586" height="222" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="better-manual-mocks">Better manual mocks<a href="#better-manual-mocks" class="hash-link" aria-label="Better manual mocks „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Better manual mocks „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>With the latest release, manual mocks now finally work with nested folders. For example <code>__mocks__/react-native/Libraries/Text/Text.js</code> will now work as expected and mock the correct module. We also fixed issues with virtual mocks and transitive dependencies and improved <code>moduleNameMapper</code> to not overwrite mocks when many patterns map to the same file.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="breaking-changes">Breaking Changes<a href="#breaking-changes" class="hash-link" aria-label="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Breaking Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As a part of our cleanups and fixes we removed the <code>mocksPattern</code> configuration option which was never officially supported. We also renamed the <code>testPathDirs</code> configuration option to <code>roots</code> which better explains what the option can be used for. The default configuration for <code>roots</code> is <code>["&lt;rootDir&gt;"]</code> and can be customized to include any number of directories. The rootDir configuration option has always been used mostly as a token for other configuration options and this rename should make configuring Jest clearer.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="revamped-documentation">Revamped documentation<a href="#revamped-documentation" class="hash-link" aria-label="Revamped documentation „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Revamped documentation „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As you may have already seen, <a href="https://twitter.com/hectorramos" target="_blank" rel="noopener noreferrer">Hector Ramos</a> and <a href="https://twitter.com/lacker" target="_blank" rel="noopener noreferrer">Kevin Lacker</a> gave Jest's documentation a fresh new look. We changed the way we organize the website and it now features Docs and API as separate pages:</p><ul><li>Under <a href="/jest/ja/docs/getting-started#content">Docs</a> you can find an introduction to Jest, including <a href="/jest/ja/docs/getting-started#content">Getting Started</a> or <a href="/jest/ja/docs/asynchronous#content">Testing Asynchronous Code</a> and handy guides like <a href="/jest/ja/docs/snapshot-testing#content">Snapshot Testing</a>, <a href="/jest/ja/docs/tutorial-react-native#content">Testing React Native App</a>, <a href="/jest/ja/docs/webpack#content">Using with webpack</a> or <a href="/jest/ja/docs/migration-guide#content">Migrating to Jest</a> and many more!</li><li>The <a href="/jest/ja/docs/api">API</a> section on the other hand lists all available methods exposed by Jest: the <code>expect</code> and <code>jest</code> objects, mock functions, globals, along with configuration options from <em>package.json</em> and from the CLI.</li></ul><p>The homepage was completely redesigned to be more descriptive of what Jest is about: ‚Äú<em>Zero configuration testing platform</em>‚Äù. We also made sure it reads better on mobile devices. And for those using RSS ‚Äì we finally provide a <a href="https://jestjs.io/blog/feed.xml" target="_blank" rel="noopener noreferrer">feed for our blog</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="community-updates">Community Updates<a href="#community-updates" class="hash-link" aria-label="Community Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Community Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li>We really loved this talk: ‚Äú<a href="https://www.youtube.com/watch?v=tvy0bSgwtTo" target="_blank" rel="noopener noreferrer">Introduction to Jest</a>‚Äú by Vas Boroviak.</li><li>Follow <a href="http://twitter.com/fbjest" target="_blank" rel="noopener noreferrer">@fbjest on Twitter</a>.</li><li>The Jest Core team syncs once a week to discuss current and future issues. If you'd like to work on Jest, let us know, submit a few pull requests and join our weekly team meetings.</li><li>The awesome engineers at Artsy wrote <a href="http://artsy.github.io/blog/2017/02/05/Front-end-JavaScript-at-Artsy-2017/" target="_blank" rel="noopener noreferrer">about Jest as part of their 2017 frontend stack</a>.</li><li>Stephen Scott wrote a detailed article about <a href="https://medium.freecodecamp.com/the-right-way-to-test-react-components-548a4736ab22" target="_blank" rel="noopener noreferrer">testing React components</a> in which he weighs the pros and cons of different approaches.</li><li><a href="https://medium.com/@kentaromiura_the_js_guy/jest-for-all-episode-1-vue-js-d616bccbe186#.r8ryxlw98" target="_blank" rel="noopener noreferrer">Using Jest with vue.js</a> got a lot easier after reading Cristian Carlesso's blog post.</li><li><a href="https://twitter.com/cpojer/status/825004258219130880" target="_blank" rel="noopener noreferrer">Michele Bertoli wrote a book about React Design Patterns and Best Practices</a> which features an entire section about Jest.</li><li>Improved <code>--notify</code> command that shows an operating system notification which <a href="https://github.com/facebook/jest/pull/2727" target="_blank" rel="noopener noreferrer">can now also re-run tests from the notification</a>. This is actually a Jest feature and we are just checking if you are still reading this blog post.</li><li>Jest is now part of <a href="https://twitter.com/mxstbr/status/820326656439177217" target="_blank" rel="noopener noreferrer">react-boilerplate</a>.</li><li>Read about the <a href="https://medium.com/@boriscoder/the-hidden-power-of-jest-matchers-f3d86d8101b0#.pn10z1pzx" target="_blank" rel="noopener noreferrer">hidden powers of Jest's matchers</a>.</li></ul><p>Finally, we are happy to announce that the <a href="https://github.com/avajs/ava" target="_blank" rel="noopener noreferrer">ava</a> test runner has adopted parts of the Jest platform and is now shipping with basic <a href="https://github.com/avajs/ava#snapshot-testing" target="_blank" rel="noopener noreferrer">snapshot support</a> and is using <a href="https://github.com/facebook/jest/tree/main/packages/pretty-format" target="_blank" rel="noopener noreferrer">pretty-format</a>. Consolidating test infrastructure makes it easier to learn how to test applications and enables us to share best practices. We are looking forward to see what we can learn from existing test libraries in the future.</p><p>The full <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md#jest-1900" target="_blank" rel="noopener noreferrer">changelog can be found on GitHub</a>. Jest 19 was a true JavaScript community effort with <a href="https://github.com/facebook/jest/graphs/contributors?from=2016-12-23&amp;to=2017-02-21&amp;type=c" target="_blank" rel="noopener noreferrer">17 people who contributed</a> to this release. We thank each and every one of you for your help to make this project great.</p><p><em>This blog post was written by <a href="https://twitter.com/rogeliog" target="_blank" rel="noopener noreferrer">Rogelio Guzman</a> and <a href="https://twitter.com/thymikee" target="_blank" rel="noopener noreferrer">Micha≈Ç Pierzcha≈Ça</a>.</em></p>]]></content>
        <author>
            <name>Rogelio Guzman</name>
            <uri>http://twitter.com/rogeliog</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[A Great Developer Experience]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2017/01/30/a-great-developer-experience</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2017/01/30/a-great-developer-experience"/>
        <updated>2017-01-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We strongly believe that great documentation is crucial to providing a great developer experience. The docs should be clear, concise, and useful to new users and veterans alike. With that in mind, we recently took some time to overhaul the Jest website.]]></summary>
        <content type="html"><![CDATA[<p>We strongly believe that great documentation is crucial to providing a great developer experience. The docs should be clear, concise, and useful to new users and veterans alike. With that in mind, we recently took some time to overhaul the Jest website.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-docs">Improved docs<a href="#improved-docs" class="hash-link" aria-label="Improved docs „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Improved docs „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>One of the changes you'll notice upon visiting our docs is the updated sidebar. The documentation is now divided into three main areas: an introduction to Jest, detailed guides to Jest's features, and a comprehensive API reference.</p><p>The <strong>Introduction</strong> section will guide you from installing Jest and writing your first case, to using Jest's matchers and testing async code. If you're new to Jest or need a quick refresher, these docs should get you up to speed in no time. If you've used Jest before and only need a quick reference on how it's installed, you need to go no further than the <a href="/jest/ja/docs/getting-started">Getting Started</a> guide.</p><p>Once you feel comfortable using Jest, proceed to the advanced <strong>Guides</strong> section. The new <a href="/jest/ja/docs/snapshot-testing">Snapshot Testing guide</a> covers everything you need to know about creating and maintaining snapshot test cases.</p><p>Finally, we've completely overhauled our API reference docs. You can now find detailed information on all of Jest's <a href="/jest/ja/docs/api">Globals</a>, <a href="/jest/ja/docs/expect">matchers</a>, and <a href="/jest/ja/docs/cli">every flag</a> supported by the <code>jest</code> CLI.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-colors--website">New colors &amp; website<a href="#new-colors--website" class="hash-link" aria-label="New colors &amp; website „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New colors &amp; website „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The colors in the Jest logo and on the website have felt outdated to us for a while. We changed the color scheme we are using for Jest and changed the landing page significantly to be more inviting. We hope you like the new colors and showcase of Jest's strengths.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whos-using-jest">Who's using Jest?<a href="#whos-using-jest" class="hash-link" aria-label="Who's using Jest? „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Who's using Jest? „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We have created a <a href="/jest/ja/">showcase of users</a> to highlight some of the companies that are using Jest. We're thankful to all of these companies for using Jest to test their websites, mobile apps, and APIs. If you're using Jest, check out the guidelines on GitHub and send us a pull request!</p><div class="productShowcaseSection"><div class="logos"><img loading="lazy" src="img/logos/twitter.png" title="Twitter" class="img_SS3x"><img loading="lazy" src="img/logos/pinterest.png" title="Pinterest" class="img_SS3x"><img loading="lazy" src="img/logos/paypal.png" title="PayPal" class="img_SS3x"><img loading="lazy" src="img/logos/ibm.png" title="IBM" class="img_SS3x"><img loading="lazy" src="img/logos/spotify.png" title="Spotify" class="img_SS3x"></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="jest-in-the-browser">Jest in the browser<a href="#jest-in-the-browser" class="hash-link" aria-label="Jest in the browser „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Jest in the browser „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As highlighted <a href="/jest/ja/blog/2016/12/15/2016-in-jest">last month</a>, it is now possible to use Jest directly in the browser using <a href="https://repl.it/languages/jest" target="_blank" rel="noopener noreferrer">repl.it</a>. If you want to try out Jest before installing it, you can easily do so below or directly from the Jest homepage. Go ahead and give it a try!</p><div class="jest-repl"><iframe src="https://repl.it/@amasad/try-jest?lite=true"></iframe></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="get-involved">Get involved<a href="#get-involved" class="hash-link" aria-label="Get involved „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Get involved „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>This is just the start. Go ahead and take a look at the docs, and don't hesitate to send any feedback our way. If you find a mistake in the docs or you just want to let us know what needs to be documented better, please tweet at us at <a href="https://twitter.com/fbjest" target="_blank" rel="noopener noreferrer">@fbjest</a>, <a href="https://github.com/facebook/jest/issues" target="_blank" rel="noopener noreferrer">open an issue on GitHub</a>, or send us a PR by clicking "Edit on GitHub" at the top of the doc.</p><p>We're really excited for the year ahead and can't wait to hear from you!</p>]]></content>
        <author>
            <name>H√©ctor Ramos</name>
            <uri>http://twitter.com/hectorramos</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[2016 in Jest]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/12/15/2016-in-jest</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/12/15/2016-in-jest"/>
        <updated>2016-12-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[2016 was a big year for JavaScript testing with Jest. In the first six months of the year we rewrote Jest and built a solid foundation to significantly improve performance and the developer experience of testing JavaScript code. We flow-typed the entire codebase, built a ton of integration tests for Jest itself and adopted lerna to turn Jest from a framework into a Painless JavaScript Testing platform.]]></summary>
        <content type="html"><![CDATA[<p>2016 was a big year for JavaScript testing with Jest. In the first six months of the year we rewrote Jest and built a solid foundation to significantly improve performance and the developer experience of testing JavaScript code. We flow-typed the entire codebase, built a ton of integration tests for Jest itself and adopted <a href="https://lernajs.io/" target="_blank" rel="noopener noreferrer">lerna</a> to turn Jest from a framework into a <a href="https://github.com/facebook/jest/tree/main/packages" target="_blank" rel="noopener noreferrer"><em>Painless JavaScript Testing platform</em></a>.</p><p>The newly created <a href="https://yarnpkg.com/en/package/react-test-renderer" target="_blank" rel="noopener noreferrer">react-test-renderer</a> finally enabled testing of react-native components. Through the jest-react-native preset (now merged directly into react-native) Jest now works out of the box for any React project and comes pre-configured in <a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="noopener noreferrer">create-react-app</a> and <a href="https://github.com/facebook/react-native" target="_blank" rel="noopener noreferrer">react-native</a> projects. We integrated core pieces of Jest into <a href="https://github.com/facebook/react-native/tree/main/packager/react-packager/src" target="_blank" rel="noopener noreferrer">react-native's packager</a> and the completely new snapshot testing feature has since been used outside of Jest: It was integrated with React Storybook as ‚Äú<a href="https://github.com/storybooks/storyshots" target="_blank" rel="noopener noreferrer">storyshots</a>‚Äù and is being adopted by other test runners like <a href="https://github.com/avajs/ava/pull/1113" target="_blank" rel="noopener noreferrer">ava</a>.</p><p>The <a href="https://github.com/facebook/jest/tree/main/packages/pretty-format" target="_blank" rel="noopener noreferrer">pretty-format</a> project was rewritten with performance in mind to drive Jest's snapshot feature, was recently merged into Jest's monorepo and is also helpful in other <a href="https://github.com/avajs/ava/pull/1154" target="_blank" rel="noopener noreferrer">test runners</a>. Nowadays Jest is much more about collecting different ideas and solutions to testing than it is about one specific implementation of a test framework.</p><p>I'd like to deeply thank all the people that have <a href="https://github.com/facebook/jest/graphs/contributors?from=2016-01-01&amp;to=2016-12-14&amp;type=c" target="_blank" rel="noopener noreferrer">contributed to Jest this year</a>, both from the open source community and at Facebook: Dmitrii Abramov, Cristian Carlesso, Dan Abramov, Daniel Lo Nigro, Maxim Derbin, Evan Scott, Forbes Lindesay, Keyan Zhang and 60 more people. We'd also like to welcome <a href="https://twitter.com/thymikee" target="_blank" rel="noopener noreferrer">Micha≈Ç Pierzcha≈Ça (@thymikee)</a> as first official external contributor to Jest. He's been doing a great job managing the issues and PRs on the repo. If you'd like to start contributing to Jest, we have a bunch of <a href="https://github.com/facebook/jest/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+bug%22" target="_blank" rel="noopener noreferrer">good first tasks</a> and we are always happy to help on our <a href="https://discord.gg/j6FKKQQrW9" target="_blank" rel="noopener noreferrer">discord channel</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="replit-with-jest-integration"><a href="http://repl.it/" target="_blank" rel="noopener noreferrer">repl.it</a> with Jest integration<a href="#replit-with-jest-integration" class="hash-link" aria-label="replit-with-jest-integration „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="replit-with-jest-integration „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Amjad Massad <a href="https://repl.it/languages/jest" target="_blank" rel="noopener noreferrer">built a Jest container</a> so you can now try out Jest directly in the browser. You can use it from now on when creating GitHub issues which should help troubleshoot problems more quickly. Amjad and Haya are building <a href="http://repl.it/" target="_blank" rel="noopener noreferrer">repl.it</a> to democratize programming by building powerful yet simple tools and platforms for educators, learners, and developers. They are also <a href="https://repl.it/site/jobs" target="_blank" rel="noopener noreferrer">hiring talented engineers</a>!</p><div class="jest-repl"><iframe src="https://repl.it/languages/jest?lite=true"></iframe></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="community-update">Community Update<a href="#community-update" class="hash-link" aria-label="Community Update „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Community Update „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We feel incredibly humbled that 100+ companies <a href="https://twitter.com/cpojer/status/803965499407290369" target="_blank" rel="noopener noreferrer">have adopted Jest</a> in the last six months. Companies like Twitter, Pinterest, Paypal, nytimes, IBM (Watson), Spotify, eBay, SoundCloud, Intuit, FormidableLabs, Automattic, Trivago and Microsoft have either fully or partially switched to Jest for their JavaScript testing needs. Thank you very much for giving this project a chance. We would also like to thank everyone who went to conferences and meetups to speak about Jest and to everyone who is writing blog posts about how Jest is or isn't working for them!</p><p>Here is what happened in the community in the last two months:</p><ul><li>Jason Bonta and Dmitrii Abramov <a href="https://twitter.com/abramov_dmitrii/status/805913874704674816" target="_blank" rel="noopener noreferrer">redefined the ‚Äútesting pyramid‚Äù</a> we were talking a lot about at Facebook.</li><li><a href="https://github.com/skovhus/jest-codemods#jest-codemods" target="_blank" rel="noopener noreferrer">jest-codemods</a> now allows you to painlessly migrate from Mocha, Tape and Ava to Jest.</li><li>The React team announced <a href="https://facebook.github.io/react/blog/2016/11/16/react-v15.4.0.html" target="_blank" rel="noopener noreferrer">improvements to the react-test-renderer</a> in 15.4.0.</li><li>Orta Therox build an amazing <a href="https://github.com/orta/vscode-jest#the-aim" target="_blank" rel="noopener noreferrer">vscode-jest integration</a> and donated the code for editor support to Jest.</li><li>Pavithra Kodmad is documenting <a href="http://pksjce.github.io/2016/12/08/notes-on-jest" target="_blank" rel="noopener noreferrer">Flipkarts adoption of Jest</a> and shares some getting started tips.</li><li>Kent C. Dodds wrote about <a href="https://medium.com/@kentcdodds/migrating-to-jest-881f75366e7e#.ticf0wchu" target="_blank" rel="noopener noreferrer">migrating to Jest at Paypal</a> and Jason Brown <a href="http://browniefed.com/blog/migrating-ava-to-jest/" target="_blank" rel="noopener noreferrer">wrote about migrating to Jest as well</a>.</li><li>Ben McCormick wrote about <a href="http://benmccormick.org/2016/12/10/saving-time-with-jest/" target="_blank" rel="noopener noreferrer">saving time with Jest</a>.</li><li>Eric Clemmons wrote about <a href="https://medium.com/@ericclemmons/jest-snapshots-for-storybook-5bf36b5e5a3a" target="_blank" rel="noopener noreferrer">snapshots and storybook integration</a>.</li><li>Edvin Erikson wrote about <a href="https://medium.com/@edvinerikson/getting-jest-output-in-tap-format-6e07dc2c484c#.1l4edixhl" target="_blank" rel="noopener noreferrer">getting Tap output in Jest</a>.</li><li><a href="https://github.com/guigrpa/jest-html#jest-html--" target="_blank" rel="noopener noreferrer">jest-html</a> can bring snapshot diffing to your browser.</li><li>There were a few <a href="https://news.ycombinator.com/item?id=13128146" target="_blank" rel="noopener noreferrer">great conversations on hackernews</a> about Jest.</li><li>The community started a great discussion about the <a href="https://github.com/airbnb/enzyme/issues/715" target="_blank" rel="noopener noreferrer">future of enzyme</a>.</li><li>Ruben Oostinga wrote about <a href="https://medium.com/@RubenOostinga/combining-chai-and-jest-matchers-d12d1ffd0303#.87si0ra2h" target="_blank" rel="noopener noreferrer">combining chai and Jest matchers</a>.</li><li>Emil Ong wrote about why <a href="https://engineering.haus.com/why-tdding-your-frontend-feels-pointless-5f710fea7325#.pql79knnm" target="_blank" rel="noopener noreferrer">‚ÄúTDD'ing your frontend seems pointless‚Äù</a>.</li><li>Nate Hunzaker wrote about <a href="https://www.viget.com/articles/acceptance-testing-react-apps-with-jest-and-nightmare" target="_blank" rel="noopener noreferrer">end-to-end testing with Jest and Nightmare</a>.</li><li><a href="https://medium.com/aya-experience/testing-an-angularjs-app-with-jest-3029a613251#.h9badqevy" target="_blank" rel="noopener noreferrer">Using Jest with Angular just works</a> according to Matthieu Lux.</li><li>A fantastic conversation about the <a href="https://github.com/facebook/jest/issues/2197" target="_blank" rel="noopener noreferrer">purpose of snapshot testing</a> is happening right now.</li><li>Dmitrii made a new <a href="https://twitter.com/abramov_dmitrii/status/806613542447157248" target="_blank" rel="noopener noreferrer">music video with his metal band</a>.</li><li><a href="https://yarnpkg.com/en/package/lazyspec" target="_blank" rel="noopener noreferrer">lazyspec</a> can help you create smoke tests quickly if you are introducing tests to an existing codebase.</li><li>Patrick Stapfer did a lightning talk about <a href="https://twitter.com/ryyppy/status/803871975995277312" target="_blank" rel="noopener noreferrer">vim and Jest</a>.</li><li>Mark Dalgleish was <a href="https://twitter.com/markdalgleish/status/806608159527747584" target="_blank" rel="noopener noreferrer">commenting on the value of snapshot testing</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-features-changes-and-fixes-in-jest-17--18">New features, changes and fixes in Jest 17 &amp; 18<a href="#new-features-changes-and-fixes-in-jest-17--18" class="hash-link" aria-label="New features, changes and fixes in Jest 17 &amp; 18 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New features, changes and fixes in Jest 17 &amp; 18 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest was initially created more than five years ago and as such an old framework it has accumulated some technical debt. This is why we tend to make breaking changes more often than may seem necessary: We believe it is important to incrementally reduce technical debt to ensure that Jest as a project stays maintainable long-term. We didn't announce Jest 17 in a blog post and if you haven't upgraded to it in the last month you may find the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">changelog</a> useful.</p><ul><li><strong>Breaking:</strong> Removed <code>pit</code> in favor of <code>it</code> or <code>test</code> and <code>mockImpl</code> in favor of <code>jest.fn()</code> or <code>mockImplementation</code> .</li><li><strong>Breaking:</strong> Renamed <code>--jsonOutputFile</code> to <code>--outputFile</code>.</li><li><strong>Breaking:</strong> Updated <code>testRegex</code> to include <code>test.js</code> and <code>spec.js</code> files.</li><li><strong>Breaking:</strong> Replaced <code>scriptPreprocessor</code> with the new <code>transform</code> option.</li><li><strong>Breaking:</strong> The <code>testResultsProcessor</code> function is now required to return the modified results.</li><li><strong>Potentially Breaking:</strong> Properly resolve <code>snapshotSerializers</code>, <code>setupFiles</code>, <code>transform</code>, <code>testRunner</code> and <code>testResultsProcessor</code> with a resolution algorithm instead of using <code>path.resolve</code>. This mainly means that <code>&lt;rootDir&gt;</code> is no longer needed for these options.</li><li><strong>Added:</strong> <code>pretty-format</code> and <code>jest-editor-support</code> were merged into Jest.</li><li><strong>Added:</strong> <code>expect.any</code>, <code>expect.anything</code>, <code>expect.objectContaining</code>, <code>expect.arrayContaining</code>, <code>expect.stringMatching</code>.</li><li><strong>Added:</strong> <code>--testResultsProcessor</code> is now exposed through the cli.</li><li><strong>Added:</strong> Implemented file watching in <code>jest-haste-map</code>.</li><li><strong>Added:</strong> Usage of Jest in watch mode can be hidden through <code>JEST_HIDE_USAGE</code>.</li><li><strong>Added:</strong> <code>expect.assertions(number)</code> which will ensure that a specified amount of assertions is made in one test.</li><li><strong>Added:</strong> <code>.toMatchSnapshot(?string)</code> feature to give snapshots a name.</li><li><strong>Added:</strong> <code>toMatchObject</code>, <code>toHaveProperty</code> , <code>toHaveLength</code> matchers.</li><li><strong>Added:</strong> <code>expect.extend</code>.</li><li><strong>Added:</strong> Added support for custom snapshots serializers.</li><li><strong>Added:</strong> Big diffs are now collapsed by default in snapshots and assertions. Added <code>--expand</code> (or <code>-e</code>) to show the full diff.</li><li><strong>Added:</strong> <code>jest.resetAllMocks</code> which replaces <code>jest.clearAllMocks</code>.</li><li><strong>Added:</strong> <code>--json</code> now includes information about individual tests inside a file.</li><li><strong>Fixed:</strong> <code>test.concurrent</code> unhandled promise rejections.</li><li><strong>Fixed:</strong> <code>babel-plugin-jest-hoist</code> when using <code>jest.mock</code> with three arguments.</li><li><strong>Fixed:</strong> The <code>JSON</code> global in <code>jest-environment-node</code> now comes from the vm context instead of the parent context.</li><li><strong>Fixed:</strong> Jest does not print stack traces from babel any longer.</li><li><strong>Fixed:</strong> Fake timers are reset when <code>FakeTimers.useTimers()</code> is called.</li><li><strong>Fixed:</strong> Regular expressions are properly escaped in snapshots.</li><li><strong>Fixed:</strong> Improved pretty printing of large objects.</li><li><strong>Fixed:</strong> <code>NaN% Failed</code> in the OS notification when using <code>--notify</code>.</li><li><strong>Fixed:</strong> The first test run without cached timings will now use separate processes instead of running in band.</li><li><strong>Fixed:</strong> <code>Map</code>/<code>Set</code> comparisons.</li><li><strong>Fixed:</strong> <code>test.concurrent</code> now works with <code>--testNamePattern</code>.</li><li><strong>Fixed:</strong> Improved <code>.toContain</code> matcher.</li><li><strong>Fixed:</strong> Properly resolve modules with platform extensions on react-native.</li><li><strong>Fixed:</strong> global built in objects in <code>jest-environment-node</code> now work properly.</li><li><strong>Fixed:</strong> Create mock objects in the vm context instead of the parent context.</li><li><strong>Fixed:</strong> <code>.babelrc</code> is now part of the transform cache key in <code>babel-jest</code>.</li><li><strong>Fixed:</strong> docblock parsing with haste modules.</li><li><strong>Fixed:</strong> Exit with the proper code when the coverage threshold is not reached.</li><li><strong>Fixed:</strong> Jest now clears the entire scrollback in watch mode.</li><li><strong>Deprecated:</strong> <code>jest-react-native</code> was deprecated and now forwards <code>react-native</code>.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="plans-for-jest-in-h1-2017">Plans for Jest in H1 2017<a href="#plans-for-jest-in-h1-2017" class="hash-link" aria-label="Plans for Jest in H1 2017 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Plans for Jest in H1 2017 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Six months ago <a href="/jest/ja/blog/2016/07/27/jest-14#what-s-next-for-jest">we shared our plans for Jest</a> and we are happy that we were able to execute well on almost all of them. For the next six months, here is what we are planning:</p><ul><li><strong>Instant feedback:</strong> <a href="https://nuclide.io/" target="_blank" rel="noopener noreferrer">Nuclide</a> integration and an improved and <a href="https://github.com/facebook/jest/pull/2324#issuecomment-267149669" target="_blank" rel="noopener noreferrer">faster watch mode</a>.</li><li><strong>Improved developer experience:</strong> new mocking APIs and improved assertions.</li><li><strong>Better performance and memory usage:</strong> analyze Jest and be more conscious about efficiency.</li><li><strong>Snapshot Improvements:</strong> snapshot approval mode, syntax highlighting and improved <code>react-test-renderer</code> APIs.</li><li><strong>Website:</strong> We'll overhaul the website and documentation and add a Jest cheat sheet.</li></ul><p>We won't be providing timelines or estimates for these features and we may not actually get to all of these things. If you'd like to help make these things a reality, send us issues and pull requests with your ideas and let's work on improving Jest together in 2017.</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 16.0: Turbocharged CLI & Community Update]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/10/03/jest-16</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/10/03/jest-16"/>
        <updated>2016-10-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[It's been one month since the last major release and we've made significant improvements to Jest since. In this major release we are updating the snapshot format we are using which will likely require snapshots to be updated when upgrading Jest. We don't make these changes lightly and don't expect this to happen often but we think it is necessary to improve the format from time to time.]]></summary>
        <content type="html"><![CDATA[<p>It's been one month since the last major release and we've made significant improvements to Jest since. In this major release we are updating the snapshot format we are using which will likely require snapshots to be updated when upgrading Jest. We don't make these changes lightly and don't expect this to happen often but we think it is necessary to improve the format from time to time.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="upgraded-cli">Upgraded CLI<a href="#upgraded-cli" class="hash-link" aria-label="Upgraded CLI „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Upgraded CLI „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p><img loading="lazy" alt="reporter" src="/jest/ja/assets/images/16-reporter-578f46980efc5766386bed963d75e333.gif" width="858" height="575" class="img_SS3x"></p><p>Jest 16 features a new reporter interface that shows running tests as well as a live summary and a progress bar based on the estimated test runtime from previous test runs. We also improved the CLI output to work better with different color schemes. If there were test failures in a previous run, Jest will now always run those tests first to give useful signal to users as quickly as possible.</p><p>We also added a lot of new features which you may find useful:</p><ul><li>New CLI flags were added: A <code>--testNamePattern=pattern</code> or <code>-t &lt;pattern&gt;</code> option was added to filter tests from the command line much like <code>it.only</code> or <code>fit</code> does in tests.</li><li>Previously failed tests now always run first.</li><li><code>jest &lt;pattern&gt;</code> is now case-insensitive to make it easier to filter test files.</li><li>A test run in watch mode can now be interrupted. During a test run, simply press any of the keys used for input during watch mode (<code>a</code>, <code>o</code>, <code>p</code>, <code>q</code> or <code>enter</code>) to abort a test run and start a new one.</li><li>The <code>--bail</code> flag now also works in watch mode. Together with running failed tests first, Jest's watch mode will now feel turbocharged!</li><li>Jest now automatically considers files and tests with the <code>jsx</code> extension.</li><li>Jest warns about duplicate manual mock files and we improved automatically created mocks for ES modules compiled with babel.</li><li>A <code>jest.clearAllMocks</code> function was added to clear all mocks in between tests.</li><li>We improved module resolution when <code>moduleNameMapper</code> is used.</li><li>Finally, a <code>--findRelatedTests &lt;fileA&gt; &lt;fileB&gt;</code> cli option was added to run tests related to the specified files. This is especially helpful as a pre-commit hook if you'd like to run tests only on a specified set of files that have tests associated with them.</li></ul><p>This is what Jest looks like when a test run is interrupted in watch mode: <img loading="lazy" alt="watch" src="/jest/ja/assets/images/16-watch-db5e0e957c19a9b2499e018c81762993.gif" width="858" height="575" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="snapshot-updates">Snapshot Updates<a href="#snapshot-updates" class="hash-link" aria-label="Snapshot Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Snapshot Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest's snapshot implementation was completely rewritten. The new version of the <code>jest-snapshot</code> package is now structured in a way that allows for easier integration into other test runners and enables more cool integrations like with <a href="https://voice.kadira.io/snapshot-testing-in-react-storybook-43b3b71cec4f#.qh4lzcadb" target="_blank" rel="noopener noreferrer">React Storybook</a>. Jest doesn't mark snapshots as obsolete in a file with skipped or failing tests. We also made a number of changes to the snapshot format:</p><ul><li>Objects and Arrays are now printed with a trailing comma to minimize future changes to snapshots.</li><li>We removed function names from snapshots. They were causing issues with different versions of Node, with code coverage instrumentation and we generally felt like it wasn't useful signal to show to the user that the name of a function has changed.</li><li>Snapshots are now sorted using natural sort order within a file.</li></ul><p>When upgrading to Jest 16, the diff might look similar to this one: <img loading="lazy" alt="snapshots" src="/jest/ja/assets/images/16-snapshots-3d7a3fd47cdb15728ac038948a21d2b7.png" width="1924" height="1360" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="test-library-updates">Test Library Updates<a href="#test-library-updates" class="hash-link" aria-label="Test Library Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Test Library Updates „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We finished the migration of Jasmine assertions to the new Jest matchers. We added three new matchers: <code>toBeInstanceOf</code>, <code>toContainEqual</code> and <code>toThrowErrorMatchingSnapshot</code> . We have more readable failure messages for the spy/mock matchers <code>toHaveBeenLastCalledWith</code>, <code>toHaveBeenCalledWith</code>, <code>lastCalledWith</code> and <code>toBeCalledWith</code>. Now that we have rewritten all assertions and separated them into their own package, we'll be working on making them standalone so they can be integrated into any test framework if you'd like to use them outside of Jest.</p><p>We also added a bunch of aliases that were requested by the community. To make Jest focus on a single test you can now use either <code>it.only</code> or <code>test.only</code> or keep using <code>fit</code>; For skipping a test, <code>it.skip</code> or <code>test.skip</code> are now available alongside of <code>xit</code>; finally to define a test as concurrent you can use <code>test.concurrent</code> which is useful in case your test accesses network resources or databases.</p><p>Finally, if you'd like to overwrite the <code>expect</code> global with a different assertion library like <a href="http://chaijs.com/" target="_blank" rel="noopener noreferrer">chai</a>, this can now be done using the <code>setupTestFrameworkScriptFile</code> configuration option.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="community-update">Community Update<a href="#community-update" class="hash-link" aria-label="Community Update „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Community Update „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Over the last month lots of articles were written about Jest's snapshot testing feature, how to migrate to Jest and how to get started writing tests. I also did a few live videos to explain how Jest and snapshot testing works:</p><ul><li><a href="https://www.facebook.com/react/videos/1035427199869020/" target="_blank" rel="noopener noreferrer">FB Live Video about Snapshot Testing</a>.</li><li><a href="https://www.youtube.com/watch?v=i31VtyJSM-I&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer">JavaScript &amp; React Testing with Kent C. Dodds</a>.</li></ul><p>A number of people wrote articles about snapshot testing. The most opinionated article that resonated with the Jest team was ‚Äú<a href="http://benmccormick.org/2016/09/19/testing-with-jest-snapshots-first-impressions/" target="_blank" rel="noopener noreferrer">Testing with Jest Snapshots: First Impressions</a>‚Äù. Ben makes three great points in his blog post:</p><ol><li>Snapshot tests are a complement for conventional tests not a replacement.</li><li>Snapshot tests are more useful with a healthy code review process.</li><li>Snapshot tests work well with auto-mocking.</li></ol><p>We highly recommend reading the entire blog post. Ben did a fantastic job explaining the reasons why we built snapshot testing. It's important to point out that we didn't introduce snapshot testing to replace all other forms of testing but rather as a way to enable engineers to write tests for code that they otherwise wouldn't write tests for. It works well for things like React components, CLI output, error messages and many others but it doesn't solve all problems. Jest's goal is to provide many different ways to write effective tests without sacrificing performance or the project's maintainability.</p><p>Other highlights about snapshot testing:</p><ul><li>A React Native testing series: <a href="https://blog.callstack.io/unit-testing-react-native-with-the-new-jest-i-snapshots-come-into-play-68ba19b1b9fe" target="_blank" rel="noopener noreferrer">Part 1: Jest ‚Äì Snapshot come into play</a> and <a href="https://blog.callstack.io/unit-testing-react-native-with-the-new-jest-ii-redux-snapshots-for-your-actions-and-reducers-8559f6f8050b#.putt9eipm" target="_blank" rel="noopener noreferrer">Part 2: Jest ‚Äì Redux Snapshots for your Actions and Reducers</a>.</li><li><a href="https://blog.grommet.io/post/2016/09/01/how-we-landed-on-jest-snapshot-testing-for-javascript" target="_blank" rel="noopener noreferrer">How we landed on Jest snapshot testing for JavaScript</a>.</li><li><a href="http://guigrpa.github.io/2016/09/27/picture-this-snapshot-testing/" target="_blank" rel="noopener noreferrer">Picture This: Snapshot Testing</a>.</li><li><a href="https://voice.kadira.io/snapshot-testing-in-react-storybook-43b3b71cec4f" target="_blank" rel="noopener noreferrer">Snapshot testing with React Storybook</a>.</li><li><a href="https://medium.com/@ryancollinsio/testing-react-redux-applications-fee79ac0087f#.lyjl7st1n" target="_blank" rel="noopener noreferrer">Testing React and Redux Applications</a>.</li><li>If you are using the popular <a href="https://github.com/airbnb/enzyme" target="_blank" rel="noopener noreferrer">enzyme</a> testing utility, there is now a project <a href="https://github.com/trayio/enzyme-to-json" target="_blank" rel="noopener noreferrer">enzyme-to-json</a> which makes it possible to use Jest's snapshot testing feature together with enzyme.</li></ul><p><a href="https://github.com/reactjs/redux/commit/7296d3cba1f5f899bdee5ef6695a8d21149f8d6c" target="_blank" rel="noopener noreferrer">Redux itself now uses Jest</a> and Max Stoiber wrote a <a href="http://academy.plot.ly/react/6-testing/" target="_blank" rel="noopener noreferrer">tutorial on how to test code written with redux</a>. There is also a great <a href="https://semaphoreci.com/community/tutorials/how-to-test-react-and-mobx-with-jest" target="_blank" rel="noopener noreferrer">guide on how to write tests for MobX</a>. If you are using <a href="https://github.com/facebookincubator/create-react-app" target="_blank" rel="noopener noreferrer">create-react-app</a>, Jest is now included by default. Kent C. Dodds created a ton of <a href="https://egghead.io/lessons/javascript-use-jest-s-snapshot-testing-feature?pl=testing-javascript-with-jest-a36c4074" target="_blank" rel="noopener noreferrer">videos on egghead.io</a> that will help you get started with Jest.</p><p>If you are using other test runners, Kenneth Skovhus built an awesome <a href="https://github.com/skovhus/jest-codemods" target="_blank" rel="noopener noreferrer">jest-codemods</a> library that will automate the conversion for you. Codemods are awesome: they'll allow you to quickly evaluate whether Jest will work for you. Give it a try!</p><p>The full <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md#jest-1600" target="_blank" rel="noopener noreferrer">changelog can be found on GitHub</a>. Jest 16 was a true JavaScript community effort and the project now has more than 220 contributors. We thank each and every one of you for your help to make this project great.</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 15.0: New Defaults for Jest]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/09/01/jest-15</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/09/01/jest-15"/>
        <updated>2016-09-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We spent the past year making Jest faster, easier to configure, added tons of features and built snapshot testing. However, there were two areas where we invested very little we can move fast and improve the framework for Facebook and the open source community at light-speed. Jest's goal is to come with batteries included and to require as little configuration as necessary. We recently got a chance to explain our philosophy on a create-react-app issue.]]></summary>
        <content type="html"><![CDATA[<p>We spent the past year making Jest <a href="/jest/ja/blog/2016/03/11/javascript-unit-testing-performance">faster</a>, <a href="/jest/ja/blog/2016/04/12/jest-11">easier to configure</a>, <a href="/jest/ja/blog/2016/06/22/jest-13">added tons of features</a> and built <a href="/jest/ja/blog/2016/07/27/jest-14">snapshot testing</a>. However, there were two areas where we invested very little: the CLI output and user experience. With Jest 15 we are changing the framework radically to make it easier to use both for beginners and experienced users. We are excited that our investment in Jest is now paying off: we can move fast and improve the framework for Facebook and the open source community at light-speed. Jest's goal is to come with batteries included and to require as little configuration as necessary. We recently got a chance to explain our philosophy on a <a href="https://github.com/facebookincubator/create-react-app/pull/250#issuecomment-237098619" target="_blank" rel="noopener noreferrer">create-react-app issue</a>.</p><p>The most important change to talk about is a set of <a href="https://github.com/facebook/jest/pull/1511" target="_blank" rel="noopener noreferrer">new defaults</a>. If you are an existing Jest user you will very likely need to update your configuration for Jest 15. In most cases it will simplify your setup and Jest will provide useful error messages during the upgrade. All of the new defaults can be disabled to suit your needs, but we still consider the disabled features critical for Jest in certain situations and will continue to use and support them at Facebook long-term. Our <a href="/jest/ja/docs/api">API documentation</a> was also completely rewritten to reflect these changes. <a href="https://github.com/facebook/react/pull/7625/files" target="_blank" rel="noopener noreferrer">This pull request for React</a> highlights some of the changes necessary for existing projects.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-cli-error-messages-and-summaries">New CLI error messages and summaries<a href="#new-cli-error-messages-and-summaries" class="hash-link" aria-label="New CLI error messages and summaries „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New CLI error messages and summaries „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>As part of our effort to remove Jasmine incrementally within Jest, replacing all Jasmine matchers was almost completed. A lot of time was spent tweaking every error message for every matcher to give the best signal to users when a test is failing ‚Äì the time when Jest should provide the most value to you. In addition to printing the expected and received values, a diff is printed for the <code>toBe</code> and <code>toEqual</code> matchers to help spot mistakes. More colors were added and relevant files from stack traces are highlighted more prominently.</p><p>Here is a comparison of the before and after on a light terminal: <img loading="lazy" alt="failure1" src="/jest/ja/assets/images/15-failure1-18a216b24eb5641ffe2f700795be8738.png" width="2414" height="1422" class="img_SS3x"> It also works well with darker colors: <img loading="lazy" alt="failure2" src="/jest/ja/assets/images/15-failure2-0638fb4e0e8ef964763fab8c4bebd23c.png" width="2442" height="850" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-watch-command">New watch command<a href="#new-watch-command" class="hash-link" aria-label="New watch command „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New watch command „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>We completely rewrote <code>jest --watch</code> to be more interactive. It can now switch between running all tests or only test files related to changed files by pressing <code>a</code> or <code>o</code>. By pressing <code>p</code> a prompt appears that allows to specify a test pattern to focus on a specific set of files. Snapshot tests can be updated by pressing <code>u</code>.</p><p><img loading="lazy" alt="watch" src="/jest/ja/assets/images/15-watch-951ac33b263d3ee8522e35b8836b1f88.gif" width="858" height="575" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="jest-react-native-improvements">jest-react-native improvements<a href="#jest-react-native-improvements" class="hash-link" aria-label="jest-react-native improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="jest-react-native improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Mocks for <code>ListView</code>, <code>TextInput</code>, <code>ActivityIndicator</code>, <code>ScrollView</code> and more were added. The existing mocks were updated to use the real implementations and existing snapshots likely have to be updated when upgrading to Jest 15. A <code>mockComponent</code> function was added to <code>jest-react-native</code> that can be used to mock native components:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">mock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'MyNativeComponent'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> jestReactNative </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'jest-react-native'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#297a29">return</span><span class="token plain"> jestReactNative</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">mockComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'MyNativeComponent'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There have also been a number of improvements around mocking images, the fetch module and other native APIs.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="buffered-console-messages">Buffered Console Messages<a href="#buffered-console-messages" class="hash-link" aria-label="Buffered Console Messages „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Buffered Console Messages „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest parallelizes test runs across workers to maximize performance. Previously Jest used to forward console messages from workers to the parent and printed them immediately. When running multiple tests in parallel, it was often hard to find out which test and which module was calling a log function. In Jest 15, all console messages are buffered and printed together with individual test results. In addition the file and line number of the log call is printed so the code can easily be inspected.</p><p>Compare the output of the previous version of Jest and Jest 15: <img loading="lazy" alt="console" src="/jest/ja/assets/images/15-console-5050b2c2d39cedc5bff49baa56bb78a3.png" width="2358" height="1162" class="img_SS3x"></p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="disabled-automocking">Disabled Automocking<a href="#disabled-automocking" class="hash-link" aria-label="Disabled Automocking „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Disabled Automocking „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Automocking is now disabled by default in Jest. This is by far the most confusing feature for new users and in many ways it doesn't make sense for small projects. We introduced automocking at Facebook and it worked great for us when unit testing was adopted in a large existing code base with few existing tests, but over time it felt like people spent more time fighting with mocked/unmocked modules than it would have taken them to write a test normally. We also noticed that library authors often require a huge number of basic modules that always have to be manually unmocked. Even for Jest itself we realized that the majority of tests had automocking disabled manually. We still believe that explicit automocking can be incredibly valuable. This change simply trades implicit mocks for explicit mocks via calls to <code>jest.mock(moduleName)</code>.</p><p>If you would still like to use automocking by default, enable the <code>automock</code> setting in your configuration or manually call <code>jest.enableAutomock()</code> in your test or setup file.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="test-file-patterns">Test File Patterns<a href="#test-file-patterns" class="hash-link" aria-label="Test File Patterns „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Test File Patterns „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Not everyone uses the same convention of using a <code>__tests__</code> folder to store tests. Jest 15 also looks for files ending in <code>.spec.js</code> or <code>.test.js</code>, two popular community standards. Jest 15 also removes the <code>testDirectoryName</code> and <code>testFileExtensions</code> configuration options and asks users to switch to the <code>testRegex</code> option when the old configuration options are used.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="module-registry-persistence">Module Registry Persistence<a href="#module-registry-persistence" class="hash-link" aria-label="Module Registry Persistence „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Module Registry Persistence „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Jest used to implicitly reset all modules before each test and we recommended requiring modules in <code>beforeEach</code> or inside of tests. This is useful when modules have local state that shouldn't be shared between tests. However, two big shifts happened: ES modules with the top-level <code>import</code> syntax and a renewed interest in writing stateless functional modules.</p><p>This has lead to numerous incompatibilities. We also noticed that at Facebook we weren't even using this implicit reset. Instead we relied on explicit calls to <code>jest.resetModules()</code> which puts engineers in control on when to wipe away all state.</p><p>Here is an example:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> </span><span class="token maybe-class-name">React1</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'react'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">resetModules</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> </span><span class="token maybe-class-name">React2</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'react'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">React1</span><span class="token plain"> </span><span class="token operator" style="color:#888">!==</span><span class="token plain"> </span><span class="token maybe-class-name">React2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// These two are separate copies of React.</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The call to <code>resetModules</code> wipes away the require cache. A second call to require the same module will result in a new instantiation of the same module and all of its dependencies. This feature is especially useful when dealing with modules that have side effects, like <a href="https://github.com/facebook/jest/blob/3bbf32a239fc4aad8cc6928a787f235bd86fecac/packages/jest-haste-map/src/__tests__/index-test.js#L64" target="_blank" rel="noopener noreferrer">jest-haste-map</a>.</p><p>We believe it is better to put users in control so we disabled the implicit reset. Modules can be reset using <code>jest.resetModules()</code> in code and the <code>resetModules</code> option can be enabled in the configuration to bring back the previous behavior.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="real-vs-fake-timers">Real vs Fake Timers<a href="#real-vs-fake-timers" class="hash-link" aria-label="Real vs Fake Timers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Real vs Fake Timers „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>By default Jest used to mock all timer functions like <code>setTimeout</code> or <code>process.nextTick</code> and provided an API <code>jest.runAllTimers()</code> to advance timers programatically. This is useful when a piece of code sets a long timeout that we don't want to wait for in a test.</p><p>However we found that most of the time the use cases are quite isolated. <a href="/jest/ja/docs/tutorial-async">Async programming</a> has also become much simpler in our test runner. Jest now uses the real timers by default.</p><p>You can still override this by specifying <code>"timers": "fake"</code> in the configuration or by calling <code>jest.useRealTimers()</code> and <code>jest.useFakeTimers()</code> global switches.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="setupenvscriptfile-vs-setupfiles">setupEnvScriptFile vs setupFiles<a href="#setupenvscriptfile-vs-setupfiles" class="hash-link" aria-label="setupEnvScriptFile vs setupFiles „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="setupEnvScriptFile vs setupFiles „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The <code>setupEnvScriptFile</code> configuration option has been deprecated for a while. Jest 15 removes it completely and replaces it with <code>setupFiles</code>. This option expects an array of file paths that are loaded in order before a test file is executed.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="rewritten-code-coverage-support">Rewritten Code Coverage Support<a href="#rewritten-code-coverage-support" class="hash-link" aria-label="Rewritten Code Coverage Support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Rewritten Code Coverage Support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Code coverage in Jest can be used through <code>jest --coverage</code> and requires no additional packages or configuration. Code coverage support was completely rewritten and a new <code>collectCoverageFrom</code> option was added to collect code coverage information from entire projects, including <strong>untested files</strong>. Note that this option uses globs as we are hoping to further simplify configuration options in the future and provide a simpler alternative to regular expressions. See Jest's <a href="https://github.com/facebook/jest/blob/9088f6517813f6c089cf52e980d6579511dcde88/package.json#L47" target="_blank" rel="noopener noreferrer">package.json</a> for an example.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-improvements">Other Improvements<a href="#other-improvements" class="hash-link" aria-label="Other Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>A huge number of other improvements were also made:</p><ul><li>Improved performance of small test runs.</li><li>Jest now uses verbose mode when only a single test file is executed.</li><li>Added an <code>--env</code> option to override the configured test environment.</li><li><code>moduleNameMapper</code> now uses a resolution algorithm.</li><li>Jest now works with paths that have special characters in them, like parenthesis.</li><li>Added <code>global.global</code> to the node environment.</li><li>Fixed <code>babel-plugin-jest-hoist</code>'s invalid error when a random user function was called <code>mock</code>.</li><li>Fix <code>testEnvironment</code> resolution to prefer <code>jest-environment-{name}</code> instead of <code>{name}</code> only. This prevents a module collision when using <code>jsdom</code> as test environment.</li><li>Improvements to Jest's own test infra by merging integration and unit tests. Code coverage is now collected for Jest.</li></ul><p>We are happy when looking back at all the changes we have made together with the help from the community and couldn't be more excited to make Jest even better over the course of the next few months. Please <a href="https://github.com/facebook/jest/issues" target="_blank" rel="noopener noreferrer">file an issue</a> if something isn't working as expected and send us pull requests.</p><p>Next up: <a href="https://github.com/facebook/jest/pull/1480" target="_blank" rel="noopener noreferrer">Concurrent Reporter</a>.</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 14.0: React Tree Snapshot Testing]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/07/27/jest-14</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/07/27/jest-14"/>
        <updated>2016-07-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[One of Jest's philosophies is to provide an integrated ‚Äúzero-configuration‚Äù experience. We want to make it as frictionless as possible to write good tests that are useful. We observed that when engineers are provided with ready-to-use tools, they end up writing more tests, which in turn results in stable and healthy code bases.]]></summary>
        <content type="html"><![CDATA[<p>One of Jest's philosophies is to provide an integrated ‚Äúzero-configuration‚Äù experience. We want to make it as frictionless as possible to write good tests that are useful. We observed that when engineers are provided with ready-to-use tools, they end up writing more tests, which in turn results in stable and healthy code bases.</p><p>One of the big open questions was how to write React tests efficiently. There are plenty of tools such as <a href="https://facebook.github.io/react/docs/test-utils.html" target="_blank" rel="noopener noreferrer">ReactTestUtils</a> and <a href="https://enzymejs.github.io/enzyme/" target="_blank" rel="noopener noreferrer">enzyme</a>. Both of these tools are great and are actively being used. However engineers frequently told us that they spend more time writing a test than the component itself. As a result many people stopped writing tests altogether which eventually led to instabilities. Engineers told us all they wanted was to make sure their components don't change unexpectedly.</p><p>Together with the React team we created a new test renderer for React and added snapshot testing to Jest. Consider this <a href="https://github.com/facebook/jest/blob/main/examples/snapshot/__tests__/link.test.js" target="_blank" rel="noopener noreferrer">example test</a> for a simple <a href="https://github.com/facebook/jest/blob/main/examples/snapshot/Link.js" target="_blank" rel="noopener noreferrer">Link component</a>:</p><div class="language-javascript codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-javascript codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#297a29">import</span><span class="token plain"> </span><span class="token imports">renderer</span><span class="token plain"> </span><span class="token keyword module" style="color:#297a29">from</span><span class="token plain"> </span><span class="token string" style="color:#c21325">'react-test-renderer'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'Link renders correctly'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> tree </span><span class="token operator" style="color:#888">=</span><span class="token plain"> renderer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#888">&lt;</span><span class="token maybe-class-name">Link</span><span class="token plain"> page</span><span class="token operator" style="color:#888">=</span><span class="token string" style="color:#c21325">"http://www.facebook.com"</span><span class="token operator" style="color:#888">&gt;</span><span class="token maybe-class-name">Facebook</span><span class="token operator" style="color:#888">&lt;</span><span class="token operator" style="color:#888">/</span><span class="token maybe-class-name">Link</span><span class="token operator" style="color:#888">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toJSON</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tree</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toMatchSnapshot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first time this test is run, Jest creates a <a href="https://github.com/facebook/jest/blob/main/examples/snapshot/__tests__/__snapshots__/link.test.js.snap" target="_blank" rel="noopener noreferrer">snapshot file</a> that looks like this:</p><div class="language-javascript codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-javascript codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">[</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325">Link renders correctly 1</span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token template-string string" style="color:#c21325"></span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">&lt;a</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  className="normal"</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  href="http://www.facebook.com"</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  onMouseEnter={[Function bound _onMouseEnter]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  onMouseLeave={[Function bound _onMouseLeave]}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">  Facebook</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325">&lt;/a&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#c21325"></span><span class="token template-string template-punctuation string" style="color:#c21325">`</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The snapshot artifact should be committed alongside code changes. We use <a href="https://github.com/thejameskyle/pretty-format" target="_blank" rel="noopener noreferrer">pretty-format</a> to make snapshots human-readable during code review. On subsequent test runs Jest will simply compare the rendered output with the previous snapshot. If they match, the test will pass. If they don't match, either the implementation has changed and the snapshot needs to be updated with <code>jest -u</code>, or the test runner found a bug in your code that should be fixed.</p><p>If we change the address the Link component in our example is pointing to, Jest will print this output:</p><p><img loading="lazy" alt="snapshot-testing" src="/jest/ja/assets/images/snapshot-8de6b9bafc9754f21e3c61604fc0623c.png" width="1450" height="546" class="img_SS3x"></p><p>Now you know that you either need to accept the changes with <code>jest -u</code>, or fix the component if the changes were unintentional. To try out this functionality, please clone the <a href="https://github.com/facebook/jest/tree/main/examples/snapshot" target="_blank" rel="noopener noreferrer">snapshot example</a>, modify the Link component and run Jest. We updated the <a href="/jest/ja/docs/tutorial-react">React Tutorial</a> with a new guide for snapshot testing.</p><p>This feature was built by <a href="https://twitter.com/soprano" target="_blank" rel="noopener noreferrer">Ben Alpert</a> and <a href="https://twitter.com/kentaromiura" target="_blank" rel="noopener noreferrer">Cristian Carlesso</a>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="experimental-react-native-support">Experimental React Native support<a href="#experimental-react-native-support" class="hash-link" aria-label="Experimental React Native support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Experimental React Native support „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>By building a test renderer that targets no specific platform we are finally able to support a full, unmocked version of React Native. We are excited to launch experimental React Native support for Jest through the <code>jest-react-native</code> package.</p><p>You can start using Jest with react-native by running <code>yarn add --dev jest-react-native</code> and by adding the preset to your Jest configuration:</p><div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#82772c">"jest"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#82772c">"preset"</span><span class="token operator" style="color:#888">:</span><span class="token plain"> </span><span class="token string" style="color:#c21325">"jest-react-native"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><a href="/jest/ja/docs/tutorial-react-native#content">Tutorial and setup guide</a></li><li><a href="https://github.com/facebook/jest/tree/main/examples/react-native" target="_blank" rel="noopener noreferrer">Example project</a></li><li><a href="https://github.com/bartonhammond/snowflake/pull/110" target="_blank" rel="noopener noreferrer">Example pull request for <em>snowflake</em></a>, a popular react-native open source library.</li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_uH4V"><div class="admonitionHeading_P5_N"><span class="admonitionIcon_MF44"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>ÂÇôËÄÉ</div><div class="admonitionContent_yySL"><p>The preset currently only implements the minimal set of configuration necessary to get started with React Native testing. We are hoping for community contributions to improve this project. Please try it and file <a href="https://github.com/facebook/jest/issues" target="_blank" rel="noopener noreferrer">issues</a> or send pull requests!</p></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="why-snapshot-testing">Why snapshot testing?<a href="#why-snapshot-testing" class="hash-link" aria-label="Why snapshot testing? „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Why snapshot testing? „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>For Facebook's native apps we use a system called ‚Äúsnapshot testing‚Äù: a snapshot test system that renders UI components, takes a screenshot and subsequently compares a recorded screenshot with changes made by an engineer. If the screenshots don't match, there are two possibilities: either the change is unexpected or the screenshot can be updated to the new version of the UI component.</p><p>While this was the solution we wanted for the web, we also found many problems with such end-to-end tests that snapshot integration tests solve:</p><ul><li><strong>No flakiness:</strong> Because tests are run in a command line runner instead of a real browser or on a real phone, the test runner doesn't have to wait for builds, spawn browsers, load a page and drive the UI to get a component into the expected state which tends to be flaky and the test results become noisy.</li><li><strong>Fast iteration speed:</strong> Engineers want to get results in less than a second rather than waiting for minutes or even hours. If tests don't run quickly like in most end-to-end frameworks, engineers don't run them at all or don't bother writing them in the first place.</li><li><strong>Debugging:</strong> It's easy to step into the code of an integration test in JS instead of trying to recreate the screenshot test scenario and debugging what happened in the visual diff.</li></ul><p>Because we believe snapshot testing can be useful beyond Jest we split the feature into a <a href="https://github.com/facebook/jest/tree/main/packages/jest-snapshot" target="_blank" rel="noopener noreferrer">jest-snapshot</a> package. We are happy to work with the community to make it more generic so it can be integrated with other test runners and share concepts and infrastructure with each other.</p><p>Finally, here is a quote of a Facebook engineer describing how snapshot testing changed his unit testing experience:</p><blockquote><p>‚ÄúOne of the most challenging aspects of my project was keeping the input and output files for each test case in sync. Each little change in functionality could cause all the output files to change. With snapshot testing I do not need the output files, the snapshots are generated for free by Jest! I can simply inspect how Jest updates the snapshots rather than making the changes manually.‚Äù ‚Äì <a href="https://github.com/kyldvs" target="_blank" rel="noopener noreferrer">Kyle Davis</a> working on <a href="https://github.com/kyldvs/fjs" target="_blank" rel="noopener noreferrer">fjs</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next-for-jest">What's next for Jest<a href="#whats-next-for-jest" class="hash-link" aria-label="What's next for Jest „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="What's next for Jest „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Recently <a href="https://twitter.com/aarondjents" target="_blank" rel="noopener noreferrer">Aaron Abramov</a> has joined the Jest team full time to improve our unit and integration test infrastructure for Facebook's ads products. For the next few months the Jest team is planning major improvements in these areas:</p><ul><li><strong>Replace Jasmine:</strong> Jasmine is slowing us down and is not being very actively developed. We started replacing all the Jasmine matchers and are excited to add new features and drop this dependency.</li><li><strong>Code Coverage:</strong> When Jest was originally created, tools such as babel didn't exist. Our code coverage support has a bunch of edge cases and isn't always working properly. We are rewriting it to address all the current problems with coverage.</li><li><strong>Developer Experience:</strong> This ranges from improving the setup process, the debugging experience to CLI improvements and more documentation.</li><li><strong>Mocking:</strong> The mocking system, especially around manual mocks, is not working well and is confusing. We hope to make it more strict and easier to understand.</li><li><strong>Performance:</strong> Further performance improvements especially for really large codebases are being worked on.</li></ul><p>As always, if you have questions or if you are excited to help out, please reach out to us!</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 13.0: Flow & REPL]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/06/22/jest-13</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/06/22/jest-13"/>
        <updated>2016-06-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we are happy to announce the next major release of Jest. We have made major changes to Jest which are going to benefit you and all of Facebook's JavaScript test infrastructure. Most importantly, we added static types to all of Jest's code during a recent Jest hackathon at Facebook. Fifteen people worked for a day and night to add Flow types to Jest and to add new features to Jest. The Flow types serve two purposes: First, we believe that code is written to be read. Most of the time, code is written only once but read by dozens of people over the course of years. Adding static types to the project helps document the code and helps explain some of the architecture in Jest. Second, adding static types makes maintenance easier and will allow us to more confidently refactor parts of Jest without fear of breakages.]]></summary>
        <content type="html"><![CDATA[<p>Today we are happy to announce the next major release of Jest. We have made major changes to Jest which are going to benefit you and all of Facebook's JavaScript test infrastructure. Most importantly, we added static types to all of Jest's code during a recent Jest hackathon at Facebook. Fifteen people worked for a day and night to add <a href="https://flowtype.org/" target="_blank" rel="noopener noreferrer">Flow</a> types to Jest and to add new features to Jest. The Flow types serve two purposes: First, we believe that code is written to be read. Most of the time, code is written only once but read by dozens of people over the course of years. Adding static types to the project helps document the code and helps explain some of the architecture in Jest. Second, adding static types makes maintenance easier and will allow us to more confidently refactor parts of Jest without fear of breakages.</p><p>The Flow project has evolved a lot within Facebook and has been successfully adopted across many of our frameworks and almost all of our product code. Adoption can be parallelized incredibly well ‚Äì it can be done file-by-file until enough of the codebase is well-typed. Then, Flow provides real value and helps guide through large changes. Through this, many small edge cases and bugs were found.</p><p>With the help of <a href="https://github.com/lerna/lerna" target="_blank" rel="noopener noreferrer">lerna</a>, we continued to modularize the Jest project. With just a small <a href="https://github.com/lerna/lerna#lernajson" target="_blank" rel="noopener noreferrer">update to the configuration</a>, Flow and lerna now get along well with each other. Splitting up Jest into packages helped us rethink module boundaries and enabled us to ship useful <a href="https://github.com/facebook/jest/tree/main/packages" target="_blank" rel="noopener noreferrer">packages</a> standalone: The <code>jest-runtime</code> and <code>jest-repl</code> cli tools now allow you to run scripts in a sandboxed Jest environment, enabling you to run and debug your app from the command line. This is especially helpful for projects that use Facebook's <code>@providesModule</code> module convention. To get started, just install <code>jest-repl</code> and run it in the same folder you normally run your tests in! We also published a <code>jest-changed-files</code> package that finds changed files in version control for either git or hg, a common thing in developer tools.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-and-improved-features">New and improved features<a href="#new-and-improved-features" class="hash-link" aria-label="New and improved features „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New and improved features „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><ul><li>Added a notification plugin that shows a test run notification when using <code>--notify</code>.</li><li>Added a <code>browser</code> config option to properly resolve npm packages with a browser field in <code>package.json</code> if you are writing tests for client side apps.</li><li>Improved ‚Äúno tests found message‚Äù which will now report which tests were found and how they were filtered.</li><li>Added <code>jest.isMockFunction(jest.fn())</code> to test for mock functions.</li><li>Improved test reporter printing and added a test failure summary when running many tests.</li><li>Added support for mocking virtual modules through <code>jest.mock('Module', implementation, {virtual: true})</code>.</li><li>Removed the <code>.haste_cache</code> folder. Jest now uses the operating system's preferred temporary file location.</li><li>Added the duration of individual tests in verbose mode.</li><li>Added the ability to record snapshots in Jest. We'll be publishing a separate blog post about this feature soon.</li></ul><p>Finally, we have received a complete website redesign done by Matthew Johnston and added documentation for using <a href="/jest/ja/docs/webpack">Jest with webpack</a>. Happy Jesting!</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Jest 11.0]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/04/12/jest-11</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/04/12/jest-11"/>
        <updated>2016-04-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Today we're announcing a switch to major revisions for Jest with Jest 11.0 being the first major release. Jest has been used by Facebook engineers and on our continuous integration systems for years and we believe Jest has been way beyond a ‚Äú1.0 release‚Äù for a long time. This is similar to a change the React team has made.]]></summary>
        <content type="html"><![CDATA[<p>Today we're announcing a switch to major revisions for Jest with Jest 11.0 being the first major release. Jest has been used by Facebook engineers and on our continuous integration systems for years and we believe Jest has been way beyond a ‚Äú1.0 release‚Äù for a long time. This is similar to a change <a href="http://facebook.github.io/react/blog/2016/02/19/new-versioning-scheme.html" target="_blank" rel="noopener noreferrer">the React team has made</a>.</p><p>If you are using Jest 0.9 or Jest 0.10 the upgrade should be seamless. All changes from the last few months were rolled into Jest 11.0.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="new-in-jest-110">New in Jest 11.0<a href="#new-in-jest-110" class="hash-link" aria-label="New in Jest 11.0 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="New in Jest 11.0 „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_JmGV" id="babel-integration-and-simplified-setup">Babel Integration and Simplified Setup<a href="#babel-integration-and-simplified-setup" class="hash-link" aria-label="Babel Integration and Simplified Setup „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Babel Integration and Simplified Setup „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p><code>babel-jest</code> was adopted within the newly modularized Jest <a href="https://github.com/facebook/jest/tree/main/packages" target="_blank" rel="noopener noreferrer">repository</a> and it is now seamlessly integrated into Jest. If you are upgrading from an older version of Jest or are looking to adopt Jest, we recommend reading the <a href="/jest/ja/docs/getting-started">Getting Started guide</a>.</p><p>Previously Jest provided APIs such as <code>jest.dontMock</code> which unmocks a module that is subsequently being required using the <code>require</code> function. Testing code usually looked like this:</p><div class="language-javascript codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-javascript codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">dontMock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> </span><span class="token maybe-class-name">LikeButton</span><span class="token plain"> </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// LikeButton is unmocked</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, together with ES2015 import statements this will no longer work. Per the specification <code>import</code>s are hoisted to the top of their code block. Code written like this:</p><div class="language-javascript codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-javascript codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">dontMock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#297a29">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">LikeButton</span><span class="token plain"> </span><span class="token keyword module" style="color:#297a29">from</span><span class="token plain"> </span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>when executed, would actually be run in this order:</p><div class="language-javascript codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-javascript codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#297a29">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">LikeButton</span><span class="token plain"> </span><span class="token keyword module" style="color:#297a29">from</span><span class="token plain"> </span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This happens before the dontMock call.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">dontMock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The LikeButton module would therefore be mocked even though we explicitly call <code>dontMock</code>.</p><p>When the latest versions of Jest and babel-jest are used together, calls to the new APIs <code>jest.unmock</code>, <code>jest.mock</code>, <code>jest.disableAutomock</code> and <code>jest.enableAutomock</code> are hoisted to the top of their block, before ES2015 import statements.</p><div class="language-javascript codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-javascript codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">unmock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#297a29">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">LikeButton</span><span class="token plain"> </span><span class="token keyword module" style="color:#297a29">from</span><span class="token plain"> </span><span class="token string" style="color:#c21325">'LikeButton'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// LikeButton is properly unmocked!</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_JmGV" id="automocking-improvements">(Auto)Mocking Improvements<a href="#automocking-improvements" class="hash-link" aria-label="(Auto)Mocking Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="(Auto)Mocking Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>We have made numerous improvements and bug fixes to Jest's automocking feature, improved npm3 support and added new manual mocking APIs. Many people have expressed a desire use Jest with the automocking feature disabled. A global configuration option <a href="/jest/ja/docs/api#automock-boolean"><code>automock</code></a>, which can be set to <code>false</code>, was added.</p><p>We have also added two new APIs to simplify manual mocks. <code>jest.mock</code> specifies a manual mock factory for a specific test:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Implement a mock for a hypothetical "sum" module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">mock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#297a29">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> a </span><span class="token operator" style="color:#888">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> sum </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 5</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And <code>jest.fn</code> was added to make it easier to create mock functions:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Create a mock function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> mockFn </span><span class="token operator" style="color:#888">=</span><span class="token plain"> jest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">fn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">mockFn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mockFn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">calls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_JmGV" id="performance">Performance<a href="#performance" class="hash-link" aria-label="Performance „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Performance „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>We recently wrote about some <a href="/jest/ja/blog/2016/03/11/javascript-unit-testing-performance">performance improvements</a> we've made in Jest. Most notably, startup time has been improved and we are now in a comfortable place with regards to performance.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="jasmine-and-test-assertion-improvements">Jasmine and Test Assertion Improvements<a href="#jasmine-and-test-assertion-improvements" class="hash-link" aria-label="Jasmine and Test Assertion Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Jasmine and Test Assertion Improvements „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>When Jest was open sourced it shipped with Jasmine 1. Jest was designed to work with any test assertion library and optional Jasmine 2 support was added through an <a href="https://github.com/facebook/jest/pull/330" target="_blank" rel="noopener noreferrer">external contribution</a> at the end of last year. This change delivers better performance and provides a better APIs over the previous version of Jasmine. As such, we have converted all our JavaScript tests at Facebook to Jasmine 2. With Jest 11 we are making Jasmine 2 the new default. Jasmine 1 can be enabled through the <a href="/jest/ja/docs/api#testrunner-string"><code>testRunner</code></a> configuration option.</p><p>We have also made many updates around Jasmine. The failure messages for custom matchers provided for Jest's mock functions were improved and will now also work for Jasmine spies. Skipped tests, when using <code>fit</code> or <code>fdescribe,</code> are now properly reported at the end of a test run.</p><h4 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other Changes<a href="#other-changes" class="hash-link" aria-label="Other Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Other Changes „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h4><p>The <code>jest --watch</code> command has been rewritten and improved. By default it now only runs tests related to changed files. If you want to run all tests on every change, you can run <code>jest --watch=all</code>. The verbose logger output has also been improved and we've added more helpful warnings and error messages. We added a <a href="/jest/ja/docs/api#testenvironment-string"><code>testEnvironment</code></a> configuration option to customize the test environment. For example, when building a node service, a special <code>node</code> environment instead of <code>jsdom</code> can be used. Finally, the website and all documentation have been completely rewritten.</p><p>All changes from the past few months can be found in the <a href="https://github.com/facebook/jest/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer">CHANGELOG</a>.</p><h3 class="anchor anchorWithStickyNavbar_JmGV" id="contributions-and-jests-future">Contributions And Jest's future<a href="#contributions-and-jests-future" class="hash-link" aria-label="Contributions And Jest's future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Contributions And Jest's future „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h3><p>Over the last six months, Jest has received significant changes from a huge number of new contributors. I'd like to thank all the open source contributors and Facebook employees for their help in making Jest better for everyone. New contributors: Alexander Juarez, Christian Lentfort, Cristian Carlesso, Dan Abramov, Dmitrii Abramov, Evan Jacobs, James Friend, James Ide, Jeff Carpenter, Joe Lencioni, Michael Diolosa, Nik Graf, Pavel Prokopenko, Pavel Volokitin, Sebastian Mayr and ShihChi Huang.</p><p>With your support we are looking forward to making Jest even better in the coming months. We are currently working on improved React (Native) testing, enhanced code coverage support and are planning to open source our internal test runner that allows multiple Jest projects to be run with a single run-command.</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[JavaScript Unit Testing Performance]]></title>
        <id>https://QubitPi.github.io/jest/ja/blog/2016/03/11/javascript-unit-testing-performance</id>
        <link href="https://QubitPi.github.io/jest/ja/blog/2016/03/11/javascript-unit-testing-performance"/>
        <updated>2016-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Jest is running thousands of tests at Facebook at all times, either through continuous integration or invoked by engineers manually during development. This worked well for years even as the people working on Jest moved on to other projects within Facebook.]]></summary>
        <content type="html"><![CDATA[<p>Jest is running thousands of tests at Facebook at all times, either through continuous integration or invoked by engineers manually during development. This worked well for years even as the people working on Jest moved on to other projects within Facebook.</p><p>As engineers added more and more tests though, we noticed the performance of Jest wasn't going to scale. Additionally, in the last year the JavaScript ecosystem has changed dramatically with the introduction of things like npm3 and Babel, which we hadn't anticipated. We formed a new Jest team to address all of these issues and we'll be sharing our progress and plans on this blog from now on.</p><p>Jest is a bit different from most test runners. We designed it to work well in the context of Facebook's infrastructure:</p><ul><li><strong>Monorepo</strong> At Facebook we have a huge monorepo that contains all of our JavaScript code. There are many reasons why this approach is advantageous for us and there is an <a href="https://www.youtube.com/watch?v=W71BTkUbdqE" target="_blank" rel="noopener noreferrer">awesome talk</a> by a Google engineer that highlights all the benefits and drawbacks of monorepos.</li><li><strong>Sandboxing</strong> Another feature of Jest that's important to Facebook is how it virtualizes the test environment and wraps <code>require</code> in order to sandbox code execution and isolate individual tests. We're even working on making Jest more modular so we can take advantage of this functionality in other non-testing related use cases.</li><li><strong>providesModule</strong> If you've looked at any of our open source JavaScript projects before, you may have noticed that we use a <code>@providesModule</code> header to assign globally unique IDs to modules. This does require some custom tooling, but it allows us to reference modules without relative paths which has helped us move incredibly fast, has scaled well as our engineering organization has grown, and has fostered code sharing across the entire company. Check out <a href="https://github.com/facebook/relay/blob/4eae620d86ed7fce1ee463c2fca88eb690d9cbde/src/container/RelayContainer.js#L9" target="_blank" rel="noopener noreferrer">RelayContainer</a> for an example of how this works in practice. One downside to this approach, though, is that we're forced to read and parse our entire JavaScript codebase in order to resolve a single require statement. This would obviously be prohibitively expensive without extensive caching, especially for a short-lived process like Jest.</li></ul><p>As a result of these unique constraints, Jest may never be able to be as fast as other test runners when running on our entire suite of tests. However, engineers rarely need to run Jest on our entire test suite. Powered by static analysis in the <a href="https://github.com/facebook/node-haste" target="_blank" rel="noopener noreferrer">node-haste</a> project ‚Äì we've been able to make the default mode for running Jest at Facebook <code>jest --onlyChanged</code>, or <code>jest -o</code>. In this mode we build a reverse dependency graph to find only the affected tests that need to be run based on the modules that have been changed.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="optimal-scheduling-of-a-test-run">Optimal Scheduling of a Test Run<a href="#optimal-scheduling-of-a-test-run" class="hash-link" aria-label="Optimal Scheduling of a Test Run „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Optimal Scheduling of a Test Run „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>Most of the time our static analysis determines that more than one test needs to be run. The number of affected tests can be anywhere from a couple of tests to thousands. In order to speed this process up Jest parallelizes test runs across workers. This is great because most of Facebook's development happens on remote servers with many CPU cores.</p><p>Recently we noticed Jest often seemed stuck <em>‚ÄúWaiting for 3 tests‚Äù</em> for up to a minute toward the end of a run. It turned out we had a few really slow tests in our codebase that were dominating the test runtime. While we were able to speed these individual tests up significantly, we also made a change in how Jest schedules test runs. Previously we used to schedule test runs based on file system traversal, which was actually quite random. Here is an example of 11 tests in gray blocks over two workers. The size of the block is the runtime of the test:</p><p><img loading="lazy" alt="perf-basic-scheduling" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABPoAAAGrCAMAAABuTglrAAACu1BMVEX///9BQUHd3uCvr68/Pz9QUFDk5OR/f3+urq5HR0f9/f3g4OBTU1Pn5+fDw8Pp6enNzc0AAADe3t6fn58aGhpbW1tAQEDW1tYZGRlfX18SEhJaWlqDg4P4+PgPDw9SUlL+/v4XFxeTk5Pa2trGxsZ8fHyUlJQgICDR0dEqKiqZmZkODg77+/vm5uZxcXGNjY1tbW3h4eEQEBD8/PxZWVlMTEz29vZ6enpeXl44ODgCAgKgoKBISEiwsLAlJSXJycmQkJDq6ury8vLS0tLo6Ojr6+vMzMzs7OwDAwNhYWH5+fkKCgrw8PBoaGiGhobY2NjT09O+vr4fHx8eHh66urqysrIxMTFycnLi4uJYWFgGBgZvb2/6+vpiYmJERERWVlYdHR1UVFSlpaXBwcE+Pj4tLS2cnJwhISG/v783Nzerq6tDQ0OYmJiIiIgEBAQzMzNgYGAICAiBgYHf399OTk4WFhY8PDw1NTUHBwe1tbW2traxsbF7e3sBAQH39/eRkZH09PShoaFVVVVRUVGoqKjZ2dnX19d9fX2JiYl0dHTl5eWioqI2Nja9vb0yMjK8vLwYGBgcHBx4eHhCQkLc3Ny7u7sJCQljY2Pu7u51dXV5eXlqamp3d3c6OjpKSkojIyOKioqtra24uLiWlpYFBQXv7+8oKCjt7e2srKzj4+NpaWn19fVmZmabm5s5OTk9PT0MDAwbGxspKSmkpKQkJCTKysqpqalcXFwmJiZlZWXb29tra2tkZGSCgoJsbGzV1dUTExN+fn7FxcWVlZUvLy9PT0+AgICPj49XV1cNDQ1zc3NwcHCmpqYUFBRLS0sVFRWenp7Ozs6Ojo7U1NTz8/NdXV2Xl5csLCy3t7fx8fHQ0NALCwvIyMjAwMA0NDRJSUl2dnYwMDC0tLTExMQRERHCwsKMjIzHx8ciIiKcSuwIAAAOr0lEQVR42uzXtRHAMBBFQWH/LZsdm3G3gJsfvZFKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBbxW0ecOJPy4/fBWGp8oMQAkgfQPLnHT3jROsfy4/fBf9+9QFIH4D0AUgfIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9gPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AdIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSB0gfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH0AKy+RSw6xh7x6g3AjAAAjP2a6U69XK1bZt27aN1LZt27Zt27al3Y1qKX3v/2J7ooWzo6MLZq6Obu58nYejJ7/Gy9sHIYT4y+nz8vL0t+x4D+tdT/g6Ty9Pfo2ngyNCCPGX0/fCDTtMXOF1aEze4syfpnNCCCH+evqeOFkCF+TMPTwwivIaV/4014cIIcRfTx8ueGPkei+MPxctB4Rz5c8KjnsLIYT4B+m7zw0Pc+xcAglOhMYd90P8OUmTJU/hdREhhPgX6bvuQnw0XnjtDT7rieYSHphk8M7ARzJmisIXZfbOwkd8smbAmp+fr493smQIIcQ/SB8OeKPK6ZPMB2WhyvccX1QFPAvuc9hXKGJhNEWKFqN4iTB7kmOldJmiZYNRZS1XcLfDrvIVEqBxKVqRSpXtd27A2vJlqsIIIcQ/SF8uAlEFbom0CB06VDp85wEE1XnqFKFsuZiBD640DEJxZeWcRi+XLeUgFjnDLIq4Q9sjIM6C51XKVQ0z73oLVDVWnmkZcjY0RwghbCV9s5hRHEUI9sDp2s5tUdwmAEWYSQ/q+vfvt/Vm/bRjK2I0YE3DRo1PYdb2wWgHv2Mour452ux8j37dJ2d96tgKjfeIDc2rt+iMEELYyohsd6rNSDQNwJei21mebZCWvmTLEu4CvI9X67cFYBLeur69G6HoZWjf5xwWhoDDGTPURtH5aqw8tQAuTq86qHCQdqxM2RtuQQghbOhTH/HxBBg2p/x9wAMPgC7t8QIoSpRnaB40wBeVoXdd6/JlfNK2z7LaqE5NrFALzYhWs3KiMrg/QwghbCp9O3EFcDv6ogPgxgMAHX16A+lm1+6GSc2BjaOiqoKVyTFGDr75GFWXeTk8MYnACFQDxyOEELaWvobTATcuArjlWDUZWIUXQF0SnMbkhQfdUYyNhUW269O8ajRFc4oIJTBpxWxUw9YihBC2lb6D43EH3KkGUMR9e1kgFO4Ad3HDoiq3UbgewswnsCMPJ2EUjUwrzCrF6l4aRX2EEMLG0ocbbtCoTKS2KEqwEtaOqt1Xi9ZmLDobd83CzHnorEKz8PJBc4zixcx6Hj0aGoCQCCGEraXvCh0gJQd3o3DiETiSbSXAcnJiEYOoKCpg9rBWnAN5xhQoiOY0o2dYQ+WMEELYWvqcYx3sQXh0qGouK9eDtcZcHaUQFs3wQZEeC2/vHU8up5w3HpUfuizWeqNogRBC2Fr6ShQmY5ATj1EdcsIuKA/zUIwlFxZ60vKRVSGWQO2jGKaiKERNhBDif0gfLzk3P7PDdTSO9FmYcWBJ4/bcwzAJfsIDPpJrN8Abp3txUdhxMScm/nXG6RFCCBtN3308l7IeowY0z8cBPYozGSqcwCTf0jAN+Kxzr8ambgHg7vu8FybDJsU9hBBC2Gj6SpYpkY+qGJ2ubMhEf1QXYzHNH83+JczdzefdeUiY40ARb3oEozmRACmfEMJ206ePR0rqYnTuErNwQdM56tM5BVAUKHk2Tky+pE1Jw0GA1ob5V09pBR2ZNHlZhBDCZufD2w2mZsek8DJ2tJ+Exj9/gWRnVl9KU0e/znWYni85N25N9t6NoIjztEoDmi0fuFeXmId2CCGE7aZPv46LmFUBx0kYLWfJjEQwgCMT8uj5sscVOGEwwIs5uoX3yAu+vcosQQgh/iY7fiOv2s4laqzlu/XY2TDD0p5/IHx2P3HD3sLbf38W79ipAwwEgiiOw696VW270Dk6ZyforAFUiAmsbMlO833Ag/HH+BUNLP/eLij/ZXr66id9o6QP6csAaIH0AdIHIH0A0gfQQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA6QPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDkL5bvU80sHwmu5A+AOkDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYDHNvzwxrvJZAUif9AHS9x7pg6X6PVXwxJx6o3tIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIHyB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfYD0AUgfgPQBSB+A9AFIH0Cd6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDpA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPkD4A6QOQvlWuy7HJ3JZrl/suxh2yj090l/MpAH6dvmHoj+V4iNfremffHqBcScIACt+xbWmdfbZt27Zt59m2bdu2bdu21N3JJIuskFn8XxtVx/ew+GXuHn8iffEbtMrSoW/Ck5eOIYQQVk3fGxdsMHKG90EYfcSRv5H38mljTlQruyZtkvNXEEIIa6bvhQOOGEQ78gg3DL58jzN/nz5hifVHLvYbfu9lYOVl3RFCCCumDyc8MXB+FOzLVdOHUGf+PsNvJFgUAfCqy9F2wdEIIYQV0/eYO25onHCKJEEyNK64HuNvc/0JQRtRlepC8+YIIYQV03fbicRoPPA4mOCiO5pruGGUxTMLP5I125dYlN0zBz/ilTMLZtayYy4G08EDIYSwYvqwwxNVXq9UXiibqtBrvFEVcS96yO5QsajiaEqULEXpMsEHUmOmfIWSFROgylmp6H67fZWrJEHjVLIq1arb7t2CmTbMxeh5WnIghBDWTF8+IlFF7ohZRgQRqCLwXgQQ3eClQ3jFSt9FPrnRNBrFjbULmr1dtZKjmOQNXha1R3vhF2/J6xqVagYvut0GVZ21F9oGzIfWmGm8Ph5GHjsYjhBCWDN985hTGoU/B+B8fceOKO7jhyJ42pOGvoMH7bzbOOPEqhgM2dC0WfNzxOr4ZLydzykUPT+cbHW5z6De03O+tG+HxnPMlta123THTKukxTBqCCsQQog/z57f6kGtOclmAXhTcjercw3riCLVqqT7AM/TtQbtAJiGZ8TA/s1Q9NN3HnAJE73f8axZ6qPoflNXoB7A1dk1hxWP1v7KlrvpDiyKn5wdOoQQwqpreBPjDjBqQeXHgBtuAD064wFQki9foXnSBG9U+v4NL2GS9UXHAavqozo3tUo9NGPazctr+N/1FZYNqarzRgghrJu+vTgDuJx800W58AQgggH9gUzz6/fCqO7Q5l+hqoGZ6d+OHX73Oaoei/K4YxTOGFRDJ2NRju3FuBuCEEJYO31NZwMuXEW55Fk3HViHB0BDkpzH6I0bvVFM1GGS6/Ysjzot0ZwjvAxG7ZiPatRGLOmWL78u0VmEEMLK6Ts6GVfAlVoAJVx3VwQC1Xc8xAWTmtxH4XyMWF6RXXk6DYOvybYmVjVd7/IoGmNBkE3/zifLbUIIIaydPlxwgWYVYjqiKMNa2Diu/kAtWtsx6W54mkcsx5Hzis3DwwvNKUqXitX35MkgFAH8rOhEZb1r9S5YDyGEsH76btAF0nJ0PwoHnoE9udYCrCYvJt/yFYoqxHpaL96RAhOKFEVznvFzzKFy5Odkf3FlUsExNfcghBBxkD5H3dE+hBGBqu6qSn3YiCOKkxTDpBVeKDJj4um558X1tIsmo/IhIoe5/ija8DOSvHl7suPkBwghRJykr0xxskY78BzVMQdsoguwCMVE8mESn4z8yDr/FVD/JPqZKIpRl9+mUKKj27Y2QQgh4ih9vOXS4ux2t9HYM2Bp1qFlDff5R2GU4AVP+JF8+wE+ODxKiMKGq3kx8m0wKT4WjPJZvDpeCYQQIs7S9xj3lWzGoAmtC3EkPooLWaqcwajQyuAm/KxL7yambwPg6v26H0ajpiU8hgXbF/cviRBCxGH6ylYoU4iaGJyvrs/GYFRXdczyRXN4BQv38/MePCX4NFDCkz4J0JxJwjEsGBVGiksIIUQcpi9+ItLSEINL15iHE5ruX71cUARFkbIX432HJR3K6o8CtNcvvnkOxfmxKVNXxILVo6snQAgh4jJ99IKZpTAqDnsKYuBbuMjLC2M7rdPFv+E8CosuTVpVoz9QosX490NaJd46ZGHycU9tsOQOdsvM1UYIIaydvvhwlVg1wH4aBqsnTg9O1nJIiVsnptyMj2XPq3BGD7xZELF0zOWCnap6j3NcgSWpGF3BXFuEEOIfxqNNp1NZ+O36lNjpvDEvfz0bGxvb3+vzmH/LFNb3qZ06NgAAggEgCPZfmY5OTXI3AMA/sKy9DkD6pA+QPumD0KRP+gDpkz5A+u6kD4YjAKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPkD6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOmbhnj5fOGQPgDpAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACABdMvdjynnWwCAAAAAElFTkSuQmCC" width="1274" height="427" class="img_SS3x"></p><p>We were randomly running a mix of fast and slow tests, and one of our slowest tests ended up running as almost all the other tests were completed, during which the second worker sat idle.</p><p>We made a change to schedule tests based on their file size which is usually a good proxy for how long a test is going to take. A test with a few thousand lines of code likely takes longer than a test with 15 lines of code. While this sped up the entire test run by about 10%, we ended up finding a better heuristic: now Jest stores the runtime of each test in a cache and on subsequent runs, it schedules the slowest tests to run first. Overall this helped improve the runtime of all tests by about 20%.</p><p>Here is an example of the same test run from before with better scheduling:</p><p><img loading="lazy" alt="perf-improved-scheduling" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABPoAAAGrCAMAAABuTglrAAACu1BMVEX///9BQUHd3uCvr68/Pz9QUFDk5OR/f3+urq5HR0f9/f3g4OBTU1Pn5+fDw8Pp6enNzc0AAADe3t6fn58aGhpbW1tAQEDW1tYZGRlfX18SEhJaWlqDg4P4+PgPDw9SUlL+/v4XFxeTk5Pa2trGxsZ8fHyUlJQgICDR0dEqKiqZmZkODg77+/vm5uZxcXGNjY1tbW3h4eEQEBD8/PxZWVlMTEz29vZ6enpeXl44ODgCAgKgoKBISEiwsLAlJSXJycmQkJDq6ury8vLS0tLo6Ojr6+vMzMzs7OwDAwNhYWH5+fkKCgrw8PBoaGiGhobY2NjT09O+vr4fHx8eHh66urqysrIxMTFycnLi4uJYWFgGBgZvb2/6+vpiYmJERERWVlYdHR1UVFSlpaXBwcE+Pj4tLS2cnJwhISG/v783Nzerq6tDQ0OYmJiIiIgEBAQzMzNgYGAICAiBgYHf399OTk4WFhY8PDw1NTUHBwe1tbW2traxsbF7e3sBAQH39/eRkZH09PShoaFVVVVRUVGoqKjZ2dnX19d9fX2JiYl0dHTl5eWioqI2Nja9vb0yMjK8vLwYGBgcHBx4eHhCQkLc3Ny7u7sJCQljY2Pu7u51dXV5eXlqamp3d3c6OjpKSkojIyOKioqtra24uLiWlpYFBQXv7+8oKCjt7e2srKzj4+NpaWn19fVmZmabm5s5OTk9PT0MDAwbGxspKSmkpKQkJCTKysqpqalcXFwmJiZlZWXb29tra2tkZGSCgoJsbGzV1dUTExN+fn7FxcWVlZUvLy9PT0+AgICPj49XV1cNDQ1zc3NwcHCmpqYUFBRLS0sVFRWenp7Ozs6Ojo7U1NTz8/NdXV2Xl5csLCy3t7fx8fHQ0NALCwvIyMjAwMA0NDRJSUl2dnYwMDC0tLTExMQRERHCwsKMjIzHx8ciIiKcSuwIAAAOuUlEQVR42uzXsQ2AQAwEweNx/zWTIhHgDOGfKeDClV0BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgE8d8CI3YyboqwDMJ30Aa7+fF/Lw9wlcfQDSByB9ANIHSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9gPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AdIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSB7DSc9bFvj0AxxGAARR+F1s1Lk2tpLZt27ZtXG3btm3btm1b2t1T7fQ683+H5XjnrR0xc3JwcMbMxcHVjW9zd/Dg93h6eSOEEMGcPk9PDz/LxAdYTz3l2zw8Pfg9HvYOCCFEMKfvpSs6TFzgTRhM3uHE36Z3RAghgj19Tx1xwijAifu4YxT1DS78bS6PEEKIYE8fznhh5HI/rB+XLAvCu/B3BcW7DUIIEfzpe8BNdzTOOPsTlBiNG26H+XuSJU+R0vMSQgjxL9J3w5kEaDzx3Bd0zgPNZdwxyeiVkU9kyhyVr8rilZVPeGfLiDVfXx9vr+TJQQghgj992OOFKpd3cm+Ujyr/C3xQFfQotN9+f+FIRdAULVacEiXD7k2BlTJli5ULQpWtfKE99rsrVEyIxrlYJSpXsdu1EWsrlquKgBBCBH/6cuOPyn9r5MXo0aPS4zMfIKDuM8eI5crH8n94tVEAiqur5jZ+tXwZh7DIFXZxpJ3ajBBxF76oWr5a2Pk3WqKquepsq1BzoAVCCGEr6ZvNzBIoQrIXztRxaofiDiFQhJ38sJ7fgP7bbjVIN64SRgPXNmrc5DRm7R6Osfc9jqLb22PNL/Ts32NKtmcOrdF4jdzYokbLLgghhK28yHa3+szE0wF8KLaDFdkHt0ORfHmi3YDXier9twJMxkvfr09jFL0NHfqex8IQ4kimjHVQdLkWO29tgEszqg0uEqCtlTlHo60IIYQNHfWRAA+A4XMrPADccQfo2gFPgGJEfY7mYUN8UBn61DuPRaan7four4Pq9KSKtdGMbD07FyqD23OEEMKm0rcLFwDXYy87KgMeAujp2wdIP6dOd0xqDWoSDVVVrEyJOWrIrSeous7P6YFJREaiGjQBIYSwtfQ1mgG4cgllkHP1FGA1ngD1SHgGk5fu9EAxLjYW2W9M96zZDM1pIpbEpDVzUA1fhxBC2Fb6Dk3ADXCjOkBRtx3lgNDqPO7hikU17qBwOYyZt38nHk3GKDqZV5pVjt2jDIoGCCFEcHDgx7niCo3LRm6HouScVZlYV6hOP4AGjluw6NJcm5qNmVPf2oVLFvH0foDqOCWwlhJFKIQQwsaO+rhKR0jFoT0oHHkMDmRfBbCCXFjEJBqKipg9qh33YN6xBQuhOcOYmdZQOSGEELaWPqfYh3oSAT2qWsvL92QdTiiOURiL5nijyICFl9fOp1dSzZ+Ayhd9Vmt9ULRECCFsLX0li5ApwJEnqA47ogvIy3wU48iNRSDp+MTqkEuhzjEM01AUphZCCPE/pI9XnF+Qxf4GGgf6Lso0qJRxPM9wTIKe8pBP5N4D8NbxfjwUOi7lwsSv7vhAhBDCRtP3AI9lbMCoIS3yczAQxdmMFU9ikn9Z2IZ80fnX49K0BHDzedEbk+GT4x1GCCFsNH2lypbMTzWMzlQxZGYAqkuxme6H5sBS5u3hy+4+IuwJoKgXPYPQnEzIYYQQwlbTFxifVNTD6PxlZuOMpku0Z3MLoihY6lzcWHxN21KGQwBtDAuunUZxZlSyFOUQQohg5MDP6A7TcmBSZDk7O0xG41egYPKzay6nrRu43mV4IF9zfvzaHH0aQ1Gn6ZUHNl8xaJ8+CY90CCGE7aYvcD2XMKsKDpMxWsHSmYlhIEcn5g3k655U5KTBAC/n6hfdJx/49C67FCGE+G95tmx/PCM/rmfRbS7rcvHn6XQ6OyG+SqfT/e728p7dujBiAISCKHgQ0n/LGY+7IbsFHH/sDf1MgPQhfUgfSB9Tkz6kD6QP6UP6QPqQPpA+agAWTR+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9AC0AD5A+AOkDkD4A6QOQPgDpA5A+AOkDkD4A6QOQPgDpA5A+AOkDpA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gAocEcOTDIBBaQP6QPpAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAHlH50elbp5awc+dO7w04EpO9x0id9tAAsp/r4fVGv/9FezsoFf3p3wIkgfQDSByB9ANIH0AKwJ30A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSB0gfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIHyB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfYD0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AHUPGbTtjv27jHAcQQOoPgbs1izc0bXtm3bti10bdu2bdu2bVtKUh16Qubw/xXR9xcJJ39f3wCcAn2DgvllIb6h/BnBQ7vHQwgh9E6fwRAa0TXxCe5Tz/lloYZQ/rB49Vtmbt8nwYmLRxFCCF3T9zoILxwC4V00HD7gz9/IvGzq6ONVy6xOk/jcZYQQQs/0PffDH7vP/XlICHZfvSOQv0/vWIlshy/0HXb3RdRKS7shhBA6po8AjNgFPowekSuuBTED+fsMux5/oQXgZecjbaN/jhBC6Ji+R9wOQRNAQBjxk6IJJvgof5trj4m2AVXJzjRrhhBC6Ji+WwEkQmPAcCD+hVA0VwnBIbMxMz+SJetXeJTNmJ0fMeXIjJs1bJ+D3TQwIIQQOqYPH4yo8phSmlA+qoKvMKMqHFrkoM/Bop8VQ1O8RElKlY6+PxVuypUvUSE+qhwVi+zz2VupcmI0ASWqULWa957NuGnNHByepSE7QgihZ/ryEoYqbPsXS7FgQWXBvBDg8/ov/GJXqPh92OPrTT5HcX3N/KZvVq7gCC55oi/9bLc2I1Lcxa+qV6wRfeGt1qhqrznfJso8aIWbRuvi4mDYzjCEEELP9M1ldikUkdkP5+r5d0Bxj0gook993CDioIE77jTKMKEKdoPXN2na7CxOHR6P84lwEkWP9ydaXuo9sNe0HC9826Ixjt7cqlbrbrhpmaQoDg1gOUIIoeeNbPdrzk46E8BMiV2syjm0A4qUK5PsBYynag7cDjAVo2VAv6Yo+to69b+Iiy3SsSyZ66HodsOavy7AlVk1hhb7/CKKrLmabMejeMnYbkUIIfTc6iMRoQAj51d6BIQQAtC9EwaAEnz1Es3jxphR2fo1uIhLlucd+q+sh+rslMp10YxuOzcPKlvwSzwbXMVqRggh9E3fHgIBgk687gwE8RjAQv9+QMZ59XriUGdIs69RVcfNtO/GDLvzDFX3hblDcYjNaFRDJuFR9m1FuRMDIYTQO31NZgFBXAEIyr12GrAWA0ADEp/D4XUIvVBMsOKS89ZMQ+0WaM4SuzQObZmHauQGPOmaN5814RmEEELn9B2ZRDAQTE2A4sG7KgBRCQZ4QBAuNbiHIvAoTqawLjyZit03ZF3tVNXaqxyKRngQzatfpxNlNyKEELo/ry+IIGha/osOKErPW5OFDUXqDQBo5LcNl24ttam5OPn3r1u0dDGD6RGqk5TCXWoUUfhZn5uyTKz5ZYHdCCGE7lt9XKczpOHIPhR+PAVfcq4BWEUeXL7jaxSVcXpSN+7h/OMLF0FzjnGz3aHy5+dke355YoHRNXYjhBDhkD5/65HexMKCqs7Kir3ZgD+KExTFpSUmFJlwMRp3P7+WZuEkVBGwZHfXD0Vrfkbi129OdJh0HyGECJf0lS5Gls/9eIbqqB9en+dnIYoJ5MUlHhn4kbWRl0O9E9hmoChKHX6bggmPbN3SGCGECKf08YaLi7L53ELjS/8lWYaUsY/nG4lD/Oc85kfy7gN47/cwAQovruTBIWL9ifHwYGSERaviFkcIIcItfY8IXcEm7BrTqiCH46E4n7nyaRwKrojemJ918e2EdK0Bgs2v+uIwcmqCo3iwbVG/EgghRDimr0z50gWpgd25arasDEJ1xcrMiGgOLWfBPn7e/SdEPwUUN9I7PprTiTmKByNjkfwiQggRjumLl5A0NMDu4lXmEoCm29cv5hdGUbjMhbjf40n7MrYjAO1si26cRXFuTIpUFfBg1ahq8RFCiPBMHz1hRkkcisHuAthFLFT4xfkxHdda410PHIlHFyeurN4PKN583LvBLRNtGbwg2dgnXnhyG5+l7mohhBB6v4I83kau4FQdfKdit4rls5PCYI5Pzh8Pz55V5rTNBq/nW5Y8pACY+5Zfjicpj48ahZtDIxFCiH8WQ+uOJzPz2/UuviNwQx7+el5eXt7/BB/bqWMsACAYCoIK979ypE6n8YKZToFfbe6osxruylODHWXK0X/zfN8T9T5IXyV90of0SZ/0SR9zAEgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIHyB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfQDSByB9ANIHIH0A0gcgfYD0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AFIH4D0AUgfgPQBSB+A9AHSByB9ANIH8GL6AKQPQPoApA9A+gCkD0D6AKQPQPoApA9A+gCkD0D6AKQPQPrCrA3x/ZRo8gRfpg9A+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAFnnHdkoEBZuwAAAABJRU5ErkJggg==" width="1274" height="427" class="img_SS3x"></p><p>Because we are running slow tests first, Jest can sometimes seem to take a long time to start up ‚Äì we only print results after the first test has completed. For the future we are planning to run previously failed tests first, because getting that info to developers as quickly as possible matters the most.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="inline-requires-and-lazy-mocking">Inline Requires and Lazy Mocking<a href="#inline-requires-and-lazy-mocking" class="hash-link" aria-label="Inline Requires and Lazy Mocking „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Inline Requires and Lazy Mocking „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>If you have written tests using Jasmine before, they probably look like this:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#297a29">const</span><span class="token plain"> sum </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">it</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'works'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#6b2e85">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One special thing we do in Jest is reset the entire module registry after every single test (call to <code>it</code>) to make sure tests don't depend on each other. Before Jest, individual tests would depend on each other and internal module state often leaked between them. As engineers removed, reordered or refactored tests, some of them started to fail, making it hard for people to understand what was going on.</p><p>Every single test in Jest receives a fresh new copy of all modules, including new versions of all mocked dependencies which take a lot of time to generate for each test. A side effect of this is that we had to call <code>require</code> manually before every test, like this:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#297a29">let</span><span class="token plain"> sum</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#6b2e85">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">beforeEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sum </span><span class="token operator" style="color:#888">=</span><span class="token plain"> </span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">it</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'works'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#6b2e85">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">it</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'works too'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// This copy of sum is not the same as in the previous call to `it`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#6b2e85">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We built a babel transform called <a href="https://github.com/facebook/fbjs/blob/main/packages/babel-preset-fbjs/plugins/inline-requires.js" target="_blank" rel="noopener noreferrer">inline-requires</a> that removes top-level require statements and inlines them in code. For example, the line <code>const sum = require('sum');</code> will be removed from code, but every use of <code>sum</code> in the file will be replaced by <code>require('sum')</code>. With this transform we can write tests just like you'd expect in Jasmine and the code gets transformed into this:</p><div class="language-js codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f6f6"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-js codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#6b2e85">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#6b2e85">it</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'works'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#888">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#6b2e85">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#6b2e85">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#c21325">'sum'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#1373c2">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#6b2e85">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#1373c2">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éº„Éâ„Çí„Ç≥„Éî„Éº" title="„Ç≥„Éî„Éº" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A great side-effect of inline requires is that we only require the modules that we actually use within the test itself, instead of all the modules we used in the entire file.</p><p>Which leads to another optimization: lazy mocking. The idea is to only mock modules on demand, which combined with inline requires saves us from mocking a lot of modules and all their recursive dependencies.</p><p>We were able to update all tests using a <a href="https://github.com/cpojer/js-codemod/blob/master/transforms/outline-require.js" target="_blank" rel="noopener noreferrer">codemod</a> in no time ‚Äì it was a <em>simple</em> 50,000 line code change. Inline requires and lazy mocking improved the test runtime by 50%.</p><p>The inline-require babel plugin is not only useful for Jest but for normal JavaScript as well. It was shipped by <a href="https://twitter.com/voideanvalue" target="_blank" rel="noopener noreferrer">Bhuwan</a> to all users of <a href="http://facebook.com/" target="_blank" rel="noopener noreferrer">facebook.com</a> just a week ago and significantly improved startup time.</p><p>For now, if you'd like to use this transform in Jest you'll have to add it manually to your Babel configuration. We are working on ways to make this easier to opt-in.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="repo-sync-and-caching">Repo-Sync and Caching<a href="#repo-sync-and-caching" class="hash-link" aria-label="Repo-Sync and Caching „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Repo-Sync and Caching „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>The open source version of Jest used to be a fork of our internal version, and we'd sync Jest out only once every couple of months. This was a painful manual process that required fixing up many tests every time. We recently upgraded Jest and brought parity to all platforms (iOS, Android and web) and then enabled our sync process. Now, every change to Jest in open source is run against all of our internal tests, and there's only a single version of Jest that's consistent everywhere.</p><p>The first feature we got to take advantage of after unforking was the preprocessor cache. If you are using Babel together with Jest, Jest has to pre-process every JavaScript file before it can execute it. We built a caching layer so that each file, when unchanged, only has to be transformed a single time. After we unforked Jest, we were able to easily fix up the open source implementation and shipped it at Facebook. This resulted in another 50% performance win. Because the cache only works on the second-run, the cold start time of Jest was unaffected.</p><p>We also realized we were doing a lot of path operations when resolving relative requires. Because the module registry is reset for every test, there were thousands of calls that could be memoized. One big optimization was to add a lot more caching, not just around a single test, but also across test files. Previously, we would generate module metadata for the automocking feature once for every test file. The object a module exports never changes however, so we now share this code across test files. Unfortunately, because JavaScript and Node.js don't have shared memory, we have to do all of this work at least once per worker process.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="question-everything">Question Everything<a href="#question-everything" class="hash-link" aria-label="Question Everything „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Question Everything „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>When trying to improve performance, it's important to also dive into the systems that sit above and below your system. In the case of Jest, things like Node.js and the test files themselves, for example. One of the first things we did was to update Node.js at Facebook from the years-old 0.10 to iojs and subsequently to Node 4. The new version of V8 helped improve performance and was quite easy to upgrade to.</p><p>We noticed that the <code>path</code> module in Node.js is slow when making thousands of path operations which was <a href="https://github.com/nodejs/node/pull/5123" target="_blank" rel="noopener noreferrer">fixed in Node 5.7</a>. Until we drop support for Node 4 internally at Facebook, we'll ship our own version of the <a href="https://github.com/facebook/node-haste/blob/master/src/fastpath.js" target="_blank" rel="noopener noreferrer">fastpath</a> module.</p><p>We next started questioning the outdated <a href="https://github.com/facebook/node-haste" target="_blank" rel="noopener noreferrer">node-haste</a>. As mentioned before, the entire project has to be parsed for <code>@providesModule</code> headers to build a dependency graph. When this system was originally built, <code>node_modules</code> didn't exist and our file system crawler wasn't excluding them properly.</p><p>In previous versions, Jest would actually read every file in <code>node_modules</code> ‚Äì which contributed to the slow startup time of Jest. When we picked up Jest again we replaced the entire project with a new implementation, based on react-native's packager. The startup time of Jest is now less than a second even on large projects. The react-native team, specifically <a href="https://twitter.com/void_0" target="_blank" rel="noopener noreferrer">David</a>, <a href="https://twitter.com/amasad" target="_blank" rel="noopener noreferrer">Amjad</a> and <a href="https://twitter.com/martinbigio" target="_blank" rel="noopener noreferrer">Martin</a> did an outstanding job on this project.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="adding-everything-up">Adding everything up<a href="#adding-everything-up" class="hash-link" aria-label="Adding everything up „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ" title="Adding everything up „Å∏„ÅÆÁõ¥Êé•„É™„É≥„ÇØ">‚Äã</a></h2><p>A lot of the above changes improved the test runtime by 10% or sometimes even 50%. We started at a runtime of about 10 minutes for all tests, and without these improvements we'd probably be at around 20 minutes by now. After these improvements, though, it now consistently takes around 1 minute and 35 seconds to run all our tests!</p><p>More importantly, adding new tests causes total runtime to grow very slowly. Engineers can write and run more tests without feeling the costs.</p><p>With Jest's recent 0.9 release and performance improvements from the <a href="https://github.com/facebook/jest/pull/599" target="_blank" rel="noopener noreferrer">node-haste2 integration</a>, the runtime of the <a href="https://github.com/facebook/relay" target="_blank" rel="noopener noreferrer">Relay</a> framework's test suite went down from 60 seconds to about 25 and the <a href="https://github.com/facebook/react-native" target="_blank" rel="noopener noreferrer">react-native</a> test suite now finishes in less than ten seconds on a 13‚Äù MacBook Pro.</p><p>We're very happy with the wins we've seen so far, and we're going to keep working on Jest and making it better. If you are curious about contributing to Jest, feel free get in touch on GitHub, <a href="https://discord.gg/j6FKKQQrW9" target="_blank" rel="noopener noreferrer">Discord</a> or Facebook :)</p>]]></content>
        <author>
            <name>Christoph Nakazawa</name>
            <uri>http://twitter.com/cpojer</uri>
        </author>
    </entry>
</feed>